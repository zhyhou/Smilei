
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Write a namelist &#8212; Smilei b&#39;v4.3-106-g8c22fd7f\n&#39; documentation</title>
    <link rel="stylesheet" href="_static/smilei_theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://www.gitcdn.xyz/cdn/mathjax/MathJax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="_static/smileiIcon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Run" href="run.html" />
    <link rel="prev" title="Install" href="installation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": {
      scale: 95,
      availableFonts: ["TeX"]
    }
  });
  </script>
   
  </head><body>

<div id="smallScreenMenu" class="off">

    
    <div class="toctree-smilei">
        <ul>
                <li class="outer">
                    <a href="licence.html">Licence</a>
                </li>
                <li class="outer">
                    <a href="synopsis.html">Synopsis</a>
                </li>
                <li class="outer">
                    <a href="highlights.html">Highlights</a>
                </li>
                <li class="outer">
                    <a href="releases.html">Releases</a>
                </li>
        </ul>
        <hr />
        <ul>
                <li class="outer">
                    <a href="units.html">Units</a>
                </li>
                <li class="outer">
                    <a href="algorithms.html">PIC algorithms</a>
                </li>
                <li class="outer">
                    <a href="parallelization.html">Parallelization basics</a>
                </li>
                <li class="outer">
                    <a href="vectorization.html">Vectorization</a>
                </li>
                <li class="outer">
                    <a href="collisions.html">Binary collisions</a>
                </li>
                <li class="outer">
                    <a href="ionization.html">Ionization</a>
                </li>
                <li class="outer">
                    <a href="radiation_loss.html">Synchrotron-like radiation reaction</a>
                </li>
                <li class="outer">
                    <a href="multiphoton_Breit_Wheeler.html">Multiphoton Breit-Wheeler pair creation</a>
                </li>
                <li class="outer">
                    <a href="particle_merging.html">Particle Merging</a>
                </li>
                <li class="outer">
                    <a href="particle_injector.html">Particle Injector</a>
                </li>
                <li class="outer">
                    <a href="laser_envelope.html">Laser envelope model</a>
                </li>
                <li class="outer">
                    <a href="relativistic_fields_initialization.html">Field initialization for relativistic species</a>
                </li>
                <li class="outer">
                    <a href="azimuthal_modes_decomposition.html">Azimuthal modes decomposition</a>
                </li>
        </ul>
        <hr />
        <ul>
                <li class="outer">
                    <a href="installation.html">Install</a>
                </li>
            </ul>
                <ul>
<li><a class="reference internal" href="#">Write a namelist</a><ul>
<li><a class="reference internal" href="#general-rules">General rules</a></li>
<li><a class="reference internal" href="#python-workflow">Python workflow</a></li>
<li><a class="reference internal" href="#main-variables">Main variables</a></li>
<li><a class="reference internal" href="#load-balancing">Load Balancing</a></li>
<li><a class="reference internal" href="#vectorization">Vectorization</a></li>
<li><a class="reference internal" href="#moving-window">Moving window</a></li>
<li><a class="reference internal" href="#current-filtering">Current filtering</a></li>
<li><a class="reference internal" href="#field-filtering">Field filtering</a></li>
<li><a class="reference internal" href="#species">Species</a></li>
<li><a class="reference internal" href="#particle-injector">Particle Injector</a></li>
<li><a class="reference internal" href="#particle-merging">Particle Merging</a></li>
<li><a class="reference internal" href="#lasers">Lasers</a></li>
<li><a class="reference internal" href="#laser-envelope-model">Laser envelope model</a></li>
<li><a class="reference internal" href="#external-fields">External fields</a></li>
<li><a class="reference internal" href="#antennas">Antennas</a></li>
<li><a class="reference internal" href="#profiles">Profiles</a></li>
<li><a class="reference internal" href="#walls">Walls</a></li>
<li><a class="reference internal" href="#collisions">Collisions</a></li>
<li><a class="reference internal" href="#radiation-reaction">Radiation reaction</a></li>
<li><a class="reference internal" href="#multiphoton-breit-wheeler">Multiphoton Breit-Wheeler</a></li>
<li><a class="reference internal" href="#scalar-diagnostics"><em>Scalar</em> diagnostics</a></li>
<li><a class="reference internal" href="#fields-diagnostics"><em>Fields</em> diagnostics</a></li>
<li><a class="reference internal" href="#probe-diagnostics"><em>Probe</em> diagnostics</a></li>
<li><a class="reference internal" href="#particlebinning-diagnostics"><em>ParticleBinning</em> diagnostics</a></li>
<li><a class="reference internal" href="#screen-diagnostics"><em>Screen</em> diagnostics</a></li>
<li><a class="reference internal" href="#trackparticles-diagnostics"><em>TrackParticles</em> diagnostics</a></li>
<li><a class="reference internal" href="#performances-diagnostics"><em>Performances</em> diagnostics</a></li>
<li><a class="reference internal" href="#time-selections">Time selections</a></li>
<li><a class="reference internal" href="#checkpoints">Checkpoints</a></li>
<li><a class="reference internal" href="#variables-defined-by-smilei">Variables defined by Smilei</a></li>
</ul>
</li>
</ul>

            <ul>
                <li class="outer">
                    <a href="run.html">Run</a>
                </li>
                <li class="outer">
                    <a href="post-processing.html">Post-process</a>
                </li>
                <li class="outer">
                    <a href="contribute.html">Contribute</a>
                </li>
        </ul>
        <hr />
        <ul>
                <li class="outer">
                    <a href="material.html">Publications</a>
                </li>
                <li class="outer">
                    <a href="partners.html">Partners</a>
                </li>
                <li class="outer">
                    <a href="https://smileipic.github.io/tutorials">Smilei tutorials</a>
                </li>
        </ul>
        <hr />
    </div>

</div>
<div id="hcontainer">
    <div id="nav_positioner">
        <div id="nav">
            <div id="nav_button" onclick="toggleNav()">
                Sections
            </div>
            <div id="nav_list" class="toctree-smilei">
                <div id="nav_title"><a href="#">Write a namelist</a></div>
                <ul>
<li><a class="reference internal" href="#">Write a namelist</a><ul>
<li><a class="reference internal" href="#general-rules">General rules</a></li>
<li><a class="reference internal" href="#python-workflow">Python workflow</a></li>
<li><a class="reference internal" href="#main-variables">Main variables</a></li>
<li><a class="reference internal" href="#load-balancing">Load Balancing</a></li>
<li><a class="reference internal" href="#vectorization">Vectorization</a></li>
<li><a class="reference internal" href="#moving-window">Moving window</a></li>
<li><a class="reference internal" href="#current-filtering">Current filtering</a></li>
<li><a class="reference internal" href="#field-filtering">Field filtering</a></li>
<li><a class="reference internal" href="#species">Species</a></li>
<li><a class="reference internal" href="#particle-injector">Particle Injector</a></li>
<li><a class="reference internal" href="#particle-merging">Particle Merging</a></li>
<li><a class="reference internal" href="#lasers">Lasers</a></li>
<li><a class="reference internal" href="#laser-envelope-model">Laser envelope model</a></li>
<li><a class="reference internal" href="#external-fields">External fields</a></li>
<li><a class="reference internal" href="#antennas">Antennas</a></li>
<li><a class="reference internal" href="#profiles">Profiles</a></li>
<li><a class="reference internal" href="#walls">Walls</a></li>
<li><a class="reference internal" href="#collisions">Collisions</a></li>
<li><a class="reference internal" href="#radiation-reaction">Radiation reaction</a></li>
<li><a class="reference internal" href="#multiphoton-breit-wheeler">Multiphoton Breit-Wheeler</a></li>
<li><a class="reference internal" href="#scalar-diagnostics"><em>Scalar</em> diagnostics</a></li>
<li><a class="reference internal" href="#fields-diagnostics"><em>Fields</em> diagnostics</a></li>
<li><a class="reference internal" href="#probe-diagnostics"><em>Probe</em> diagnostics</a></li>
<li><a class="reference internal" href="#particlebinning-diagnostics"><em>ParticleBinning</em> diagnostics</a></li>
<li><a class="reference internal" href="#screen-diagnostics"><em>Screen</em> diagnostics</a></li>
<li><a class="reference internal" href="#trackparticles-diagnostics"><em>TrackParticles</em> diagnostics</a></li>
<li><a class="reference internal" href="#performances-diagnostics"><em>Performances</em> diagnostics</a></li>
<li><a class="reference internal" href="#time-selections">Time selections</a></li>
<li><a class="reference internal" href="#checkpoints">Checkpoints</a></li>
<li><a class="reference internal" href="#variables-defined-by-smilei">Variables defined by Smilei</a></li>
</ul>
</li>
</ul>

            </div>
        </div>
    </div>
    
    <div class="headercolor">
    </div>
    <div class="hpositioner">
        <div class="header">
        <div class="logo">
            <a href="index.html">
                <img class="logo" src="_static/smileiLogo.svg" alt="Logo" />
            </a>
        </div>
        <div class="menu"
            id="menu_Overview"
            
        >
            <div id="menuButton_Overview" class="menuButton"
                 onmouseenter="prepareMenu('menu_Overview')"
                 onmousedown="event.preventDefault()"
            >
                <a href="overview.html">
                    <span>Overview</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_Overview',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="licence.html">Licence</a>
                        </li>
                        <li class="outer">
                            <a href="synopsis.html">Synopsis</a>
                        </li>
                        <li class="outer">
                            <a href="highlights.html">Highlights</a>
                        </li>
                        <li class="outer">
                            <a href="releases.html">Releases</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        <div class="menu"
            id="menu_Understand"
            
        >
            <div id="menuButton_Understand" class="menuButton"
                 onmouseenter="prepareMenu('menu_Understand')"
                 onmousedown="event.preventDefault()"
            >
                <a href="understand.html">
                    <span>Understand</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_Understand',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="units.html">Units</a>
                        </li>
                        <li class="outer">
                            <a href="algorithms.html">PIC algorithms</a>
                        </li>
                        <li class="outer">
                            <a href="parallelization.html">Parallelization basics</a>
                        </li>
                        <li class="outer">
                            <a href="vectorization.html">Vectorization</a>
                        </li>
                        <li class="outer">
                            <a href="collisions.html">Binary collisions</a>
                        </li>
                        <li class="outer">
                            <a href="ionization.html">Ionization</a>
                        </li>
                        <li class="outer">
                            <a href="radiation_loss.html">Synchrotron-like radiation reaction</a>
                        </li>
                        <li class="outer">
                            <a href="multiphoton_Breit_Wheeler.html">Multiphoton Breit-Wheeler pair creation</a>
                        </li>
                        <li class="outer">
                            <a href="particle_merging.html">Particle Merging</a>
                        </li>
                        <li class="outer">
                            <a href="particle_injector.html">Particle Injector</a>
                        </li>
                        <li class="outer">
                            <a href="laser_envelope.html">Laser envelope model</a>
                        </li>
                        <li class="outer">
                            <a href="relativistic_fields_initialization.html">Field initialization for relativistic species</a>
                        </li>
                        <li class="outer">
                            <a href="azimuthal_modes_decomposition.html">Azimuthal modes decomposition</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        <div class="menu"
            id="menu_Use"
            style="font-weight:bold"
        >
            <div id="menuButton_Use" class="menuButton"
                 onmouseenter="prepareMenu('menu_Use')"
                 onmousedown="event.preventDefault()"
            >
                <a href="use.html">
                    <span>Use</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_Use',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="installation.html">Install</a>
                        </li>
                        <li >
                            <a href="#">Write a namelist</a>
                        </li>
                        <li class="outer">
                            <a href="run.html">Run</a>
                        </li>
                        <li class="outer">
                            <a href="post-processing.html">Post-process</a>
                        </li>
                        <li class="outer">
                            <a href="contribute.html">Contribute</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        <div class="last menu"
            id="menu_More"
            
        >
            <div id="menuButton_More" class="menuButton"
                 onmouseenter="prepareMenu('menu_More')"
                 onmousedown="event.preventDefault()"
            >
                <a href="more.html">
                    <span>More</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_More',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="material.html">Publications</a>
                        </li>
                        <li class="outer">
                            <a href="partners.html">Partners</a>
                        </li>
                        <li class="outer">
                            <a href="https://smileipic.github.io/tutorials">Smilei tutorials</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        
        <script type="text/javascript">
            var es=document.getElementsByClassName("menuButton"), i=0;
            var evt = "ontouchend" in document ? "touchend" : "click";
            for( var i=0; i<es.length; i+=1 ) {
                es[i].addEventListener(evt, function(a){ return function(){toggleMenu(a)};}(es[i].parentNode.id));
            }
        </script>
        
        <div id="searchbox" role="search" style="display:none">
            <form class="search" action="search.html" method="get">
              <input type="text" name="q" placeholder="Search" id="searchinput" />
              <input type="hidden" name="check_keywords" value="yes" />
              <input type="hidden" name="area" value="default" />
            </form>
        </div>
        
        <div id="searchicon" onclick="openSearch()" style="display:block">
            <svg
               xmlns="http://www.w3.org/2000/svg"
               viewBox="0 0 80 120">
              <g transform="translate(0,-932.36216)" >
                <circle
                   r="25" cy="977.51044" cx="38.078663"
                   style="opacity:1;fill:none;stroke:#ffffff;stroke-width:10;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
                <rect
                   transform="matrix(0.36717877,0.93015039,-0.93427297,0.35655858,0,0)"
                   rx="4.9996676" ry="7.4995141"
                   y="316.16959" x="947.6142"
                   height="14.117695" width="46.476151"
                   style="opacity:1;fill:#ffffff;fill-opacity:1;stroke:none;" />
                <path
                   d="m 41.383282,962.25996 a 15,15 0 0 1 11.660107,11.6355"
                   style="opacity:1;fill:none;stroke:#ffffff;stroke-width:3;stroke-linecap:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
              </g>
            </svg>
        </div>
        <div id="closesearchicon" onclick="closeSearch()" style="display:none">
            <svg
               xmlns="http://www.w3.org/2000/svg"
               viewBox="0 0 80 120">
              <g
                 transform="translate(0,-932.36216)">
                <path
                   d="m 10,962.36216 60,60.00004"
                   style="fill:none;stroke:#ffffff;stroke-width:10;stroke-linecap:round;stroke-linejoin:miter;stroke-opacity:1;stroke-miterlimit:4;stroke-dasharray:none" />
                <path
                   d="M 70,962.36216 10,1022.3622"
                   style="fill:none;stroke:#ffffff;stroke-width:10;stroke-linecap:round;stroke-linejoin:miter;stroke-opacity:1;stroke-miterlimit:4;stroke-dasharray:none" />
              </g>
            </svg>
        </div>
        
        <div id="smallScreenMenuButton" onclick="toggleSmallScreenMenu(event)">
            <svg xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg"
               viewBox="-20 -20 140 140">
              <g  style="fill:#ffffff;stroke:none;">
                <circle cx="15" cy="20" r="5" />
                <circle cx="35" cy="20" r="5" />
                <circle cx="85" cy="20" r="5" />
                <rect width="50" height="10" x="35" y="15" rx="0" ry="0" />
                <circle cx="15" cy="40" r="5" />
                <circle cx="35" cy="40" r="5" />
                <circle cx="85" cy="40" r="5" />
                <rect width="50" height="10" x="35" y="35" rx="0" ry="0" />
                <circle cx="15" cy="60" r="5" />
                <circle cx="35" cy="60" r="5" />
                <circle cx="85" cy="60" r="5" />
                <rect width="50" height="10" x="35" y="55" rx="0" ry="0" />
                <circle cx="15" cy="80" r="5" />
                <circle cx="35" cy="80" r="5" />
                <circle cx="85" cy="80" r="5" />
                <rect width="50" height="10" x="35" y="75" rx="0" ry="0" />
              </g>
            </svg>
        </div>
        
    </div>
    
</div>
</div>

    <div class="document">
    <div class="documentwrapper">
        <div class="body" role="main">
          
  <div class="section" id="write-a-namelist">
<h1>Write a namelist<a class="headerlink" href="#write-a-namelist" title="Permalink to this headline">¶</a></h1>
<p>Before you run <strong class="program">Smilei</strong>, you need a <em>namelist</em> (an input file). The namelist
is written in the <em>python</em> language. It is thus recommended to know the basics of <em>python</em>.</p>
<p>We suggest you copy one existing namelist from the folder <em>benchmarks</em>.
All namelists have the extension <code class="docutils literal notranslate"><span class="pre">.py</span></code>.</p>
<hr class="docutils" />
<div class="section" id="general-rules">
<h2>General rules<a class="headerlink" href="#general-rules" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p><strong class="program">Smilei</strong> requires a few <em>blocks</em> to be defined, such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Main</span><span class="p">(</span>
    <span class="c1"># ...</span>
    <span class="n">timestep</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>         <span class="c1"># defines the timestep value</span>
    <span class="n">grid_length</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">20.</span><span class="p">],</span> <span class="c1"># defines the 2D box dimensions</span>
    <span class="c1"># ...</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Outside blocks, you can calculate anything you require.
Inside a block, you must only define variables for <strong class="program">Smilei</strong>.</p>
</li>
<li><p>The <em>python</em> syntax requires special indentation of each line.
You begin with no indentation, but you have to <strong>add four spaces at the
beginning of lines inside a group</strong>, and so on.
For instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">timestep</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">timestep</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">timestep</span> <span class="o">=</span> <span class="mf">0.3</span>
</pre></div>
</div>
</li>
<li><p>You will need to use <a class="reference external" href="https://docs.python.org/2/tutorial/introduction.html#lists">lists</a>,
which are series of things in <em>python</em>,
defined between brackets <code class="docutils literal notranslate"><span class="pre">[]</span></code> and separated by commas.
For example, <code class="docutils literal notranslate"><span class="pre">mean_velocity</span> <span class="pre">=</span> <span class="pre">[0.,</span> <span class="pre">1.1,</span> <span class="pre">3.]</span></code>.</p></li>
<li><p>You are free to import any installed <em>python</em> package into the namelist.
For instance, you may obtain <span class="math notranslate nohighlight">\(\pi\)</span> using <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">math</span> <span class="pre">import</span> <span class="pre">pi</span></code>.</p></li>
<li><p>All quantities are normalized to arbitrary values: see <a class="reference internal" href="units.html"><span class="doc">Units</span></a>.</p></li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="python-workflow">
<h2>Python workflow<a class="headerlink" href="#python-workflow" title="Permalink to this headline">¶</a></h2>
<p><em>Python</em> is started at the beginning of the simulation (one <em>python</em> interpreter
for each MPI process). The following steps are executed:</p>
<ol class="arabic simple">
<li><p>A few variables from <strong class="program">Smilei</strong> are passed to <em>python</em> so that they are
available to the user:</p>
<ul class="simple">
<li><p>The rank of the current MPI process as <a class="reference internal" href="#smilei_mpi_rank" title="smilei_mpi_rank"><code class="xref py py-data docutils literal notranslate"><span class="pre">smilei_mpi_rank</span></code></a>.</p></li>
<li><p>The total number of MPI processes as <a class="reference internal" href="#smilei_mpi_size" title="smilei_mpi_size"><code class="xref py py-data docutils literal notranslate"><span class="pre">smilei_mpi_size</span></code></a>.</p></li>
<li><p>The maximum random integer as <a class="reference internal" href="#smilei_rand_max" title="smilei_rand_max"><code class="xref py py-data docutils literal notranslate"><span class="pre">smilei_rand_max</span></code></a>.</p></li>
</ul>
</li>
<li><p>The namelist(s) is executed.</p></li>
<li><p><em>Python</em> runs <code class="xref py py-data docutils literal notranslate"><span class="pre">preprocess()</span></code> if the user has defined it.
This is a good place to calculate things that are not needed for
post-processing with <strong class="program">happi</strong>.</p></li>
<li><p>The simulation is initialized (including field and particle arrays).</p></li>
<li><p><em>Python</em> runs <code class="xref py py-data docutils literal notranslate"><span class="pre">cleanup()</span></code> if the user has defined it.
This is a good place to delete unused heavy variables.</p></li>
<li><p><em>Python</em> checks whether the <em>python</em> interpreter is needed during the simulation
(e.g. the user has defined a temporal <a class="reference internal" href="#profiles"><span class="std std-ref">profile</span></a> which requires <em>python</em>
to calculate it every timestep). Otherwise, <em>python</em> is stopped.</p></li>
</ol>
<p>All these instructions are summarized in a file <code class="docutils literal notranslate"><span class="pre">smilei.py</span></code>,
so that the user can directly run <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-i</span> <span class="pre">smilei.py</span></code> for post-processing purposes.</p>
</div>
<hr class="docutils" />
<div class="section" id="main-variables">
<h2>Main variables<a class="headerlink" href="#main-variables" title="Permalink to this headline">¶</a></h2>
<p>The block <code class="docutils literal notranslate"><span class="pre">Main</span></code> is <strong>mandatory</strong> and has the following syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Main</span><span class="p">(</span>
    <span class="n">geometry</span> <span class="o">=</span> <span class="s2">&quot;1Dcartesian&quot;</span><span class="p">,</span>
    <span class="n">interpolation_order</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">grid_length</span>  <span class="o">=</span> <span class="p">[</span><span class="mf">16.</span> <span class="p">],</span>
    <span class="n">cell_length</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">],</span>
    <span class="n">simulation_time</span>    <span class="o">=</span> <span class="mf">15.</span><span class="p">,</span>
    <span class="n">timestep</span>    <span class="o">=</span> <span class="mf">0.005</span><span class="p">,</span>
    <span class="n">number_of_patches</span> <span class="o">=</span> <span class="p">[</span><span class="mi">64</span><span class="p">],</span>
    <span class="n">clrw</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">maxwell_solver</span> <span class="o">=</span> <span class="s1">&#39;Yee&#39;</span><span class="p">,</span>
    <span class="n">EM_boundary_conditions</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">&quot;silver-muller&quot;</span><span class="p">,</span> <span class="s2">&quot;silver-muller&quot;</span><span class="p">],</span>
<span class="c1">#        [&quot;silver-muller&quot;, &quot;silver-muller&quot;],</span>
<span class="c1">#        [&quot;silver-muller&quot;, &quot;silver-muller&quot;],</span>
    <span class="p">],</span>
    <span class="n">time_fields_frozen</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">reference_angular_frequency_SI</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">print_every</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
    <span class="n">random_seed</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="data">
<dt id="geometry">
<code class="sig-name descname">geometry</code><a class="headerlink" href="#geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>The geometry of the simulation:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;1Dcartesian&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;2Dcartesian&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;3Dcartesian&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;AMcylindrical&quot;</span></code>: cylindrical geometry with azimuthal Fourier decomposition. See <a class="reference internal" href="algorithms.html"><span class="doc">PIC algorithms</span></a>.</p></li>
</ul>
<p>In the following documentation, all references to dimensions or coordinates
depend on the <code class="docutils literal notranslate"><span class="pre">geometry</span></code>.
1D, 2D and 3D stand for 1-dimensional, 2-dimensional and 3-dimensional cartesian
geometries, respectively. All coordinates are ordered as <span class="math notranslate nohighlight">\((x)\)</span>, <span class="math notranslate nohighlight">\((x,y)\)</span> or <span class="math notranslate nohighlight">\((x,y,z)\)</span>.
In the <code class="docutils literal notranslate"><span class="pre">&quot;AMcylindrical&quot;</span></code> case, all grid coordinates are 2-dimensional
<span class="math notranslate nohighlight">\((x,r)\)</span>, while particle coordinates (in <a class="reference internal" href="#species"><span class="std std-ref">Species</span></a>)
are expressed in the 3-dimensional Cartesian frame <span class="math notranslate nohighlight">\((x,y,z)\)</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The <code class="docutils literal notranslate"><span class="pre">&quot;AMcylindrical&quot;</span></code> geometry has some restrictions.
Boundary conditions must be set to <code class="docutils literal notranslate"><span class="pre">&quot;remove&quot;</span></code> for particles,
<code class="docutils literal notranslate"><span class="pre">&quot;silver-muller&quot;</span></code> for longitudinal EM boundaries and
<code class="docutils literal notranslate"><span class="pre">&quot;buneman&quot;</span></code> for transverse EM boundaries.
Vectorization, collisions, scalar diagnostics and
order-4 interpolation are not supported yet.</p>
</div>
</dd></dl>

<dl class="data">
<dt id="interpolation_order">
<code class="sig-name descname">interpolation_order</code><a class="headerlink" href="#interpolation_order" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p>
</dd>
</dl>
<p>Interpolation order, defines particle shape function:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code>  : 3 points stencil, supported in all configurations.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">4</span></code>  : 5 points stencil, not supported in vectorized 2D geometry.</p></li>
</ul>
</dd></dl>

<dl class="data">
<dt id="grid_length">
<code class="sig-name descname">grid_length</code><a class="headerlink" href="#grid_length" title="Permalink to this definition">¶</a></dt>
<dt id="number_of_cells">
<code class="sig-name descname">number_of_cells</code><a class="headerlink" href="#number_of_cells" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>A list of numbers: size of the simulation box for each dimension of the simulation.</dt><dd><ul class="simple">
<li><p>Either <code class="docutils literal notranslate"><span class="pre">grid_length</span></code>, the simulation length in each direction in units of <span class="math notranslate nohighlight">\(L_r\)</span>,</p></li>
<li><p>or <code class="docutils literal notranslate"><span class="pre">number_of_cells</span></code>, the number of cells in each direction.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="data">
<dt id="cell_length">
<code class="sig-name descname">cell_length</code><a class="headerlink" href="#cell_length" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of floats: sizes of one cell in each direction in units of <span class="math notranslate nohighlight">\(L_r\)</span>.</p>
</dd></dl>

<dl class="data">
<dt id="simulation_time">
<code class="sig-name descname">simulation_time</code><a class="headerlink" href="#simulation_time" title="Permalink to this definition">¶</a></dt>
<dt id="number_of_timesteps">
<code class="sig-name descname">number_of_timesteps</code><a class="headerlink" href="#number_of_timesteps" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Duration of the simulation.</dt><dd><ul class="simple">
<li><p>Either <code class="docutils literal notranslate"><span class="pre">simulation_time</span></code>, the simulation duration in units of <span class="math notranslate nohighlight">\(T_r\)</span>,</p></li>
<li><p>or <code class="docutils literal notranslate"><span class="pre">number_of_timesteps</span></code>, the total number of timesteps.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="data">
<dt id="timestep">
<code class="sig-name descname">timestep</code><a class="headerlink" href="#timestep" title="Permalink to this definition">¶</a></dt>
<dt id="timestep_over_CFL">
<code class="sig-name descname">timestep_over_CFL</code><a class="headerlink" href="#timestep_over_CFL" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Duration of one timestep.</dt><dd><ul class="simple">
<li><p>Either <code class="docutils literal notranslate"><span class="pre">timestep</span></code>, in units of <span class="math notranslate nohighlight">\(T_r\)</span>,</p></li>
<li><p>or <code class="docutils literal notranslate"><span class="pre">timestep_over_CFL</span></code>, in units of the <em>Courant–Friedrichs–Lewy</em> (CFL) time.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="data">
<dt id="number_of_patches">
<code class="sig-name descname">number_of_patches</code><a class="headerlink" href="#number_of_patches" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of integers: the number of patches in each direction.
Each integer must be a power of 2, and the total number of patches must be
greater or equal than the number of MPI processes.
It is also strongly advised to have more patches than the total number of openMP threads.
See <a class="reference internal" href="parallelization.html"><span class="doc">Parallelization basics</span></a>.</p>
</dd></dl>

<dl class="data">
<dt id="patch_arrangement">
<code class="sig-name descname">patch_arrangement</code><a class="headerlink" href="#patch_arrangement" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;hilbertian&quot;</span></code></p>
</dd>
</dl>
<p>Determines the ordering of patches and the way they are separated into the
various MPI processes. Options are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;hilbertian&quot;</span></code>: following the Hilbert curve (see <a class="reference internal" href="parallelization.html#loadbalancingexplanation"><span class="std std-ref">this explanation</span></a>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;linearized_XY&quot;</span></code> in 2D or <code class="docutils literal notranslate"><span class="pre">&quot;linearized_XYZ&quot;</span></code> in 3D: following the
row-major (C-style) ordering.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;linearized_YX&quot;</span></code> in 2D or <code class="docutils literal notranslate"><span class="pre">&quot;linearized_ZYX&quot;</span></code> in 3D: following the
column-major (fortran-style) ordering. This prevents the usage of
<a class="reference internal" href="#diagfields"><span class="std std-ref">Fields diagnostics</span></a> (see <a class="reference internal" href="parallelization.html"><span class="doc">Parallelization basics</span></a>).</p></li>
</ul>
</dd></dl>

<dl class="data">
<dt id="clrw">
<code class="sig-name descname">clrw</code><a class="headerlink" href="#clrw" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>set to minimize the memory footprint of the particles pusher, especially interpolation and projection processes</p>
</dd>
</dl>
<p>For advanced users. Integer specifying the cluster width along X direction in number of cells.
The “cluster” is a sub-patch structure in which particles are sorted for cache improvement.
<code class="docutils literal notranslate"><span class="pre">clrw</span></code> must divide the number of cells in one patch (in dimension X).
The finest sorting is achieved with <code class="docutils literal notranslate"><span class="pre">clrw=1</span></code> and no sorting with <code class="docutils literal notranslate"><span class="pre">clrw</span></code> equal to the full size of a patch along dimension X.
The cluster size in dimension Y and Z is always the full extent of the patch.</p>
</dd></dl>

<dl class="data">
<dt id="maxwell_solver">
<code class="sig-name descname">maxwell_solver</code><a class="headerlink" href="#maxwell_solver" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>‘Yee’</p>
</dd>
</dl>
<p>The solver for Maxwell’s equations. Only <code class="docutils literal notranslate"><span class="pre">&quot;Yee&quot;</span></code> is available for all geometries at the moment. <code class="docutils literal notranslate"><span class="pre">&quot;Cowan&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Grassi&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;Lehe&quot;</span></code> are available for <code class="docutils literal notranslate"><span class="pre">2DCartesian</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;Lehe&quot;</span></code> is available for <code class="docutils literal notranslate"><span class="pre">3DCartesian</span></code>. The Lehe solver is described in <a class="reference external" href="https://journals.aps.org/prab/abstract/10.1103/PhysRevSTAB.16.021301">this paper</a></p>
</dd></dl>

<dl class="data">
<dt id="solve_poisson">
<code class="sig-name descname">solve_poisson</code><a class="headerlink" href="#solve_poisson" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>True</p>
</dd>
</dl>
<p>Decides if Poisson correction must be applied or not initially.</p>
</dd></dl>

<dl class="data">
<dt id="poisson_max_iteration">
<code class="sig-name descname">poisson_max_iteration</code><a class="headerlink" href="#poisson_max_iteration" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>50000</p>
</dd>
</dl>
<p>Maximum number of iteration for the Poisson solver.</p>
</dd></dl>

<dl class="data">
<dt id="poisson_max_error">
<code class="sig-name descname">poisson_max_error</code><a class="headerlink" href="#poisson_max_error" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1e-14</p>
</dd>
</dl>
<p>Maximum error for the Poisson solver.</p>
</dd></dl>

<dl class="data">
<dt id="solve_relativistic_poisson">
<code class="sig-name descname">solve_relativistic_poisson</code><a class="headerlink" href="#solve_relativistic_poisson" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>False</p>
</dd>
</dl>
<p>Decides if relativistic Poisson problem must be solved for at least one species.
See <a class="reference internal" href="relativistic_fields_initialization.html"><span class="doc">Field initialization for relativistic species</span></a> for more details.</p>
</dd></dl>

<dl class="data">
<dt id="relativistic_poisson_max_iteration">
<code class="sig-name descname">relativistic_poisson_max_iteration</code><a class="headerlink" href="#relativistic_poisson_max_iteration" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>50000</p>
</dd>
</dl>
<p>Maximum number of iteration for the Poisson solver.</p>
</dd></dl>

<dl class="data">
<dt id="relativistic_poisson_max_error">
<code class="sig-name descname">relativistic_poisson_max_error</code><a class="headerlink" href="#relativistic_poisson_max_error" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1e-22</p>
</dd>
</dl>
<p>Maximum error for the Poisson solver.</p>
</dd></dl>

<dl class="data">
<dt id="EM_boundary_conditions">
<code class="sig-name descname">EM_boundary_conditions</code><a class="headerlink" href="#EM_boundary_conditions" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of lists of strings</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">[[&quot;periodic&quot;]]</span></code></p>
</dd>
</dl>
<p>The boundary conditions for the electromagnetic fields. Each boundary may have one of
the following conditions: <code class="docutils literal notranslate"><span class="pre">&quot;periodic&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;silver-muller&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">&quot;reflective&quot;</span></code>.</p>
<div class="line-block">
<div class="line"><strong>Syntax 1:</strong> <code class="docutils literal notranslate"><span class="pre">[[bc_all]]</span></code>, identical for all boundaries.</div>
<div class="line"><strong>Syntax 2:</strong> <code class="docutils literal notranslate"><span class="pre">[[bc_X],</span> <span class="pre">[bc_Y],</span> <span class="pre">...]</span></code>, different depending on x, y or z.</div>
<div class="line"><strong>Syntax 3:</strong> <code class="docutils literal notranslate"><span class="pre">[[bc_Xmin,</span> <span class="pre">bc_Xmax],</span> <span class="pre">...]</span></code>,  different on each boundary.</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">&quot;silver-muller&quot;</span></code> is an open boundary condition. The incident wave vector <span class="math notranslate nohighlight">\(k_{inc}\)</span> on each face is defined by <code class="docutils literal notranslate"><span class="pre">&quot;EM_boundary_conditions_k&quot;</span></code>.
When using <code class="docutils literal notranslate"><span class="pre">&quot;silver-muller&quot;</span></code> as an injecting boundary, make sure <span class="math notranslate nohighlight">\(k_{inc}\)</span> is aligned with the wave you are injecting.
When using <code class="docutils literal notranslate"><span class="pre">&quot;silver-muller&quot;</span></code> as an absorbing boundary, the optimal wave absorption on a given face will be along <span class="math notranslate nohighlight">\(k_{abs}\)</span> the specular reflection of <span class="math notranslate nohighlight">\(k_{inc}\)</span> on the considered face.</p>
</dd></dl>

<dl class="data">
<dt id="EM_boundary_conditions_k">
<code class="sig-name descname">EM_boundary_conditions_k</code><a class="headerlink" href="#EM_boundary_conditions_k" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of lists of floats</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">[[1.,0.],[-1.,0.],[0.,1.],[0.,-1.]]</span></code> in 2D</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">[[1.,0.,0.],[-1.,0.,0.],[0.,1.,0.],[0.,-1.,0.],[0.,0.,1.],[0.,0.,-1.]]</span></code> in 3D</p>
</dd>
</dl>
<p>The incident unit wave vector <cite>k</cite> for each face (sequentially Xmin, Xmax, Ymin, Ymax, Zmin, Zmax) is
defined by its coordinates in the <cite>xyz</cite> frame.
The number of coordinates is equal to the dimension of the simulation. The number of given vectors must be equal to 1 or to the number of faces which is twice the dimension of the simulation. In cylindrical geometry, <cite>k</cite> coordinates are given in the <cite>xr</cite> frame and only the Rmax face is affected.</p>
<div class="line-block">
<div class="line"><strong>Syntax 1:</strong> <code class="docutils literal notranslate"><span class="pre">[[1,0,0]]</span></code>, identical for all boundaries.</div>
<div class="line"><strong>Syntax 2:</strong> <code class="docutils literal notranslate"><span class="pre">[[1,0,0],[-1,0,0],</span> <span class="pre">...]</span></code>,  different on each boundary.</div>
</div>
</dd></dl>

<dl class="data">
<dt id="time_fields_frozen">
<code class="sig-name descname">time_fields_frozen</code><a class="headerlink" href="#time_fields_frozen" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><ol class="arabic simple" start="0">
<li></li>
</ol>
</dd>
</dl>
<p>Time, at the beginning of the simulation, during which fields are frozen.</p>
</dd></dl>

<span class="target" id="reference-angular-frequency-si"></span><dl class="data">
<dt id="reference_angular_frequency_SI">
<code class="sig-name descname">reference_angular_frequency_SI</code><a class="headerlink" href="#reference_angular_frequency_SI" title="Permalink to this definition">¶</a></dt>
<dd><p>The value of the reference angular frequency <span class="math notranslate nohighlight">\(\omega_r\)</span> in SI units,
<strong>only needed when collisions, ionization, radiation losses
or multiphoton Breit-Wheeler pair creation are requested</strong>.
This frequency is related to the normalization length according to <span class="math notranslate nohighlight">\(L_r\omega_r = c\)</span>
(see <a class="reference internal" href="units.html"><span class="doc">Units</span></a>).</p>
</dd></dl>

<dl class="data">
<dt id="print_every">
<code class="sig-name descname">print_every</code><a class="headerlink" href="#print_every" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of timesteps between each info output on screen. By default, 10 outputs per
simulation.</p>
</dd></dl>

<dl class="data">
<dt id="print_expected_disk_usage">
<code class="sig-name descname">print_expected_disk_usage</code><a class="headerlink" href="#print_expected_disk_usage" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><cite>True</cite></p>
</dd>
</dl>
<p>If <cite>False</cite>, the calculation of the expected disk usage, that is usually printed in the
standard output, is skipped. This might be useful in rare cases where this calculation
is costly.</p>
</dd></dl>

<dl class="data">
<dt id="random_seed">
<code class="sig-name descname">random_seed</code><a class="headerlink" href="#random_seed" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>the machine clock</p>
</dd>
</dl>
<p>The value of the random seed. To create a per-processor random seed, you may use
the variable  <a class="reference internal" href="#smilei_mpi_rank" title="smilei_mpi_rank"><code class="xref py py-data docutils literal notranslate"><span class="pre">smilei_mpi_rank</span></code></a>.</p>
</dd></dl>

<dl class="data">
<dt id="number_of_AM">
<code class="sig-name descname">number_of_AM</code><a class="headerlink" href="#number_of_AM" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>2</p>
</dd>
</dl>
<p>The number of azimuthal modes used for the Fourier decomposition in <code class="docutils literal notranslate"><span class="pre">&quot;AMcylindrical&quot;</span></code> geometry.
The modes range from mode 0 to mode <cite>“number_of_AM-1”</cite>.</p>
</dd></dl>

<dl class="data">
<dt id="number_of_AM_relativistic_field_initialization">
<code class="sig-name descname">number_of_AM_relativistic_field_initialization</code><a class="headerlink" href="#number_of_AM_relativistic_field_initialization" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1</p>
</dd>
</dl>
<p>The number of azimuthal modes used for the relativistic field initialization in <code class="docutils literal notranslate"><span class="pre">&quot;AMcylindrical&quot;</span></code> geometry.
Note that this number must be lower or equal to the number of modes of the simulation.</p>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="load-balancing">
<h2>Load Balancing<a class="headerlink" href="#load-balancing" title="Permalink to this headline">¶</a></h2>
<p>Load balancing (explained <a class="reference internal" href="parallelization.html#loadbalancingexplanation"><span class="std std-ref">here</span></a>) consists in exchanging
patches (domains of the simulation box) between MPI processes to reduce the
computational load imbalance.
The block <code class="docutils literal notranslate"><span class="pre">LoadBalancing</span></code> is optional. If you do not define it, load balancing will
occur every 150 iterations.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">LoadBalancing</span><span class="p">(</span>
    <span class="n">initial_balance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">150</span><span class="p">,</span>
    <span class="n">cell_load</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">frozen_particle_load</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="data">
<dt id="initial_balance">
<code class="sig-name descname">initial_balance</code><a class="headerlink" href="#initial_balance" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>True</p>
</dd>
</dl>
<p>Decides if the load must be balanced at initialization. If not, the same amount of
patches will be attributed to each MPI rank.</p>
</dd></dl>

<dl class="data">
<dt id="every">
<code class="sig-name descname">every</code><a class="headerlink" href="#every" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>150</p>
</dd>
</dl>
<p>Number of timesteps between each load balancing <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.
The value <code class="docutils literal notranslate"><span class="pre">0</span></code> suppresses all load balancing.</p>
</dd></dl>

<dl class="data">
<dt id="cell_load">
<code class="sig-name descname">cell_load</code><a class="headerlink" href="#cell_load" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><ol class="arabic simple">
<li></li>
</ol>
</dd>
</dl>
<p>Computational load of a single grid cell considered by the dynamic load balancing algorithm.
This load is normalized to the load of a single particle.</p>
</dd></dl>

<dl class="data">
<dt id="frozen_particle_load">
<code class="sig-name descname">frozen_particle_load</code><a class="headerlink" href="#frozen_particle_load" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>0.1</p>
</dd>
</dl>
<p>Computational load of a single frozen particle considered by the dynamic load balancing algorithm.
This load is normalized to the load of a single particle.</p>
</dd></dl>

<hr class="docutils" />
</div>
<div class="section" id="vectorization">
<span id="id1"></span><h2>Vectorization<a class="headerlink" href="#vectorization" title="Permalink to this headline">¶</a></h2>
<p>The block <code class="docutils literal notranslate"><span class="pre">Vectorization</span></code> is optional.
It controls the SIMD operations that can enhance the performance of some computations.
The technique is detailed in Ref. <a class="reference internal" href="material.html#beck2019" id="id2"><span>[Beck2019]</span></a> and summarized in <a class="reference internal" href="vectorization.html"><span class="doc">this doc</span></a>.
It requires <a class="reference internal" href="installation.html#vectorization-flags"><span class="std std-ref">additional compilation options</span></a> to be actived.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Vectorization</span><span class="p">(</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;adaptive&quot;</span><span class="p">,</span>
    <span class="n">reconfigure_every</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">initial_mode</span> <span class="o">=</span> <span class="s2">&quot;on&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="data">
<dt id="mode">
<code class="sig-name descname">mode</code><a class="headerlink" href="#mode" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;off&quot;</span></code></p>
</dd>
</dl>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;off&quot;</span></code>: non-vectorized operators are used.
Recommended when the number of particles per cell stays below 10.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;on&quot;</span></code>: vectorized operators are used.
Recommended when the number of particles per cell stays above 10.
Particles are sorted per cell.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;adaptive&quot;</span></code>: the best operators (scalar or vectorized)
are determined and configured dynamically and locally
(per patch and per species).
Particles are sorted per cell.</p></li>
</ul>
<p>In the <code class="docutils literal notranslate"><span class="pre">&quot;adaptive&quot;</span></code> mode, <a class="reference internal" href="#clrw" title="clrw"><code class="xref py py-data docutils literal notranslate"><span class="pre">clrw</span></code></a> is set to the maximum.</p>
</dd></dl>

<dl class="data">
<dt id="reconfigure_every">
<code class="sig-name descname">reconfigure_every</code><a class="headerlink" href="#reconfigure_every" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>20</p>
</dd>
</dl>
<p>The number of timesteps between each dynamic reconfiguration of
the vectorized operators, when using the  <code class="docutils literal notranslate"><span class="pre">&quot;adaptive&quot;</span></code> vectorization mode.
It may be set to a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a> as well.</p>
</dd></dl>

<dl class="data">
<dt id="initial_mode">
<code class="sig-name descname">initial_mode</code><a class="headerlink" href="#initial_mode" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">off</span></code></p>
</dd>
</dl>
<p>Default state when the <code class="docutils literal notranslate"><span class="pre">&quot;adaptive&quot;</span></code> mode is activated
and no particle is present in the patch.</p>
</dd></dl>

<hr class="docutils" />
</div>
<div class="section" id="moving-window">
<span id="movingwindow"></span><h2>Moving window<a class="headerlink" href="#moving-window" title="Permalink to this headline">¶</a></h2>
<p>The simulated domain can move relatively to its the initial position. The “moving window”
is (almost) periodically shifted in the <code class="docutils literal notranslate"><span class="pre">x_max</span></code> direction.
Each “shift” consists in removing a column of patches from the <code class="docutils literal notranslate"><span class="pre">x_min</span></code> border and
adding a new one after the <code class="docutils literal notranslate"><span class="pre">x_max</span></code> border, thus changing the physical domain that the
simulation represents but keeping the same box size. This is particularly useful to
<em>follow</em> waves or plasma moving at high speed.
The frequency of the shifts is adjusted so that the average displacement velocity over many shifts matches the velocity
given by the user.
The user may ask for a given number of additional shifts at a given time.
These additional shifts are not taken into account for the evaluation of the average velocity of the moving window.</p>
<p>The block <code class="docutils literal notranslate"><span class="pre">MovingWindow</span></code> is optional. The window does not move it you do not define it.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">MovingWindow</span><span class="p">(</span>
    <span class="n">time_start</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">velocity_x</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">number_of_additional_shifts</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">additional_shifts_time</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="data">
<dt id="time_start">
<code class="sig-name descname">time_start</code><a class="headerlink" href="#time_start" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><ol class="arabic simple" start="0">
<li></li>
</ol>
</dd>
</dl>
<p>The time at which the window starts moving.</p>
</dd></dl>

<dl class="data">
<dt id="velocity_x">
<code class="sig-name descname">velocity_x</code><a class="headerlink" href="#velocity_x" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><ol class="arabic simple" start="0">
<li></li>
</ol>
</dd>
</dl>
<p>The average velocity of the moving window in the <cite>x_max</cite> direction. It muste be between 0 and 1.</p>
</dd></dl>

<dl class="data">
<dt id="number_of_additional_shifts">
<code class="sig-name descname">number_of_additional_shifts</code><a class="headerlink" href="#number_of_additional_shifts" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><ol class="arabic simple" start="0">
<li></li>
</ol>
</dd>
</dl>
<p>The number of additional shifts of the moving window.</p>
</dd></dl>

<dl class="data">
<dt id="additional_shifts_time">
<code class="sig-name descname">additional_shifts_time</code><a class="headerlink" href="#additional_shifts_time" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><ol class="arabic simple" start="0">
<li></li>
</ol>
</dd>
</dl>
<p>The time at which the additional shifts are done.</p>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="#diagparticlebinning"><span class="std std-ref">particle binning diagnostics</span></a> accept an “axis” called <code class="docutils literal notranslate"><span class="pre">moving_x</span></code>
corresponding to the <cite>x</cite> coordinate corrected by the moving window’s current movement.</p>
</div>
<hr class="docutils" />
</div>
<div class="section" id="current-filtering">
<span id="currentfilter"></span><h2>Current filtering<a class="headerlink" href="#current-filtering" title="Permalink to this headline">¶</a></h2>
<p>The present version of <strong class="program">Smilei</strong> provides a <a class="reference internal" href="algorithms.html#multipassbinomialfilter"><span class="std std-ref">multi-pass binomial filter</span></a> on the current densities,
which parameters are controlled in the following block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CurrentFilter</span><span class="p">(</span>
    <span class="n">model</span> <span class="o">=</span> <span class="s2">&quot;binomial&quot;</span><span class="p">,</span>
    <span class="n">passes</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="data">
<dt id="model">
<code class="sig-name descname">model</code><a class="headerlink" href="#model" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;binomial&quot;</span></code></p>
</dd>
</dl>
<p>The model for current filtering. Presently, only <code class="docutils literal notranslate"><span class="pre">&quot;binomial&quot;</span></code> current filtering is available.</p>
</dd></dl>

<dl class="data">
<dt id="passes">
<code class="sig-name descname">passes</code><a class="headerlink" href="#passes" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p>The number of passes in the filter at each timestep.</p>
</dd></dl>

<hr class="docutils" />
</div>
<div class="section" id="field-filtering">
<span id="fieldfilter"></span><h2>Field filtering<a class="headerlink" href="#field-filtering" title="Permalink to this headline">¶</a></h2>
<p>The present version of <strong class="program">Smilei</strong> provides a method for field filtering
(at the moment, only the <a class="reference internal" href="algorithms.html#efieldfilter"><span class="std std-ref">Friedman electric field time-filter</span></a> is available)
which parameters are controlled in the following block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FieldFilter</span><span class="p">(</span>
    <span class="n">model</span> <span class="o">=</span> <span class="s2">&quot;Friedman&quot;</span><span class="p">,</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="data">
<dt>
<code class="sig-name descname">model</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;Friedman&quot;</span></code></p>
</dd>
</dl>
<p>The model for field filtering. Presently, only <code class="docutils literal notranslate"><span class="pre">&quot;Friedman&quot;</span></code> field filtering is available.</p>
</dd></dl>

<dl class="data">
<dt id="theta">
<code class="sig-name descname">theta</code><a class="headerlink" href="#theta" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">0.</span></code></p>
</dd>
</dl>
<p>The <span class="math notranslate nohighlight">\(\theta\)</span> parameter (between 0 and 1) of Friedman’s method.</p>
</dd></dl>

<hr class="docutils" />
</div>
<div class="section" id="species">
<span id="id3"></span><h2>Species<a class="headerlink" href="#species" title="Permalink to this headline">¶</a></h2>
<p>Each species has to be defined in a <code class="docutils literal notranslate"><span class="pre">Species</span></code> block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Species</span><span class="p">(</span>
    <span class="n">name</span>      <span class="o">=</span> <span class="s2">&quot;electrons1&quot;</span><span class="p">,</span>
    <span class="n">position_initialization</span> <span class="o">=</span> <span class="s2">&quot;random&quot;</span><span class="p">,</span>
    <span class="n">momentum_initialization</span> <span class="o">=</span> <span class="s2">&quot;maxwell-juettner&quot;</span><span class="p">,</span>
    <span class="n">regular_number</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">particles_per_cell</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
    <span class="n">mass</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">atomic_number</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="c1">#maximum_charge_state = None,</span>
    <span class="n">number_density</span> <span class="o">=</span> <span class="mf">10.</span><span class="p">,</span>
    <span class="c1"># charge_density = None,</span>
    <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span>
    <span class="n">mean_velocity</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">],</span>
    <span class="n">temperature</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e-10</span><span class="p">],</span>
    <span class="n">boundary_conditions</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">&quot;reflective&quot;</span><span class="p">,</span> <span class="s2">&quot;reflective&quot;</span><span class="p">],</span>
    <span class="c1">#    [&quot;periodic&quot;, &quot;periodic&quot;],</span>
    <span class="c1">#    [&quot;periodic&quot;, &quot;periodic&quot;],</span>
    <span class="p">],</span>
    <span class="c1"># thermal_boundary_temperature = None,</span>
    <span class="c1"># thermal_boundary_velocity = None,</span>
    <span class="n">time_frozen</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="c1"># ionization_model = &quot;none&quot;,</span>
    <span class="c1"># ionization_electrons = None,</span>
    <span class="c1"># ionization_rate = None,</span>
    <span class="n">is_test</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="c1"># ponderomotive_dynamics = False,</span>
    <span class="n">c_part_max</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">pusher</span> <span class="o">=</span> <span class="s2">&quot;boris&quot;</span><span class="p">,</span>

    <span class="c1"># Radiation reaction, for particles only:</span>
    <span class="n">radiation_model</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span>
    <span class="n">radiation_photon_species</span> <span class="o">=</span> <span class="s2">&quot;photon&quot;</span><span class="p">,</span>
    <span class="n">radiation_photon_sampling</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">radiation_photon_gamma_threshold</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>

    <span class="c1"># Relativistic field initialization:</span>
    <span class="n">relativistic_field_initialization</span> <span class="o">=</span> <span class="s2">&quot;False&quot;</span><span class="p">,</span>

    <span class="c1"># For photon species only:</span>
    <span class="n">multiphoton_Breit_Wheeler</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electron&quot;</span><span class="p">,</span><span class="s2">&quot;positron&quot;</span><span class="p">],</span>
    <span class="n">multiphoton_Breit_Wheeler_sampling</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Merging</span>
    <span class="n">merging_method</span> <span class="o">=</span> <span class="s2">&quot;vranic_spherical&quot;</span><span class="p">,</span>
    <span class="n">merge_every</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">merge_min_particles_per_cell</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
    <span class="n">merge_max_packet_size</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">merge_min_packet_size</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">merge_momentum_cell_size</span> <span class="o">=</span> <span class="p">[</span><span class="mi">32</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="data">
<dt id="name">
<code class="sig-name descname">name</code><a class="headerlink" href="#name" title="Permalink to this definition">¶</a></dt>
<dd><p>The name you want to give to this species.</p>
</dd></dl>

<dl class="data">
<dt id="position_initialization">
<code class="sig-name descname">position_initialization</code><a class="headerlink" href="#position_initialization" title="Permalink to this definition">¶</a></dt>
<dd><p>The method for initialization of particle positions. Options are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;regular&quot;</span></code> for regularly spaced. In that case the number of particles per cell per dimension can be set by using <cite>regular_number</cite>.
Otherwise, the number of particles per cell per dimension is the same in all dimensions and therefore the <cite>particles_per_cell</cite> must be
an integer to the power of the simulation dimension ( i.e. a square number in dimension 2).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;random&quot;</span></code> for randomly distributed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;centered&quot;</span></code> for centered in each cell</p></li>
<li><p>The <a class="reference internal" href="#name" title="name"><code class="xref py py-data docutils literal notranslate"><span class="pre">name</span></code></a> of another species from which the positions are copied.
This option requires (1) that the <em>target</em> species’ positions are initialized
using one of the three other options above and (2) that the number of particles
of both species are identical in each cell.</p></li>
<li><p>A <em>numpy</em> array defining all the positions of the species’ particles.
In this case you must also provide the weight of each particle (see <a class="reference internal" href="units.html#weights"><span class="std std-ref">Macro-particle weights</span></a>).
The array shape must be <cite>(Ndim+1, Npart)</cite> where <cite>Ndim</cite> is the number of particle dimensions (of the particles),
and <cite>Npart</cite> is the total number of particles. Positions components <cite>x</cite>, <cite>y</cite>, <cite>z</cite> are
given along the first <cite>Ndim</cite> columns and the weights are given in the last column of the array.
This initialization is incompatible with <a class="reference internal" href="#number_density" title="number_density"><code class="xref py py-data docutils literal notranslate"><span class="pre">number_density</span></code></a>, <a class="reference internal" href="#charge_density" title="charge_density"><code class="xref py py-data docutils literal notranslate"><span class="pre">charge_density</span></code></a>
and <a class="reference internal" href="#particles_per_cell" title="particles_per_cell"><code class="xref py py-data docutils literal notranslate"><span class="pre">particles_per_cell</span></code></a>. Particles initialized outside of the initial simulation domain
will not be created. This initalization is disregarded when running a <cite>restart</cite>.</p></li>
</ul>
</dd></dl>

<dl class="data">
<dt id="regular_number">
<code class="sig-name descname">regular_number</code><a class="headerlink" href="#regular_number" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>A python list of integers.</p>
</dd>
</dl>
<p>This list sets the number of evenly spaced particles per cell per dimension at their initial positions.
The size of the list must be the simulation particle dimension. It can be used only if <cite>position_initialization</cite> is set to <cite>regular</cite>.
The product of the elements of the provided list must be equal to <cite>particles_per_cell</cite>.
The numbers are given in the order [<cite>Nx</cite>, <cite>Ny</cite>, <cite>Nz</cite>] in cartesian geometries and [<cite>Nx</cite>, <cite>Nr</cite>, <cite>Ntheta</cite>] in <cite>AMcylindrical</cite> in which
case we advise to use <span class="math notranslate nohighlight">\(Ntheta \geq  4\times (number\_of\_AM-1)\)</span>.</p>
</dd></dl>

<dl class="data">
<dt id="momentum_initialization">
<code class="sig-name descname">momentum_initialization</code><a class="headerlink" href="#momentum_initialization" title="Permalink to this definition">¶</a></dt>
<dd><p>The method for initialization of particle momenta. Options are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;maxwell-juettner&quot;</span></code> for a relativistic maxwellian (see <a class="reference internal" href="maxwell-juttner.html"><span class="doc">how it is done</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;rectangular&quot;</span></code> for a rectangular distribution</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;cold&quot;</span></code> for zero temperature</p></li>
<li><p>A <em>numpy</em> array defining all the momenta of the species’ particles (requires that
<a class="reference internal" href="#position_initialization" title="position_initialization"><code class="xref py py-data docutils literal notranslate"><span class="pre">position_initialization</span></code></a> also be an array with the same number of particles).
The array shape must be <cite>(3, Npart)</cite> where <cite>Npart</cite> is the total number of particles. Momentum components <cite>px</cite>, <cite>py</cite>, <cite>pz</cite>
are given in successive columns.This initialization is incompatible with
<a class="reference internal" href="#temperature" title="temperature"><code class="xref py py-data docutils literal notranslate"><span class="pre">temperature</span></code></a> and <a class="reference internal" href="#mean_velocity" title="mean_velocity"><code class="xref py py-data docutils literal notranslate"><span class="pre">mean_velocity</span></code></a>.</p></li>
</ul>
<p>The first 2 distributions depend on the parameter <a class="reference internal" href="#temperature" title="temperature"><code class="xref py py-data docutils literal notranslate"><span class="pre">temperature</span></code></a> explained below.</p>
</dd></dl>

<dl class="data">
<dt id="particles_per_cell">
<code class="sig-name descname">particles_per_cell</code><a class="headerlink" href="#particles_per_cell" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float or <em>python</em> function (see section <a class="reference internal" href="#profiles"><span class="std std-ref">Profiles</span></a>)</p>
</dd>
</dl>
<p>The number of particles per cell.</p>
</dd></dl>

<dl class="data">
<dt id="mass">
<code class="sig-name descname">mass</code><a class="headerlink" href="#mass" title="Permalink to this definition">¶</a></dt>
<dd><p>The mass of particles, in units of the electron mass <span class="math notranslate nohighlight">\(m_e\)</span>.</p>
</dd></dl>

<dl class="data">
<dt id="atomic_number">
<code class="sig-name descname">atomic_number</code><a class="headerlink" href="#atomic_number" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>0</p>
</dd>
</dl>
<p>The atomic number of the particles, required only for ionization.
It must be lower than 101.</p>
</dd></dl>

<dl class="data">
<dt id="maximum_charge_state">
<code class="sig-name descname">maximum_charge_state</code><a class="headerlink" href="#maximum_charge_state" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>0</p>
</dd>
</dl>
<p>The maximum charge state of a species for which the ionization model is <code class="docutils literal notranslate"><span class="pre">&quot;from_rate&quot;</span></code>.</p>
</dd></dl>

<dl class="data">
<dt id="number_density">
<code class="sig-name descname">number_density</code><a class="headerlink" href="#number_density" title="Permalink to this definition">¶</a></dt>
<dt id="charge_density">
<code class="sig-name descname">charge_density</code><a class="headerlink" href="#charge_density" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float or <em>python</em> function (see section <a class="reference internal" href="#profiles"><span class="std std-ref">Profiles</span></a>)</p>
</dd>
</dl>
<p>The absolute value of the number density or charge density (choose one only)
of the particle distribution, in units of the reference density <span class="math notranslate nohighlight">\(N_r\)</span> (see <a class="reference internal" href="units.html"><span class="doc">Units</span></a>).</p>
</dd></dl>

<dl class="data">
<dt id="charge">
<code class="sig-name descname">charge</code><a class="headerlink" href="#charge" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float or <em>python</em> function (see section <a class="reference internal" href="#profiles"><span class="std std-ref">Profiles</span></a>)</p>
</dd>
</dl>
<p>The particle charge, in units of the elementary charge <span class="math notranslate nohighlight">\(e\)</span>.</p>
</dd></dl>

<dl class="data">
<dt id="mean_velocity">
<code class="sig-name descname">mean_velocity</code><a class="headerlink" href="#mean_velocity" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>a list of 3 floats or <em>python</em> functions (see section <a class="reference internal" href="#profiles"><span class="std std-ref">Profiles</span></a>)</p>
</dd>
</dl>
<p>The initial drift velocity of the particles, in units of the speed of light <span class="math notranslate nohighlight">\(c\)</span>.</p>
<p><strong>WARNING</strong>: For massless particles, this is actually the momentum in units of <span class="math notranslate nohighlight">\(m_e c\)</span>.</p>
</dd></dl>

<dl class="data">
<dt id="temperature">
<code class="sig-name descname">temperature</code><a class="headerlink" href="#temperature" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>a list of 3 floats or <em>python</em> functions (see section <a class="reference internal" href="#profiles"><span class="std std-ref">Profiles</span></a>)</p>
</dd>
</dl>
<p>The initial temperature of the particles, in units of <span class="math notranslate nohighlight">\(m_ec^2\)</span>.</p>
</dd></dl>

<dl class="data">
<dt id="boundary_conditions">
<code class="sig-name descname">boundary_conditions</code><a class="headerlink" href="#boundary_conditions" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>a list of lists of strings</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">[[&quot;periodic&quot;]]</span></code></p>
</dd>
</dl>
<p>The boundary conditions for the particles of this species.
Each boundary may have one of the following conditions:
<code class="docutils literal notranslate"><span class="pre">&quot;periodic&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;reflective&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;remove&quot;</span></code> (particles are deleted),
<code class="docutils literal notranslate"><span class="pre">&quot;stop&quot;</span></code> (particle momenta are set to 0), and <code class="docutils literal notranslate"><span class="pre">&quot;thermalize&quot;</span></code>.
For photon species (<code class="docutils literal notranslate"><span class="pre">mass=0</span></code>), the last two options are not available.</p>
<div class="line-block">
<div class="line"><strong>Syntax 1:</strong> <code class="docutils literal notranslate"><span class="pre">[[bc_all]]</span></code>, identical for all boundaries.</div>
<div class="line"><strong>Syntax 2:</strong> <code class="docutils literal notranslate"><span class="pre">[[bc_X],</span> <span class="pre">[bc_Y],</span> <span class="pre">...]</span></code>, different depending on x, y or z.</div>
<div class="line"><strong>Syntax 3:</strong> <code class="docutils literal notranslate"><span class="pre">[[bc_Xmin,</span> <span class="pre">bc_Xmax],</span> <span class="pre">...]</span></code>,  different on each boundary.</div>
</div>
</dd></dl>

<dl class="data">
<dt id="thermal_boundary_temperature">
<code class="sig-name descname">thermal_boundary_temperature</code><a class="headerlink" href="#thermal_boundary_temperature" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p>A list of floats representing the temperature of the thermal boundaries (those set to
<code class="docutils literal notranslate"><span class="pre">&quot;thermalize&quot;</span></code> in  <a class="reference internal" href="#boundary_conditions" title="boundary_conditions"><code class="xref py py-data docutils literal notranslate"><span class="pre">boundary_conditions</span></code></a>) for each spatial coordinate.
Currently, only the first coordinate (x) is taken into account.</p>
</dd></dl>

<dl class="data">
<dt id="thermal_boundary_velocity">
<code class="sig-name descname">thermal_boundary_velocity</code><a class="headerlink" href="#thermal_boundary_velocity" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>[]</p>
</dd>
</dl>
<p>A list of floats representing the components of the drift velocity of
the thermal boundaries (those set to <code class="docutils literal notranslate"><span class="pre">&quot;thermalize&quot;</span></code> in <a class="reference internal" href="#boundary_conditions" title="boundary_conditions"><code class="xref py py-data docutils literal notranslate"><span class="pre">boundary_conditions</span></code></a>).</p>
</dd></dl>

<dl class="data">
<dt id="time_frozen">
<code class="sig-name descname">time_frozen</code><a class="headerlink" href="#time_frozen" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><ol class="arabic simple" start="0">
<li></li>
</ol>
</dd>
</dl>
<p>The time during which the particles are “frozen”, in units of <span class="math notranslate nohighlight">\(T_r\)</span>.
Frozen particles do not move and therefore do not deposit any current density either.
Nonetheless, they deposit a charge density.
They are computationally much cheaper than non-frozen particles and oblivious to any EM-fields
in the simulation. Note that frozen particles can be ionized (this is computationally much cheaper
if ion motion is not relevant).</p>
</dd></dl>

<dl class="data">
<dt id="ionization_model">
<code class="sig-name descname">ionization_model</code><a class="headerlink" href="#ionization_model" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code></p>
</dd>
</dl>
<p>The model for ionization:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;tunnel&quot;</span></code> for <a class="reference internal" href="ionization.html#field-ionization"><span class="std std-ref">field ionization</span></a> (requires species with an <a class="reference internal" href="#atomic_number" title="atomic_number"><code class="xref py py-data docutils literal notranslate"><span class="pre">atomic_number</span></code></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;from_rate&quot;</span></code>, relying on a <a class="reference internal" href="ionization.html#rate-ionization"><span class="std std-ref">user-defined ionization rate</span></a> (requires species with a <a class="reference internal" href="#maximum_charge_state" title="maximum_charge_state"><code class="xref py py-data docutils literal notranslate"><span class="pre">maximum_charge_state</span></code></a>).</p></li>
</ul>
</dd></dl>

<dl class="data">
<dt id="ionization_rate">
<code class="sig-name descname">ionization_rate</code><a class="headerlink" href="#ionization_rate" title="Permalink to this definition">¶</a></dt>
<dd><p>A python function giving the user-defined ionisation rate as a function of various particle attributes.
To use this option, the <a class="reference external" href="http://www.numpy.org/">numpy package</a> must be available in your python installation.
The function must have one argument, that you may call, for instance, <code class="docutils literal notranslate"><span class="pre">particles</span></code>.
This object has several attributes <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, <code class="docutils literal notranslate"><span class="pre">z</span></code>, <code class="docutils literal notranslate"><span class="pre">px</span></code>, <code class="docutils literal notranslate"><span class="pre">py</span></code>, <code class="docutils literal notranslate"><span class="pre">pz</span></code>, <code class="docutils literal notranslate"><span class="pre">charge</span></code>, <code class="docutils literal notranslate"><span class="pre">weight</span></code> and <code class="docutils literal notranslate"><span class="pre">id</span></code>.
Each of these attributes are provided as <strong>numpy</strong> arrays where each cell corresponds to one particle.</p>
<p>The following example defines, for a species with maximum charge state of 2,
an ionization rate that depends on the initial particle charge
and linear in the x coordinate:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">exp</span><span class="p">,</span> <span class="n">zeros_like</span>

<span class="k">def</span> <span class="nf">my_rate</span><span class="p">(</span><span class="n">particles</span><span class="p">):</span>
    <span class="n">rate</span> <span class="o">=</span> <span class="n">zeros_like</span><span class="p">(</span><span class="n">particles</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
    <span class="n">charge_0</span> <span class="o">=</span> <span class="p">(</span><span class="n">particles</span><span class="o">.</span><span class="n">charge</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">charge_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">particles</span><span class="o">.</span><span class="n">charge</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">rate</span><span class="p">[</span><span class="n">charge_0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span> <span class="o">*</span> <span class="n">particles</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">charge_0</span><span class="p">]</span>
    <span class="n">rate</span><span class="p">[</span><span class="n">charge_1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">*</span> <span class="n">particles</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">charge_1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">rate</span>

<span class="n">Species</span><span class="p">(</span> <span class="o">...</span><span class="p">,</span> <span class="n">ionization_rate</span> <span class="o">=</span> <span class="n">my_rate</span> <span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="data">
<dt id="ionization_electrons">
<code class="sig-name descname">ionization_electrons</code><a class="headerlink" href="#ionization_electrons" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of the electron species that <a class="reference internal" href="#ionization_model" title="ionization_model"><code class="xref py py-data docutils literal notranslate"><span class="pre">ionization_model</span></code></a> uses when creating new electrons.</p>
</dd></dl>

<dl class="data">
<dt id="is_test">
<code class="sig-name descname">is_test</code><a class="headerlink" href="#is_test" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
<p>Flag for test particles. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, this species will contain only test particles
which do not participate in the charge and currents.</p>
</dd></dl>

<dl class="data">
<dt id="ponderomotive_dynamics">
<code class="sig-name descname">ponderomotive_dynamics</code><a class="headerlink" href="#ponderomotive_dynamics" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
<p>Flag for particles interacting with an envelope model for the laser, if present.
If <code class="docutils literal notranslate"><span class="pre">True</span></code>, this species will project its susceptibility and be influenced by the laser envelope field.
See <a class="reference internal" href="laser_envelope.html"><span class="doc">Laser envelope model</span></a> for details on the dynamics of particles in presence of a laser envelope field.</p>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Ionization, Radiation and Multiphoton Breit-Wheeler pair creation are not yet implemented for species interacting with an envelope model for the laser.</p>
</div>
<dl class="data">
<dt id="c_part_max">
<code class="sig-name descname">c_part_max</code><a class="headerlink" href="#c_part_max" title="Permalink to this definition">¶</a></dt>
<dd><p><span class="red">to do</span></p>
</dd></dl>

<dl class="data">
<dt id="pusher">
<code class="sig-name descname">pusher</code><a class="headerlink" href="#pusher" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;boris&quot;</span></code></p>
</dd>
</dl>
<p>Type of pusher to be used for this species. Options are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;boris&quot;</span></code>: The relativistic Boris pusher</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;borisnr&quot;</span></code>: The non-relativistic Boris pusher</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;vay&quot;</span></code>: The relativistic pusher of J. L. Vay</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;higueracary&quot;</span></code>: The relativistic pusher of A. V. Higuera and J. R. Cary</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;norm&quot;</span></code>:  For photon species only (rectilinear propagation)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;ponderomotive_boris&quot;</span></code>: modified relativistic Boris pusher for species whose flag <code class="docutils literal notranslate"><span class="pre">&quot;ponderomotive_dynamics&quot;</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>. Valid only if the species has non-zero mass</p></li>
</ul>
</dd></dl>

<dl class="data">
<dt id="radiation_model">
<code class="sig-name descname">radiation_model</code><a class="headerlink" href="#radiation_model" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code></p>
</dd>
</dl>
<p>The <strong>radiation reaction</strong> model used for this species (see <a class="reference internal" href="radiation_loss.html"><span class="doc">Synchrotron-like radiation reaction</span></a>).</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>: no radiation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;Landau-Lifshitz&quot;</span></code> (or <code class="docutils literal notranslate"><span class="pre">ll</span></code>): Landau-Lifshitz model approximated for high energies</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;corrected-Landau-Lifshitz&quot;</span></code> (or <code class="docutils literal notranslate"><span class="pre">cll</span></code>): with quantum correction</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;&quot;Niel&quot;</span></code>: a <a class="reference external" href="https://arxiv.org/abs/1707.02618">stochastic radiation model</a> based on the work of Niel <cite>et al.</cite>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;Monte-Carlo&quot;</span></code> (or <code class="docutils literal notranslate"><span class="pre">mc</span></code>): Monte-Carlo radiation model. This model can be configured to generate macro-photons with <a class="reference internal" href="#radiation_photon_species" title="radiation_photon_species"><code class="xref py py-data docutils literal notranslate"><span class="pre">radiation_photon_species</span></code></a>.</p></li>
</ul>
<p>This parameter cannot be assigned to photons (mass = 0).</p>
<p>Radiation is emitted only with the <code class="docutils literal notranslate"><span class="pre">&quot;Monte-Carlo&quot;</span></code> model when
<a class="reference internal" href="#radiation_photon_species" title="radiation_photon_species"><code class="xref py py-data docutils literal notranslate"><span class="pre">radiation_photon_species</span></code></a> is defined.</p>
</dd></dl>

<dl class="data">
<dt id="radiation_photon_species">
<code class="sig-name descname">radiation_photon_species</code><a class="headerlink" href="#radiation_photon_species" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#name" title="name"><code class="xref py py-data docutils literal notranslate"><span class="pre">name</span></code></a> of the photon species in which the Monte-Carlo <a class="reference internal" href="#radiation_model" title="radiation_model"><code class="xref py py-data docutils literal notranslate"><span class="pre">radiation_model</span></code></a>
will generate macro-photons. If unset (or <code class="docutils literal notranslate"><span class="pre">None</span></code>), no macro-photon will be created.
The <em>target</em> photon species must be have its mass set to 0, and appear <em>after</em> the
particle species in the namelist.</p>
<p>This parameter cannot be assigned to photons (mass = 0).</p>
</dd></dl>

<dl class="data">
<dt id="radiation_photon_sampling">
<code class="sig-name descname">radiation_photon_sampling</code><a class="headerlink" href="#radiation_photon_sampling" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p>
</dd>
</dl>
<p>The number of macro-photons generated per emission event, when the macro-photon creation
is activated (see <a class="reference internal" href="#radiation_photon_species" title="radiation_photon_species"><code class="xref py py-data docutils literal notranslate"><span class="pre">radiation_photon_species</span></code></a>). The total macro-photon weight
is still conserved.</p>
<p>A large number may rapidly slow down the performances and lead to memory saturation.</p>
<p>This parameter cannot be assigned to photons (mass = 0).</p>
</dd></dl>

<dl class="data">
<dt id="radiation_photon_gamma_threshold">
<code class="sig-name descname">radiation_photon_gamma_threshold</code><a class="headerlink" href="#radiation_photon_gamma_threshold" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p>
</dd>
</dl>
<p>The threshold on the photon energy for the macro-photon emission when using the
radiation reaction Monte-Carlo process.
Under this threshold, the macro-photon from the radiation reaction Monte-Carlo
process is not created but still taken into account in the energy balance.
The default value corresponds to twice the electron rest mass energy that
is the required energy to decay into electron-positron pairs.</p>
<p>This parameter cannot be assigned to photons (mass = 0).</p>
</dd></dl>

<dl class="data">
<dt id="relativistic_field_initialization">
<code class="sig-name descname">relativistic_field_initialization</code><a class="headerlink" href="#relativistic_field_initialization" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
<p>Flag for relativistic particles. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the electromagnetic fields of this species will added to the electromagnetic fields already present in the simulation.
This operation will be performed when time equals <a class="reference internal" href="#time_frozen" title="time_frozen"><code class="xref py py-data docutils literal notranslate"><span class="pre">time_frozen</span></code></a>. See <a class="reference internal" href="relativistic_fields_initialization.html"><span class="doc">Field initialization for relativistic species</span></a> for details on the computation of the electromagentic fields of a relativistic species.
To have physically meaningful results, we recommend to place a species which requires this method of field initialization far from other species, otherwise the latter could experience instantly turned-on unphysical forces by the relativistic species’ fields.</p>
</dd></dl>

<dl class="data">
<dt id="multiphoton_Breit_Wheeler">
<code class="sig-name descname">multiphoton_Breit_Wheeler</code><a class="headerlink" href="#multiphoton_Breit_Wheeler" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">[None,None]</span></code></p>
</dd>
</dl>
<p>An list of the <a class="reference internal" href="#name" title="name"><code class="xref py py-data docutils literal notranslate"><span class="pre">name</span></code></a> of two species: electrons and positrons created through
the <a class="reference internal" href="multiphoton_Breit_Wheeler.html"><span class="doc">Multiphoton Breit-Wheeler pair creation</span></a>.
By default, the process is not activated.</p>
<p>This parameter can <strong>only</strong> be assigned to photons species (mass = 0).</p>
</dd></dl>

<dl class="data">
<dt id="multiphoton_Breit_Wheeler_sampling">
<code class="sig-name descname">multiphoton_Breit_Wheeler_sampling</code><a class="headerlink" href="#multiphoton_Breit_Wheeler_sampling" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">[1,1]</span></code></p>
</dd>
</dl>
<p>A list of two integers: the number of electrons and positrons generated per photon decay
in the <a class="reference internal" href="multiphoton_Breit_Wheeler.html"><span class="doc">Multiphoton Breit-Wheeler pair creation</span></a>. The total macro-particle weight is still
conserved.</p>
<p>Large numbers may rapidly slow down the performances and lead to memory saturation.</p>
<p>This parameter can <strong>only</strong> be assigned to photons species (mass = 0).</p>
</dd></dl>

<hr class="docutils" />
</div>
<div class="section" id="particle-injector">
<span id="id4"></span><h2>Particle Injector<a class="headerlink" href="#particle-injector" title="Permalink to this headline">¶</a></h2>
<p>Injectors enable to inject macro-particles in the simulation domain from the boundaries.
By default, some parameters that are not specified are inherited from the associated <code class="xref py py-data docutils literal notranslate"><span class="pre">species</span></code>.</p>
<p>Each particle injector has to be defined in a <code class="docutils literal notranslate"><span class="pre">ParticleInjector</span></code> block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ParticleInjector</span><span class="p">(</span>
    <span class="n">name</span>      <span class="o">=</span> <span class="s2">&quot;injector1&quot;</span><span class="p">,</span>
    <span class="n">species</span>   <span class="o">=</span> <span class="s2">&quot;electrons1&quot;</span><span class="p">,</span>
    <span class="n">box_side</span>  <span class="o">=</span> <span class="s2">&quot;xmin&quot;</span><span class="p">,</span>

    <span class="c1"># Parameters inherited from the associated `species` by default</span>

    <span class="n">position_initialization</span> <span class="o">=</span> <span class="s2">&quot;species&quot;</span><span class="p">,</span>
    <span class="n">momentum_initialization</span> <span class="o">=</span> <span class="s2">&quot;rectangular&quot;</span><span class="p">,</span>
    <span class="n">mean_velocity</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>
    <span class="n">temperature</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e-30</span><span class="p">],</span>
    <span class="n">number_density</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">time_envelope</span> <span class="o">=</span> <span class="n">tgaussian</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
    <span class="n">particles_per_cell</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="data">
<dt>
<code class="sig-name descname">name</code></dt>
<dd><p>The name you want to give to this injector.
If you do not specify a name, it will be attributed automatically.
The name is useful if you want to inject particles at the same position of another injector.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">species</code></dt>
<dd><p>The name of the species in which to inject the new particles</p>
</dd></dl>

<dl class="data">
<dt id="box_side">
<code class="sig-name descname">box_side</code><a class="headerlink" href="#box_side" title="Permalink to this definition">¶</a></dt>
<dd><p>From where the macro-particles are injected. Options are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;xmin&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;xmax&quot;</span></code></p></li>
</ul>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">position_initialization</code></dt>
<dd><p>The method for initialization of particle positions. Options are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;species&quot;</span></code> or empty <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code>: injector uses the option of the specified <code class="xref py py-data docutils literal notranslate"><span class="pre">species</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;regular&quot;</span></code> for regularly spaced</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;random&quot;</span></code> for randomly distributed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;centered&quot;</span></code> for centered in each cell</p></li>
<li><p>The <a class="reference internal" href="#name" title="name"><code class="xref py py-data docutils literal notranslate"><span class="pre">name</span></code></a> of another injector from which the positions are copied.
This option requires (1) that the <em>target</em> injector’ positions are initialized
using one of the three other options above.</p></li>
</ul>
<p>By default, injector uses the parameters provided with <code class="xref py py-data docutils literal notranslate"><span class="pre">species</span></code>.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">momentum_initialization</code></dt>
<dd><p>The method for initialization of particle momenta. Options are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;species&quot;</span></code> or empty <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code>: injector uses the option of the specified <code class="xref py py-data docutils literal notranslate"><span class="pre">species</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;maxwell-juettner&quot;</span></code> for a relativistic maxwellian (see <a class="reference internal" href="maxwell-juttner.html"><span class="doc">how it is done</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;rectangular&quot;</span></code> for a rectangular distribution</p></li>
</ul>
<p>By default, injector uses the parameters provided with <code class="xref py py-data docutils literal notranslate"><span class="pre">species</span></code>.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">mean_velocity</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>a list of 3 floats or <em>python</em> functions (see section <a class="reference internal" href="#profiles"><span class="std std-ref">Profiles</span></a>)</p>
</dd>
</dl>
<p>The initial drift velocity of the particles, in units of the speed of light <span class="math notranslate nohighlight">\(c\)</span>.
By default (nothing specified), injector uses the parameters provided with <code class="xref py py-data docutils literal notranslate"><span class="pre">species</span></code>.</p>
<p><strong>WARNING</strong>: For massless particles, this is actually the momentum in units of <span class="math notranslate nohighlight">\(m_e c\)</span>.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">temperature</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>a list of 3 floats or <em>python</em> functions (see section <a class="reference internal" href="#profiles"><span class="std std-ref">Profiles</span></a>)</p>
</dd>
</dl>
<p>The initial temperature of the particles, in units of <span class="math notranslate nohighlight">\(m_ec^2\)</span>.
By default (nothing specified), injector uses the parameters provided with <code class="xref py py-data docutils literal notranslate"><span class="pre">species</span></code>.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">particles_per_cell</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float or <em>python</em> function (see section <a class="reference internal" href="#profiles"><span class="std std-ref">Profiles</span></a>)</p>
</dd>
</dl>
<p>The number of particles per cell to use for the injector.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">number_density</code></dt>
<dt>
<code class="sig-name descname">charge_density</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float or <em>python</em> function (see section <a class="reference internal" href="#profiles"><span class="std std-ref">Profiles</span></a>)</p>
</dd>
</dl>
<p>The absolute value of the number density or charge density (choose one only)
of the particle distribution, in units of the reference density <span class="math notranslate nohighlight">\(N_r\)</span> (see <a class="reference internal" href="units.html"><span class="doc">Units</span></a>)</p>
</dd></dl>

<dl class="data">
<dt id="time_envelope">
<code class="sig-name descname">time_envelope</code><a class="headerlink" href="#time_envelope" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>a <em>python</em> function or a <a class="reference internal" href="#profiles"><span class="std std-ref">time profile</span></a></p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">tconstant()</span></code></p>
</dd>
</dl>
<p>The temporal envelope of the injector.</p>
</dd></dl>

<hr class="docutils" />
</div>
<div class="experimental section" id="particle-merging">
<span id="id5"></span><h2>Particle Merging<a class="headerlink" href="#particle-merging" title="Permalink to this headline">¶</a></h2>
<p>The macro-particle merging method is documented in
the <a class="reference internal" href="particle_merging.html"><span class="doc">corresponding page</span></a>.
It is optionnally specified in the <code class="docutils literal notranslate"><span class="pre">Species</span></code> block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Species</span><span class="p">(</span>
    <span class="o">....</span>

    <span class="c1"># Merging</span>
    <span class="n">merging_method</span> <span class="o">=</span> <span class="s2">&quot;vranic_spherical&quot;</span><span class="p">,</span>
    <span class="n">merge_every</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">merge_min_particles_per_cell</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
    <span class="n">merge_max_packet_size</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">merge_min_packet_size</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">merge_momentum_cell_size</span> <span class="o">=</span> <span class="p">[</span><span class="mi">32</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">],</span>
    <span class="n">merge_discretization_scale</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span>
    <span class="c1"># Extra parameters for experts:</span>
    <span class="n">merge_min_momentum_cell_length</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e-10</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">],</span>
    <span class="n">merge_accumulation_correction</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="data">
<dt id="merging_method">
<code class="sig-name descname">merging_method</code><a class="headerlink" href="#merging_method" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code></p>
</dd>
</dl>
<p>The particle merging method to use:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>: no merging</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;vranic_cartesian&quot;</span></code>: method of M. Vranic with a cartesian momentum-space decomposition</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;vranic_spherical&quot;</span></code>: method of M. Vranic with a spherical momentum-space decomposition</p></li>
</ul>
</dd></dl>

<dl class="data">
<dt id="merge_every">
<code class="sig-name descname">merge_every</code><a class="headerlink" href="#merge_every" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p>Number of timesteps between each merging event
<strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
</dd></dl>

<dl class="data">
<dt id="min_particles_per_cell">
<code class="sig-name descname">min_particles_per_cell</code><a class="headerlink" href="#min_particles_per_cell" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">4</span></code></p>
</dd>
</dl>
<p>The minimum number of particles per cell for the merging.</p>
</dd></dl>

<dl class="data">
<dt id="merge_min_packet_size">
<code class="sig-name descname">merge_min_packet_size</code><a class="headerlink" href="#merge_min_packet_size" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">4</span></code></p>
</dd>
</dl>
<p>The minimum number of particles per packet to merge.</p>
</dd></dl>

<dl class="data">
<dt id="merge_max_packet_size">
<code class="sig-name descname">merge_max_packet_size</code><a class="headerlink" href="#merge_max_packet_size" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">4</span></code></p>
</dd>
</dl>
<p>The maximum number of particles per packet to merge.</p>
</dd></dl>

<dl class="data">
<dt id="merge_momentum_cell_size">
<code class="sig-name descname">merge_momentum_cell_size</code><a class="headerlink" href="#merge_momentum_cell_size" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">[16,16,16]</span></code></p>
</dd>
</dl>
<p>A list of 3 integers defining the number of sub-groups in each direction
for the momentum-space discretization.</p>
</dd></dl>

<dl class="data">
<dt id="merge_discretization_scale">
<code class="sig-name descname">merge_discretization_scale</code><a class="headerlink" href="#merge_discretization_scale" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;linear&quot;</span></code></p>
</dd>
</dl>
<p>The momentum discretization scale:: <code class="docutils literal notranslate"><span class="pre">&quot;linear&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;log&quot;</span></code>.
The <code class="docutils literal notranslate"><span class="pre">&quot;log&quot;</span></code> scale only works with the spherical discretization at the moment.</p>
</dd></dl>

<dl class="data">
<dt id="merge_min_momentum">
<code class="sig-name descname">merge_min_momentum</code><a class="headerlink" href="#merge_min_momentum" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">1e-5</span></code></p>
</dd>
</dl>
<p><span class="red">[for experts]</span> The minimum momentum value when the log scale
is chosen (<code class="docutils literal notranslate"><span class="pre">merge_discretization_scale</span> <span class="pre">=</span> <span class="pre">log</span></code>).
This avoids a potential 0 value in the log domain.</p>
</dd></dl>

<dl class="data">
<dt id="merge_min_momentum_cell_length">
<code class="sig-name descname">merge_min_momentum_cell_length</code><a class="headerlink" href="#merge_min_momentum_cell_length" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">[1e-10,1e-10,1e-10]</span></code></p>
</dd>
</dl>
<p><span class="red">[for experts]</span> The minimum sub-group length for the momentum-space
discretization (below which the number of sub-groups is set to 1).</p>
</dd></dl>

<dl class="data">
<dt id="merge_accumulation_correction">
<code class="sig-name descname">merge_accumulation_correction</code><a class="headerlink" href="#merge_accumulation_correction" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</dd>
</dl>
<p><span class="red">[for experts]</span> Activates the accumulation correction
(see <a class="reference internal" href="particle_merging.html#vranic-accumulation-effect"><span class="std std-ref">4. Accumulation effect</span></a> for more information).
The correction only works in linear scale.</p>
</dd></dl>

<hr class="docutils" />
</div>
<div class="section" id="lasers">
<span id="id6"></span><h2>Lasers<a class="headerlink" href="#lasers" title="Permalink to this headline">¶</a></h2>
<p>A laser consists in applying oscillating boundary conditions for the magnetic
field on one of the box sides. The only boundary condition that supports lasers
is <code class="docutils literal notranslate"><span class="pre">&quot;silver-muller&quot;</span></code> (see <a class="reference internal" href="#EM_boundary_conditions" title="EM_boundary_conditions"><code class="xref py py-data docutils literal notranslate"><span class="pre">EM_boundary_conditions</span></code></a>).
There are several syntaxes to introduce a laser in <strong class="program">Smilei</strong>:</p>
<p class="rubric">1. Defining a generic wave</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Laser</span><span class="p">(</span>
    <span class="n">box_side</span> <span class="o">=</span> <span class="s2">&quot;xmin&quot;</span><span class="p">,</span>
    <span class="n">space_time_profile</span> <span class="o">=</span> <span class="p">[</span> <span class="n">By_profile</span><span class="p">,</span> <span class="n">Bz_profile</span> <span class="p">]</span>
    <span class="n">space_time_profile_AM</span> <span class="o">=</span> <span class="p">[</span> <span class="n">Br_mode0</span><span class="p">,</span> <span class="n">Bt_mode0</span><span class="p">,</span> <span class="n">Br_mode1</span><span class="p">,</span> <span class="n">Bt_mode1</span><span class="p">,</span> <span class="o">...</span> <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<dl class="data">
<dt>
<code class="sig-name descname">box_side</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;xmin&quot;</span></code></p>
</dd>
</dl>
<p>Side of the box from which the laser originates: at the moment, only <code class="docutils literal notranslate"><span class="pre">&quot;xmin&quot;</span></code> and
<code class="docutils literal notranslate"><span class="pre">&quot;xmax&quot;</span></code> are supported.</p>
</dd></dl>

<dl class="data">
<dt id="space_time_profile">
<code class="sig-name descname">space_time_profile</code><a class="headerlink" href="#space_time_profile" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>A list of two <em>python</em> functions</p>
</dd>
</dl>
<p>The full wave expression at the chosen box side. It is a list of <strong>two</strong> <em>python</em>
functions taking several arguments depending on the simulation dimension:
<span class="math notranslate nohighlight">\((t)\)</span> for a 1-D simulation, <span class="math notranslate nohighlight">\((y,t)\)</span> for a 2-D simulation (etc.)
The two functions represent <span class="math notranslate nohighlight">\(B_y\)</span> and <span class="math notranslate nohighlight">\(B_z\)</span>, respectively.
This can be used only in <cite>Cartesian</cite> geometries.</p>
</dd></dl>

<dl class="data">
<dt id="space_time_profile_AM">
<code class="sig-name descname">space_time_profile_AM</code><a class="headerlink" href="#space_time_profile_AM" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>A list of maximum 2*`number_of_AM` <em>python</em> functions.</p>
</dd>
</dl>
<p>These profiles define the first modes of <cite>Br</cite> and <cite>Bt</cite> in the order shown in the above example.
Undefined modes are considered zero.
This can be used only in <cite>AMcylindrical</cite> geometry.</p>
</dd></dl>

<p class="rubric">2. Defining the wave envelopes</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Laser</span><span class="p">(</span>
    <span class="n">box_side</span>       <span class="o">=</span> <span class="s2">&quot;xmin&quot;</span><span class="p">,</span>
    <span class="n">omega</span>          <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">chirp_profile</span>  <span class="o">=</span> <span class="n">tconstant</span><span class="p">(),</span>
    <span class="n">time_envelope</span>  <span class="o">=</span> <span class="n">tgaussian</span><span class="p">(),</span>
    <span class="n">space_envelope</span> <span class="o">=</span> <span class="p">[</span> <span class="n">By_profile</span>  <span class="p">,</span> <span class="n">Bz_profile</span>   <span class="p">],</span>
    <span class="n">phase</span>          <span class="o">=</span> <span class="p">[</span> <span class="n">PhiY_profile</span><span class="p">,</span> <span class="n">PhiZ_profile</span> <span class="p">],</span>
    <span class="n">delay_phase</span>    <span class="o">=</span> <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span> <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This implements a wave of the form:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}B_y(\mathbf{x}, t) = S_y(\mathbf{x})\; T\left(t-t_{0y}\right)
\;\sin\left( \omega(t) t - \phi_y(\mathbf{x}) \right)\\B_z(\mathbf{x}, t) = S_z(\mathbf{x})\; T\left(t-t_{0z}\right)
\;\sin\left( \omega(t) t - \phi_z(\mathbf{x}) \right)\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(T\)</span> is the temporal envelope, <span class="math notranslate nohighlight">\(S_y\)</span> and <span class="math notranslate nohighlight">\(S_z\)</span> are the
spatial envelopes, <span class="math notranslate nohighlight">\(\omega\)</span> is the time-varying frequency,
<span class="math notranslate nohighlight">\(\phi_y\)</span> and <span class="math notranslate nohighlight">\(\phi_z\)</span> are the phases, and we defined the delays
<span class="math notranslate nohighlight">\(t_{0y} = (\phi_y(\mathbf{x})-\varphi_y)/\omega(t)\)</span> and
<span class="math notranslate nohighlight">\(t_{0z} = (\phi_z(\mathbf{x})-\varphi_z)/\omega(t)\)</span>.</p>
<dl class="data">
<dt id="omega">
<code class="sig-name descname">omega</code><a class="headerlink" href="#omega" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><ol class="arabic simple">
<li></li>
</ol>
</dd>
</dl>
<p>The laser angular frequency.</p>
</dd></dl>

<dl class="data">
<dt id="chirp_profile">
<code class="sig-name descname">chirp_profile</code><a class="headerlink" href="#chirp_profile" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>a <em>python</em> function or a <a class="reference internal" href="#profiles"><span class="std std-ref">time profile</span></a></p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">tconstant()</span></code></p>
</dd>
</dl>
<p>The variation of the laser frequency over time, such that
<span class="math notranslate nohighlight">\(\omega(t)=\mathtt{omega}\times\mathtt{chirp\_profile}(t)\)</span>.</p>
</dd></dl>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This definition of the chirp profile is not standard.
Indeed, <span class="math notranslate nohighlight">\(\omega(t)\)</span> as defined here <strong>is not</strong> the instantaneous frequency, <span class="math notranslate nohighlight">\(\omega_{\rm inst}(t)\)</span>,
which is obtained from the time derivative of the phase <span class="math notranslate nohighlight">\(\omega(t) t\)</span>.</p>
<p>Should one define the chirp as <span class="math notranslate nohighlight">\(C(t) = \omega_{\rm inst}(t)/\omega\)</span> (with <span class="math notranslate nohighlight">\(\omega\)</span> defined by the input
parameter <span class="math notranslate nohighlight">\(\mathtt{omega}\)</span>), the user can easily obtain the corresponding chirp profile as defined in
<strong class="program">Smilei</strong> as:</p>
<div class="math notranslate nohighlight">
\[\mathtt{chirp\_profile}(t) = \frac{1}{t} \int_0^t dt' C(t')\,.\]</div>
<p>Let us give as an example the case of a <em>linear chirp</em>, with the instantaneous frequency
<span class="math notranslate nohighlight">\(\omega_{\rm inst}(t) = \omega [1+\alpha\,\omega(t-t_0)]\)</span>.
<span class="math notranslate nohighlight">\(C(t) = 1+\alpha\,\omega(t-t_0)\)</span>. The corresponding input chirp profile reads:</p>
<div class="math notranslate nohighlight">
\[\mathtt{chirp\_profile}(t) = 1 - \alpha\, \omega t_0 + \frac{\alpha}{2} \omega t\]</div>
<p>Similarly, for a <em>geometric (exponential) chirp</em> such that <span class="math notranslate nohighlight">\(\omega_{\rm inst}(t) = \omega\, \alpha^{\omega t}\)</span>,
<span class="math notranslate nohighlight">\(C(t) = \alpha^{\omega t}\)</span>, and the corresponding input chirp profile reads:</p>
<div class="math notranslate nohighlight">
\[\mathtt{chirp\_profile}(t) = \frac{\alpha^{\omega t} - 1}{\omega t \, \ln \alpha}\,.\]</div>
</div>
<dl class="data">
<dt>
<code class="sig-name descname">time_envelope</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>a <em>python</em> function or a <a class="reference internal" href="#profiles"><span class="std std-ref">time profile</span></a></p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">tconstant()</span></code></p>
</dd>
</dl>
<p>The temporal envelope of the laser.</p>
</dd></dl>

<dl class="data">
<dt id="space_envelope">
<code class="sig-name descname">space_envelope</code><a class="headerlink" href="#space_envelope" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>a list of two <em>python</em> functions or two <a class="reference internal" href="#profiles"><span class="std std-ref">spatial profiles</span></a></p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">1.,</span> <span class="pre">0.</span> <span class="pre">]</span></code></p>
</dd>
</dl>
<p>The two spatial envelopes <span class="math notranslate nohighlight">\(S_y\)</span> and <span class="math notranslate nohighlight">\(S_z\)</span>.</p>
</dd></dl>

<dl class="data">
<dt id="phase">
<code class="sig-name descname">phase</code><a class="headerlink" href="#phase" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>a list of two <em>python</em> functions or two <a class="reference internal" href="#profiles"><span class="std std-ref">spatial profiles</span></a></p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">0.,</span> <span class="pre">0.</span> <span class="pre">]</span></code></p>
</dd>
</dl>
<p>The two spatially-varying phases <span class="math notranslate nohighlight">\(\phi_y\)</span> and <span class="math notranslate nohighlight">\(\phi_z\)</span>.</p>
</dd></dl>

<dl class="data">
<dt id="delay_phase">
<code class="sig-name descname">delay_phase</code><a class="headerlink" href="#delay_phase" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>a list of two floats</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">0.,</span> <span class="pre">0.</span> <span class="pre">]</span></code></p>
</dd>
</dl>
<p>An extra phase for the time envelopes of <span class="math notranslate nohighlight">\(B_y\)</span> and <span class="math notranslate nohighlight">\(B_z\)</span>. Useful in the
case of elliptical polarization where the two temporal profiles might have a slight
delay due to the mismatched <a class="reference internal" href="#phase" title="phase"><code class="xref py py-data docutils literal notranslate"><span class="pre">phase</span></code></a>.</p>
</dd></dl>

</div></blockquote>
<p class="rubric">3. Defining a 1D planar wave</p>
<blockquote>
<div><p>For one-dimensional simulations, you may use the simplified laser creator:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LaserPlanar1D</span><span class="p">(</span>
    <span class="n">box_side</span>         <span class="o">=</span> <span class="s2">&quot;xmin&quot;</span><span class="p">,</span>
    <span class="n">a0</span>               <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">omega</span>            <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">polarization_phi</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">ellipticity</span>      <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">time_envelope</span>    <span class="o">=</span> <span class="n">tconstant</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="data">
<dt id="a0">
<code class="sig-name descname">a0</code><a class="headerlink" href="#a0" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><ol class="arabic simple">
<li></li>
</ol>
</dd>
</dl>
<p>The normalized vector potential</p>
</dd></dl>

<dl class="data">
<dt id="polarization_phi">
<code class="sig-name descname">polarization_phi</code><a class="headerlink" href="#polarization_phi" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><ol class="arabic simple" start="0">
<li></li>
</ol>
</dd>
</dl>
<p>The angle of the polarization ellipse major axis relative to the X-Y plane, in radians.</p>
</dd></dl>

<dl class="data">
<dt id="ellipticity">
<code class="sig-name descname">ellipticity</code><a class="headerlink" href="#ellipticity" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><ol class="arabic simple" start="0">
<li></li>
</ol>
</dd>
</dl>
<p>The polarization ellipticity: 0 for linear and <span class="math notranslate nohighlight">\(\pm 1\)</span> for circular.</p>
</dd></dl>

</div></blockquote>
<p class="rubric">4. Defining a 2D gaussian wave</p>
<blockquote>
<div><p>For two-dimensional simulations, you may use the simplified laser creator:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LaserGaussian2D</span><span class="p">(</span>
    <span class="n">box_side</span>         <span class="o">=</span> <span class="s2">&quot;xmin&quot;</span><span class="p">,</span>
    <span class="n">a0</span>               <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">omega</span>            <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">focus</span>            <span class="o">=</span> <span class="p">[</span><span class="mf">50.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">],</span>
    <span class="n">waist</span>            <span class="o">=</span> <span class="mf">3.</span><span class="p">,</span>
    <span class="n">incidence_angle</span>  <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">polarization_phi</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">ellipticity</span>      <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">time_envelope</span>    <span class="o">=</span> <span class="n">tconstant</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="data">
<dt id="focus">
<code class="sig-name descname">focus</code><a class="headerlink" href="#focus" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>A list of two floats <code class="docutils literal notranslate"><span class="pre">[X,</span> <span class="pre">Y]</span></code></p>
</dd>
</dl>
<p>The <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">Y</span></code> positions of the laser focus.</p>
</dd></dl>

<dl class="data">
<dt id="waist">
<code class="sig-name descname">waist</code><a class="headerlink" href="#waist" title="Permalink to this definition">¶</a></dt>
<dd><p>The waist value. Transverse coordinate at which the field is at 1/e of its maximum value.</p>
</dd></dl>

<dl class="data">
<dt id="incidence_angle">
<code class="sig-name descname">incidence_angle</code><a class="headerlink" href="#incidence_angle" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><ol class="arabic simple" start="0">
<li></li>
</ol>
</dd>
</dl>
<p>The angle of the laser beam relative to the X axis, in radians.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">time_envelope</code></dt>
<dd><p>Time envelope of the field (not intensity).</p>
</dd></dl>

</div></blockquote>
<p class="rubric">5. Defining a 3D gaussian wave</p>
<blockquote>
<div><p>For three-dimensional simulations, you may use the simplified laser creator:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LaserGaussian3D</span><span class="p">(</span>
    <span class="n">box_side</span>         <span class="o">=</span> <span class="s2">&quot;xmin&quot;</span><span class="p">,</span>
    <span class="n">a0</span>               <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">omega</span>            <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">focus</span>            <span class="o">=</span> <span class="p">[</span><span class="mf">50.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">],</span>
    <span class="n">waist</span>            <span class="o">=</span> <span class="mf">3.</span><span class="p">,</span>
    <span class="n">incidence_angle</span>  <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
    <span class="n">polarization_phi</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">ellipticity</span>      <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">time_envelope</span>    <span class="o">=</span> <span class="n">tconstant</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This is almost the same as <code class="docutils literal notranslate"><span class="pre">LaserGaussian2D</span></code>, with the <code class="docutils literal notranslate"><span class="pre">focus</span></code> parameter having
now 3 elements (focus position in 3D), and the <code class="docutils literal notranslate"><span class="pre">incidence_angle</span></code> being a list of
two angles, corresponding to rotations around <cite>y</cite> and <cite>z</cite>, respectively.</p>
</div></blockquote>
<p class="rubric">6. Defining a gaussian wave with Azimuthal Fourier decomposition</p>
<blockquote>
<div><p>For simulations with <code class="docutils literal notranslate"><span class="pre">&quot;AMcylindrical&quot;</span></code> geometry, you may use the simplified laser creator:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LaserGaussianAM</span><span class="p">(</span>
    <span class="n">box_side</span>         <span class="o">=</span> <span class="s2">&quot;xmin&quot;</span><span class="p">,</span>
    <span class="n">a0</span>               <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">omega</span>            <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">focus</span>            <span class="o">=</span> <span class="p">[</span><span class="mf">50.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
    <span class="n">waist</span>            <span class="o">=</span> <span class="mf">3.</span><span class="p">,</span>
    <span class="n">polarization_phi</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">ellipticity</span>      <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">time_envelope</span>    <span class="o">=</span> <span class="n">tconstant</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Note that here, the focus is given in [x,r] coordinates.</p>
</div></blockquote>
<p class="rubric">7. Defining a generic wave at some distance from the boundary</p>
<blockquote>
<div><p>In some cases, the laser field is not known at the box boundary, but rather at some
plane inside the box. Smilei can pre-calculate the corresponding wave at the boundary
using the <em>angular spectrum method</em>. This technique is only available in 2D and 3D
cartesian geometries and requires the python packages <em>numpy</em>.
A <a class="reference internal" href="laser_offset.html"><span class="doc">detailed explanation</span></a> of the method is available.
The laser is introduced using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LaserOffset</span><span class="p">(</span>
    <span class="n">box_side</span>               <span class="o">=</span> <span class="s2">&quot;xmin&quot;</span><span class="p">,</span>
    <span class="n">space_time_profile</span>     <span class="o">=</span> <span class="p">[</span> <span class="n">By_profile</span><span class="p">,</span> <span class="n">Bz_profile</span> <span class="p">],</span>
    <span class="n">offset</span>                 <span class="o">=</span> <span class="mf">10.</span><span class="p">,</span>
    <span class="n">extra_envelope</span>          <span class="o">=</span> <span class="n">tconstant</span><span class="p">(),</span>
    <span class="n">keep_n_strongest_modes</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
    <span class="n">angle</span> <span class="o">=</span> <span class="mf">10.</span><span class="o">/</span><span class="mf">180.</span><span class="o">*</span><span class="mf">3.14159</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="data">
<dt>
<code class="sig-name descname">space_time_profile</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>A list of two <em>python</em> functions</p>
</dd>
</dl>
<p>The magnetic field profiles at some arbitrary plane, as a function of space and time.
The arguments of these profiles are <code class="docutils literal notranslate"><span class="pre">(y,t)</span></code> in 2D and <code class="docutils literal notranslate"><span class="pre">(y,z,t)</span></code> in 3D.</p>
</dd></dl>

<dl class="data">
<dt id="offset">
<code class="sig-name descname">offset</code><a class="headerlink" href="#offset" title="Permalink to this definition">¶</a></dt>
<dd><p>The distance from the box boundary to the plane where <a class="reference internal" href="#space_time_profile" title="space_time_profile"><code class="xref py py-data docutils literal notranslate"><span class="pre">space_time_profile</span></code></a>
is defined.</p>
</dd></dl>

<dl class="data">
<dt id="extra_envelope">
<code class="sig-name descname">extra_envelope</code><a class="headerlink" href="#extra_envelope" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>a <em>python</em> function or a <a class="reference internal" href="#profiles"><span class="std std-ref">python profile</span></a></p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">*z:</span> <span class="pre">1.</span></code>, which means a profile of value 1 everywhere</p>
</dd>
</dl>
<p>An extra envelope applied at the boundary, on top of the <a class="reference internal" href="#space_time_profile" title="space_time_profile"><code class="xref py py-data docutils literal notranslate"><span class="pre">space_time_profile</span></code></a>.
This envelope takes two arguments (<cite>y</cite>, <cite>t</cite>) in 2D, and three arguments (<cite>y</cite>, <cite>z</cite>, <cite>t</cite>)
in 3D.
As the wave propagation technique stores a limited number of Fourier modes (in the time
domain) of the wave, some periodicity can be obtained in the actual laser.
One may thus observe that the laser pulse is repeated several times.
The envelope can be used to remove these spurious repetitions.</p>
</dd></dl>

<dl class="data">
<dt id="keep_n_strongest_modes">
<code class="sig-name descname">keep_n_strongest_modes</code><a class="headerlink" href="#keep_n_strongest_modes" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>100</p>
</dd>
</dl>
<p>The number of temporal Fourier modes that are kept during the pre-processing.
See <a class="reference internal" href="laser_offset.html"><span class="doc">this page</span></a> for more details.</p>
</dd></dl>

<dl class="data">
<dt id="angle">
<code class="sig-name descname">angle</code><a class="headerlink" href="#angle" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><ol class="arabic simple" start="0">
<li></li>
</ol>
</dd>
</dl>
<p>Angle between the boundary and the profile’s plane, the rotation being around <span class="math notranslate nohighlight">\(z\)</span>.
See <a class="reference internal" href="laser_offset.html"><span class="doc">this page</span></a> for more details.</p>
</dd></dl>

</div></blockquote>
<hr class="docutils" />
</div>
<div class="section" id="laser-envelope-model">
<span id="laser-envelope"></span><h2>Laser envelope model<a class="headerlink" href="#laser-envelope-model" title="Permalink to this headline">¶</a></h2>
<p>In all the available geometries, it is possible to model a laser pulse propagating in the <code class="docutils literal notranslate"><span class="pre">x</span></code> direction
using an envelope model (see <a class="reference internal" href="laser_envelope.html"><span class="doc">Laser envelope model</span></a> for the advantages
and limits of this approximation).
The fast oscillations of the laser are neglected and all the physical
quantities of the simulation, including the electromagnetic fields and
their source terms, as well as the particles positions and momenta, are
meant as an average over one or more optical cycles.
Effects involving characteristic lengths comparable to the laser central
wavelength (i.e. sharp plasma density profiles) cannot be modeled with
this option.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The envelope model in <code class="docutils literal notranslate"><span class="pre">&quot;AMcylindrical&quot;</span></code> geometry is implemented only in the hypothesis of
cylindrical symmetry, i.e. only one azimuthal mode. Therefore, to use it the user must choose
<code class="docutils literal notranslate"><span class="pre">number_of_AM</span> <span class="pre">=</span> <span class="pre">1</span></code>.</p>
</div>
<p>Contrarily to a standard Laser initialized with the Silver-Müller
boundary conditions, the laser envelope will be entirely initialized inside
the simulation box at the start of the simulation.</p>
<p>Currently only one laser pulse of a given frequency propagating in the positive
<cite>x</cite> direction can be speficified. However, a multi-pulse set-up can be initialized
if a multi-pulse profile is specified, e.g. if the temporal profile is given by two adjacents gaussian functions.
The whole multi-pulse profile would have the same carrier frequency and would propagate in the positive
<cite>x</cite> direction. For the moment it is not possible to specify more than one laser envelope profile, e.g.
two counterpropagating lasers, or two lasers with different carrier frequency.</p>
<p>Please note that describing a laser through its complex envelope loses physical accuracy if its
characteristic space-time variation scales are too small, i.e. of the order of the laser central wavelength (see <a class="reference internal" href="laser_envelope.html"><span class="doc">Laser envelope model</span></a>).
Thus, space-time profiles with variation scales larger than this length should be used.</p>
<p class="rubric">1. Defining a generic laser envelope</p>
<p>Following is the generic laser envelope creator</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LaserEnvelope</span><span class="p">(</span>
    <span class="n">omega</span>          <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">envelope_solver</span> <span class="o">=</span> <span class="s1">&#39;explicit&#39;</span><span class="p">,</span>
    <span class="n">envelope_profile</span> <span class="o">=</span> <span class="n">envelope_profile</span><span class="p">,</span>
    <span class="n">Envelope_boundary_conditions</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;reflective&quot;</span><span class="p">]]</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="data">
<dt>
<code class="sig-name descname">omega</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">1.</span></code></p>
</dd>
</dl>
<p>For the moment only a value of 1 is supported.</p>
</dd></dl>

<dl class="data">
<dt id="envelope_profile">
<code class="sig-name descname">envelope_profile</code><a class="headerlink" href="#envelope_profile" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>a <em>python</em> function or a <a class="reference internal" href="#profiles"><span class="std std-ref">python profile</span></a></p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p>The laser space-time profile, so if the geometry is <code class="docutils literal notranslate"><span class="pre">3Dcartesian</span></code> a function of 4 arguments (3 for space, 1 for time) is necessary.
Please note that the envelope will be entirely initialized in the simulation box
already at the start of the simulation, so the time coordinate will be applied
to the <code class="docutils literal notranslate"><span class="pre">x</span></code> direction instead of time. It is recommended to initialize the
laser envelope in vacuum, separated from the plasma, to avoid unphysical
results.
Envelopes with variation scales near to the laser wavelength do not
satisfy the assumptions of the envelope model (see <a class="reference internal" href="laser_envelope.html"><span class="doc">Laser envelope model</span></a>),
yielding inaccurate results.</p>
</dd></dl>

<dl class="data">
<dt id="envelope_solver">
<code class="sig-name descname">envelope_solver</code><a class="headerlink" href="#envelope_solver" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">explicit</span></code></p>
</dd>
</dl>
<p>For the moment the only available solver for the laser envelope equation is an
explicit solver with centered finite differences in space and time.</p>
</dd></dl>

<dl class="data">
<dt id="Envelope_boundary_conditions">
<code class="sig-name descname">Envelope_boundary_conditions</code><a class="headerlink" href="#Envelope_boundary_conditions" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of lists of strings</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">[[&quot;reflective&quot;]]</span></code></p>
</dd>
</dl>
<p>For the moment, only reflective boundary conditions are implemented in the
resolution of the envelope equation.</p>
</dd></dl>

<p class="rubric">2. Defining a 1D laser envelope</p>
<p>Following is the simplified laser envelope creator in 1D</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LaserEnvelopePlanar1D</span><span class="p">(</span>
    <span class="n">a0</span>              <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">time_envelope</span>   <span class="o">=</span> <span class="n">tgaussian</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="mf">150.</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mf">40.</span><span class="p">),</span>
    <span class="n">envelope_solver</span> <span class="o">=</span> <span class="s1">&#39;explicit&#39;</span><span class="p">,</span>
    <span class="n">Envelope_boundary_conditions</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="s2">&quot;reflective&quot;</span><span class="p">]</span> <span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
<p class="rubric">3. Defining a 2D gaussian laser envelope</p>
<p>Following is the simplified gaussian laser envelope creator in 2D</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LaserEnvelopeGaussian2D</span><span class="p">(</span>
    <span class="n">a0</span>              <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">focus</span>           <span class="o">=</span> <span class="p">[</span><span class="mf">150.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">],</span>
    <span class="n">waist</span>           <span class="o">=</span> <span class="mf">30.</span><span class="p">,</span>
    <span class="n">time_envelope</span>   <span class="o">=</span> <span class="n">tgaussian</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="mf">150.</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mf">40.</span><span class="p">),</span>
    <span class="n">envelope_solver</span> <span class="o">=</span> <span class="s1">&#39;explicit&#39;</span><span class="p">,</span>
    <span class="n">Envelope_boundary_conditions</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="s2">&quot;reflective&quot;</span><span class="p">]</span> <span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
<p class="rubric">4. Defining a 3D gaussian laser envelope</p>
<p>Following is the simplified laser envelope creator in 3D</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LaserEnvelopeGaussian3D</span><span class="p">(</span>
    <span class="n">a0</span>              <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">focus</span>           <span class="o">=</span> <span class="p">[</span><span class="mf">150.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">],</span>
    <span class="n">waist</span>           <span class="o">=</span> <span class="mf">30.</span><span class="p">,</span>
    <span class="n">time_envelope</span>   <span class="o">=</span> <span class="n">tgaussian</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="mf">150.</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mf">40.</span><span class="p">),</span>
    <span class="n">envelope_solver</span> <span class="o">=</span> <span class="s1">&#39;explicit&#39;</span><span class="p">,</span>
    <span class="n">Envelope_boundary_conditions</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="s2">&quot;reflective&quot;</span><span class="p">]</span> <span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
<p class="rubric">5. Defining a cylindrical gaussian laser envelope</p>
<p>Following is the simplified laser envelope creator in <code class="docutils literal notranslate"><span class="pre">&quot;AMcylindrical&quot;</span></code> geometry (remember that
in this geometry the envelope model can be used only if <code class="docutils literal notranslate"><span class="pre">number_of_AM</span> <span class="pre">=</span> <span class="pre">1</span></code>)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LaserEnvelopeGaussianAM</span><span class="p">(</span>
    <span class="n">a0</span>              <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">focus</span>           <span class="o">=</span> <span class="p">[</span><span class="mf">150.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">],</span>
    <span class="n">waist</span>           <span class="o">=</span> <span class="mf">30.</span><span class="p">,</span>
    <span class="n">time_envelope</span>   <span class="o">=</span> <span class="n">tgaussian</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="mf">150.</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mf">40.</span><span class="p">),</span>
    <span class="n">envelope_solver</span> <span class="o">=</span> <span class="s1">&#39;explicit&#39;</span><span class="p">,</span>
    <span class="n">Envelope_boundary_conditions</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="s2">&quot;reflective&quot;</span><span class="p">]</span> <span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The arguments appearing <code class="docutils literal notranslate"><span class="pre">LaserEnvelopePlanar1D</span></code>, <code class="docutils literal notranslate"><span class="pre">LaserEnvelopeGaussian2D</span></code>,
<code class="docutils literal notranslate"><span class="pre">LaserEnvelopeGaussian3D</span></code> and <code class="docutils literal notranslate"><span class="pre">LaserEnvelopeGaussianAM</span></code> have the same meaning they would have in a
normal <code class="docutils literal notranslate"><span class="pre">LaserPlanar1D</span></code>, <code class="docutils literal notranslate"><span class="pre">LaserGaussian2D</span></code>, <code class="docutils literal notranslate"><span class="pre">LaserGaussian3D</span></code> and <code class="docutils literal notranslate"><span class="pre">LaserGaussianAM</span></code>,
with some differences:</p>
<dl class="data">
<dt>
<code class="sig-name descname">time_envelope</code></dt>
<dd><p>Since the envelope will be entirely initialized in the simulation box
already at the start of the simulation, the time envelope will be applied
in the <code class="docutils literal notranslate"><span class="pre">x</span></code> direction instead of time. It is recommended to initialize the
laser envelope in vacuum, separated from the plasma, to avoid unphysical
results.
Temporal envelopes with variation scales near to the laser wavelength do not
satisfy the assumptions of the envelope model (see <a class="reference internal" href="laser_envelope.html"><span class="doc">Laser envelope model</span></a>),
yielding inaccurate results.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">waist</code></dt>
<dd><p>Please note that a waist size comparable to the laser wavelength does not
satisfy the assumptions of the envelope model.</p>
</dd></dl>

<p>It is important to remember that the profile defined through the blocks
<code class="docutils literal notranslate"><span class="pre">LaserEnvelopePlanar1D</span></code>, <code class="docutils literal notranslate"><span class="pre">LaserEnvelopeGaussian2D</span></code>, <code class="docutils literal notranslate"><span class="pre">LaserEnvelopeGaussian3D</span></code>
correspond to the complex envelope of the laser vector potential component
<span class="math notranslate nohighlight">\(\tilde{A}\)</span> in the polarization direction.
The calculation of the correspondent complex envelope for the laser electric field
component in that direction is described in <a class="reference internal" href="laser_envelope.html"><span class="doc">Laser envelope model</span></a>.
Note that only order 2 interpolation and projection are supported in presence of
the envelope model for the laser.</p>
<hr class="docutils" />
</div>
<div class="section" id="external-fields">
<span id="externalfield"></span><h2>External fields<a class="headerlink" href="#external-fields" title="Permalink to this headline">¶</a></h2>
<p>An external field can be applied using an <code class="docutils literal notranslate"><span class="pre">ExternalField</span></code> block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ExternalField</span><span class="p">(</span>
    <span class="n">field</span> <span class="o">=</span> <span class="s2">&quot;Ex&quot;</span><span class="p">,</span>
    <span class="n">profile</span> <span class="o">=</span> <span class="n">constant</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">xvacuum</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="data">
<dt id="field">
<code class="sig-name descname">field</code><a class="headerlink" href="#field" title="Permalink to this definition">¶</a></dt>
<dd><p>Field name: <code class="docutils literal notranslate"><span class="pre">&quot;Ex&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Ey&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Ez&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Bx&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;By&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;Bz&quot;</span></code>.</p>
</dd></dl>

<dl class="data">
<dt id="profile">
<code class="sig-name descname">profile</code><a class="headerlink" href="#profile" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float or <em>python</em> function (see section <a class="reference internal" href="#profiles"><span class="std std-ref">Profiles</span></a>)</p>
</dd>
</dl>
<p>The initial spatial profile of the applied field.
Refer to <a class="reference internal" href="units.html"><span class="doc">Units</span></a> to understand the units of this field.</p>
</dd></dl>

<hr class="docutils" />
</div>
<div class="section" id="antennas">
<span id="id7"></span><h2>Antennas<a class="headerlink" href="#antennas" title="Permalink to this headline">¶</a></h2>
<p>An antenna is an extra current applied during the whole simulation.
It is applied using an <code class="docutils literal notranslate"><span class="pre">Antenna</span></code> block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Antenna</span><span class="p">(</span>
    <span class="n">field</span> <span class="o">=</span> <span class="s2">&quot;Jz&quot;</span><span class="p">,</span>
    <span class="n">space_profile</span> <span class="o">=</span> <span class="n">gaussian</span><span class="p">(</span><span class="mf">0.01</span><span class="p">),</span>
    <span class="n">time_profile</span> <span class="o">=</span> <span class="n">tcosine</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="data">
<dt>
<code class="sig-name descname">field</code></dt>
<dd><p>The name of the current: <code class="docutils literal notranslate"><span class="pre">&quot;Jx&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Jy&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;Jz&quot;</span></code>.</p>
</dd></dl>

<dl class="data">
<dt id="space_profile">
<code class="sig-name descname">space_profile</code><a class="headerlink" href="#space_profile" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float or <em>python</em> function (see section <a class="reference internal" href="#profiles"><span class="std std-ref">Profiles</span></a>)</p>
</dd>
</dl>
<p>The initial spatial profile of the applied antenna.
Refer to <a class="reference internal" href="units.html"><span class="doc">Units</span></a> to understand the units of this current.</p>
</dd></dl>

<dl class="data">
<dt id="time_profile">
<code class="sig-name descname">time_profile</code><a class="headerlink" href="#time_profile" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float or <em>python</em> function (see section <a class="reference internal" href="#profiles"><span class="std std-ref">Profiles</span></a>)</p>
</dd>
</dl>
<p>The temporal profile of the applied antenna. It multiplies <code class="docutils literal notranslate"><span class="pre">space_profile</span></code>.</p>
</dd></dl>

<hr class="docutils" />
</div>
<div class="section" id="profiles">
<span id="id8"></span><h2>Profiles<a class="headerlink" href="#profiles" title="Permalink to this headline">¶</a></h2>
<p>Several quantities require the input of a profile: particle charge, particle density,
external fields, etc. Depending on the case, they can be <em>spatial</em> or <em>temporal</em>
profiles.</p>
<p class="rubric">1. Constant profiles</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Species(</span> <span class="pre">...</span> <span class="pre">,</span> <span class="pre">charge</span> <span class="pre">=</span> <span class="pre">-3.,</span> <span class="pre">...</span> <span class="pre">)</span></code> defines a species with charge <span class="math notranslate nohighlight">\(Z^\star=3\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Species(</span> <span class="pre">...</span> <span class="pre">,</span> <span class="pre">number_density</span> <span class="pre">=</span> <span class="pre">10.,</span> <span class="pre">...</span> <span class="pre">)</span></code> defines a species with density <span class="math notranslate nohighlight">\(10\,N_r\)</span>.
You can choose <code class="docutils literal notranslate"><span class="pre">number_density</span></code> or <code class="docutils literal notranslate"><span class="pre">charge_density</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Species(</span> <span class="pre">...</span> <span class="pre">,</span> <span class="pre">mean_velocity</span> <span class="pre">=</span> <span class="pre">[0.05,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">...</span> <span class="pre">)</span></code> defines a species
with drift velocity <span class="math notranslate nohighlight">\(v_x = 0.05\,c\)</span> over the whole box.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Species(...,</span> <span class="pre">momentum_initialization=&quot;maxwell-juettner&quot;,</span> <span class="pre">temperature=[1e-5],</span> <span class="pre">...)</span></code> defines
a species with a Maxwell-Jüttner distribution of temperature <span class="math notranslate nohighlight">\(T = 10^{-5}\,m_ec^2\)</span> over the whole box.
Note that the temperature may be anisotropic: <code class="docutils literal notranslate"><span class="pre">temperature=[1e-5,</span> <span class="pre">2e-5,</span> <span class="pre">2e-5]</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Species(</span> <span class="pre">...</span> <span class="pre">,</span> <span class="pre">particles_per_cell</span> <span class="pre">=</span> <span class="pre">10.,</span> <span class="pre">...</span> <span class="pre">)</span></code> defines a species with 10 particles per cell.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ExternalField(</span> <span class="pre">field=&quot;Bx&quot;,</span> <span class="pre">profile=0.1</span> <span class="pre">)</span></code> defines a constant external field <span class="math notranslate nohighlight">\(B_x = 0.1 B_r\)</span>.</p></li>
</ul>
<p class="rubric">2. <em>Python</em> profiles</p>
<blockquote>
<div><p>Any <em>python</em> function can be a profile. Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">&lt;</span><span class="mf">1.</span><span class="p">:</span> <span class="k">return</span> <span class="mf">0.</span>
    <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="mf">1.</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>    <span class="c1"># two variables for 2D simulation</span>
    <span class="n">twoPI</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span>  <span class="n">twoPI</span> <span class="o">*</span> <span class="n">x</span><span class="o">/</span><span class="mf">3.2</span> <span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">1.</span>
</pre></div>
</div>
<p>Once the function is created, you have to include it in the block you want,
for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Species</span><span class="p">(</span> <span class="o">...</span> <span class="p">,</span> <span class="n">charge</span> <span class="o">=</span> <span class="n">f</span><span class="p">,</span> <span class="o">...</span> <span class="p">)</span>

<span class="n">Species</span><span class="p">(</span> <span class="o">...</span> <span class="p">,</span> <span class="n">mean_velocity</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="o">...</span> <span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is possible, for higher performances, to create functions with
arguments <em>(x, y, etc.)</em> that are actually <em>numpy</em> arrays. If the function returns
a <em>numpy</em> array of the same size, it will automatically be considered as a profile
acting on arrays instead of single floats. Currently, this feature is only available
on Species’ profiles.</p>
</div>
<p class="rubric">3. Pre-defined <em>spatial</em> profiles</p>
<blockquote>
<div><dl class="function">
<dt id="constant">
<code class="sig-name descname">constant</code><span class="sig-paren">(</span><em class="sig-param">value</em>, <em class="sig-param">xvacuum=0.</em>, <em class="sig-param">yvacuum=0.</em><span class="sig-paren">)</span><a class="headerlink" href="#constant" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> – the magnitude</p></li>
<li><p><strong>xvacuum</strong> – vacuum region before the start of the profile.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="trapezoidal">
<code class="sig-name descname">trapezoidal</code><span class="sig-paren">(</span><em class="sig-param">max</em>, <em class="sig-param">xvacuum=0.</em>, <em class="sig-param">xplateau=None</em>, <em class="sig-param">xslope1=0.</em>, <em class="sig-param">xslope2=0.</em>, <em class="sig-param">yvacuum=0.</em>, <em class="sig-param">yplateau=None</em>, <em class="sig-param">yslope1=0.</em>, <em class="sig-param">yslope2=0.</em><span class="sig-paren">)</span><a class="headerlink" href="#trapezoidal" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max</strong> – maximum value</p></li>
<li><p><strong>xvacuum</strong> – empty length before the ramp up</p></li>
<li><p><strong>xplateau</strong> – length of the plateau (default is <a class="reference internal" href="#grid_length" title="grid_length"><code class="xref py py-data docutils literal notranslate"><span class="pre">grid_length</span></code></a> <span class="math notranslate nohighlight">\(-\)</span> <code class="docutils literal notranslate"><span class="pre">xvacuum</span></code>)</p></li>
<li><p><strong>xslope1</strong> – length of the ramp up</p></li>
<li><p><strong>xslope2</strong> – length of the ramp down</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="gaussian">
<code class="sig-name descname">gaussian</code><span class="sig-paren">(</span><em class="sig-param">max</em>, <em class="sig-param">xvacuum=0.</em>, <em class="sig-param">xlength=None</em>, <em class="sig-param">xfwhm=None</em>, <em class="sig-param">xcenter=None</em>, <em class="sig-param">xorder=2</em>, <em class="sig-param">yvacuum=0.</em>, <em class="sig-param">ylength=None</em>, <em class="sig-param">yfwhm=None</em>, <em class="sig-param">ycenter=None</em>, <em class="sig-param">yorder=2</em><span class="sig-paren">)</span><a class="headerlink" href="#gaussian" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max</strong> – maximum value</p></li>
<li><p><strong>xvacuum</strong> – empty length before starting the profile</p></li>
<li><p><strong>xlength</strong> – length of the profile (default is <a class="reference internal" href="#grid_length" title="grid_length"><code class="xref py py-data docutils literal notranslate"><span class="pre">grid_length</span></code></a> <span class="math notranslate nohighlight">\(-\)</span> <code class="docutils literal notranslate"><span class="pre">xvacuum</span></code>)</p></li>
<li><p><strong>xfwhm</strong> – gaussian FWHM (default is <code class="docutils literal notranslate"><span class="pre">xlength/3.</span></code>)</p></li>
<li><p><strong>xcenter</strong> – gaussian center position (default is in the middle of <code class="docutils literal notranslate"><span class="pre">xlength</span></code>)</p></li>
<li><p><strong>xorder</strong> – order of the gaussian.</p></li>
</ul>
</dd>
<dt class="field-even">Note</dt>
<dd class="field-even"><p>If <code class="docutils literal notranslate"><span class="pre">yorder</span></code> equals 0, then the profile is constant over <span class="math notranslate nohighlight">\(y\)</span>.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="polygonal">
<code class="sig-name descname">polygonal</code><span class="sig-paren">(</span><em class="sig-param">xpoints=[]</em>, <em class="sig-param">xvalues=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#polygonal" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xpoints</strong> – list of the positions of the points</p></li>
<li><p><strong>xvalues</strong> – list of the values of the profile at each point</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="cosine">
<code class="sig-name descname">cosine</code><span class="sig-paren">(</span><em class="sig-param">base</em>, <em class="sig-param">amplitude=1.</em>, <em class="sig-param">xvacuum=0.</em>, <em class="sig-param">xlength=None</em>, <em class="sig-param">xphi=0.</em>, <em class="sig-param">xnumber=1</em><span class="sig-paren">)</span><a class="headerlink" href="#cosine" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base</strong> – offset of the profile value</p></li>
<li><p><strong>amplitude</strong> – amplitude of the cosine</p></li>
<li><p><strong>xvacuum</strong> – empty length before starting the profile</p></li>
<li><p><strong>xlength</strong> – length of the profile (default is <a class="reference internal" href="#grid_length" title="grid_length"><code class="xref py py-data docutils literal notranslate"><span class="pre">grid_length</span></code></a> <span class="math notranslate nohighlight">\(-\)</span> <code class="docutils literal notranslate"><span class="pre">xvacuum</span></code>)</p></li>
<li><p><strong>xphi</strong> – phase offset</p></li>
<li><p><strong>xnumber</strong> – number of periods within <code class="docutils literal notranslate"><span class="pre">xlength</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="polynomial">
<code class="sig-name descname">polynomial</code><span class="sig-paren">(</span><em class="sig-param">x0=0.</em>, <em class="sig-param">y0=0.</em>, <em class="sig-param">z0=0.</em>, <em class="sig-param">order0=[]</em>, <em class="sig-param">order1=[]</em>, <em class="sig-param">...</em><span class="sig-paren">)</span><a class="headerlink" href="#polynomial" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong><strong>,</strong><strong>y0</strong> – The reference position(s)</p></li>
<li><p><strong>order0</strong> – Coefficient for the 0th order</p></li>
<li><p><strong>order1</strong> – Coefficient for the 1st order (2 coefficients in 2D)</p></li>
<li><p><strong>order2</strong> – Coefficient for the 2nd order (3 coefficients in 2D)</p></li>
<li><p><strong>etc</strong> – </p></li>
</ul>
</dd>
</dl>
<p>Creates a polynomial of the form</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
&amp;\sum_i a_i(x-x_0)^i &amp; \quad\mathrm{in\, 1D}\\
&amp;\sum_i \sum_j a_{ij}(x-x0)^{i-j}(y-y0)^j &amp; \quad\mathrm{in\, 2D}\\
&amp;\sum_i \sum_j \sum_k a_{ijk}(x-x0)^{i-j-k}(y-y0)^j(z-z0)^k &amp; \quad\mathrm{in\, 3D}
\end{eqnarray}\end{split}\]</div>
<p>Each <code class="docutils literal notranslate"><span class="pre">orderi</span></code> is a coefficient (or list of coefficents) associated to the order <code class="docutils literal notranslate"><span class="pre">i</span></code>.
In 1D, there is only one coefficient per order. In 2D, each <code class="docutils literal notranslate"><span class="pre">orderi</span></code> is a list
of <code class="docutils literal notranslate"><span class="pre">i+1</span></code> coefficients. For instance, the second order has three coefficients
associated to <span class="math notranslate nohighlight">\(x^2\)</span>, <span class="math notranslate nohighlight">\(xy\)</span> and <span class="math notranslate nohighlight">\(y^2\)</span>, respectively.
In 3D, each <code class="docutils literal notranslate"><span class="pre">orderi</span></code> is a list of <code class="docutils literal notranslate"><span class="pre">(i+1)*(i+2)/2</span></code> coefficients. For instance,
the second order has 6 coefficients associated to <span class="math notranslate nohighlight">\(x^2\)</span>, <span class="math notranslate nohighlight">\(xy\)</span>, <span class="math notranslate nohighlight">\(xz\)</span>,
<span class="math notranslate nohighlight">\(y^2\)</span>, <span class="math notranslate nohighlight">\(yz\)</span> and <span class="math notranslate nohighlight">\(z^2\)</span>, respectively.</p>
</dd></dl>

<p><strong>Examples</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Species</span><span class="p">(</span> <span class="o">...</span> <span class="p">,</span> <span class="n">density</span> <span class="o">=</span> <span class="n">gaussian</span><span class="p">(</span><span class="mf">10.</span><span class="p">,</span> <span class="n">xfwhm</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">xcenter</span><span class="o">=</span><span class="mf">0.8</span><span class="p">),</span> <span class="o">...</span> <span class="p">)</span>

<span class="n">ExternalField</span><span class="p">(</span> <span class="o">...</span><span class="p">,</span> <span class="n">profile</span> <span class="o">=</span> <span class="n">constant</span><span class="p">(</span><span class="mf">2.2</span><span class="p">),</span> <span class="o">...</span> <span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p class="rubric">4. Pre-defined <em>temporal</em> profiles</p>
<blockquote>
<div><dl class="function">
<dt id="tconstant">
<code class="sig-name descname">tconstant</code><span class="sig-paren">(</span><em class="sig-param">start=0.</em><span class="sig-paren">)</span><a class="headerlink" href="#tconstant" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>start</strong> – starting time</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ttrapezoidal">
<code class="sig-name descname">ttrapezoidal</code><span class="sig-paren">(</span><em class="sig-param">start=0.</em>, <em class="sig-param">plateau=None</em>, <em class="sig-param">slope1=0.</em>, <em class="sig-param">slope2=0.</em><span class="sig-paren">)</span><a class="headerlink" href="#ttrapezoidal" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> – starting time</p></li>
<li><p><strong>plateau</strong> – duration of the plateau (default is <a class="reference internal" href="#simulation_time" title="simulation_time"><code class="xref py py-data docutils literal notranslate"><span class="pre">simulation_time</span></code></a> <span class="math notranslate nohighlight">\(-\)</span> <code class="docutils literal notranslate"><span class="pre">start</span></code>)</p></li>
<li><p><strong>slope1</strong> – duration of the ramp up</p></li>
<li><p><strong>slope2</strong> – duration of the ramp down</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tgaussian">
<code class="sig-name descname">tgaussian</code><span class="sig-paren">(</span><em class="sig-param">start=0.</em>, <em class="sig-param">duration=None</em>, <em class="sig-param">fwhm=None</em>, <em class="sig-param">center=None</em>, <em class="sig-param">order=2</em><span class="sig-paren">)</span><a class="headerlink" href="#tgaussian" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> – starting time</p></li>
<li><p><strong>duration</strong> – duration of the profile (default is <a class="reference internal" href="#simulation_time" title="simulation_time"><code class="xref py py-data docutils literal notranslate"><span class="pre">simulation_time</span></code></a> <span class="math notranslate nohighlight">\(-\)</span> <code class="docutils literal notranslate"><span class="pre">start</span></code>)</p></li>
<li><p><strong>fwhm</strong> – gaussian FWHM (default is <code class="docutils literal notranslate"><span class="pre">duration/3.</span></code>)</p></li>
<li><p><strong>center</strong> – gaussian center time (default is in the middle of <code class="docutils literal notranslate"><span class="pre">duration</span></code>)</p></li>
<li><p><strong>order</strong> – order of the gaussian</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tpolygonal">
<code class="sig-name descname">tpolygonal</code><span class="sig-paren">(</span><em class="sig-param">points=[]</em>, <em class="sig-param">values=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#tpolygonal" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points</strong> – list of times</p></li>
<li><p><strong>values</strong> – list of the values at each time</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tcosine">
<code class="sig-name descname">tcosine</code><span class="sig-paren">(</span><em class="sig-param">base=0.</em>, <em class="sig-param">amplitude=1.</em>, <em class="sig-param">start=0.</em>, <em class="sig-param">duration=None</em>, <em class="sig-param">phi=0.</em>, <em class="sig-param">freq=1.</em><span class="sig-paren">)</span><a class="headerlink" href="#tcosine" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base</strong> – offset of the profile value</p></li>
<li><p><strong>amplitude</strong> – amplitude of the cosine</p></li>
<li><p><strong>start</strong> – starting time</p></li>
<li><p><strong>duration</strong> – duration of the profile (default is <a class="reference internal" href="#simulation_time" title="simulation_time"><code class="xref py py-data docutils literal notranslate"><span class="pre">simulation_time</span></code></a> <span class="math notranslate nohighlight">\(-\)</span> <code class="docutils literal notranslate"><span class="pre">start</span></code>)</p></li>
<li><p><strong>phi</strong> – phase offset</p></li>
<li><p><strong>freq</strong> – frequency</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tpolynomial">
<code class="sig-name descname">tpolynomial</code><span class="sig-paren">(</span><em class="sig-param">t0=0.</em>, <em class="sig-param">order0=[]</em>, <em class="sig-param">order1=[]</em>, <em class="sig-param">...</em><span class="sig-paren">)</span><a class="headerlink" href="#tpolynomial" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t0</strong> – The reference position</p></li>
<li><p><strong>order0</strong> – Coefficient for the 0th order</p></li>
<li><p><strong>order1</strong> – Coefficient for the 1st order</p></li>
<li><p><strong>order2</strong> – Coefficient for the 2nd order</p></li>
<li><p><strong>etc</strong> – </p></li>
</ul>
</dd>
</dl>
<p>Creates a polynomial of the form <span class="math notranslate nohighlight">\(\sum_i a_i(t-t_0)^i\)</span>.</p>
</dd></dl>

<dl class="function">
<dt id="tsin2plateau">
<code class="sig-name descname">tsin2plateau</code><span class="sig-paren">(</span><em class="sig-param">start=0.</em>, <em class="sig-param">fwhm=0.</em>, <em class="sig-param">plateau=None</em>, <em class="sig-param">slope1=fwhm</em>, <em class="sig-param">slope2=slope1</em><span class="sig-paren">)</span><a class="headerlink" href="#tsin2plateau" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> – Profile is 0 before start</p></li>
<li><p><strong>fwhm</strong> – Full width half maximum of the profile</p></li>
<li><p><strong>plateau</strong> – Length of the plateau</p></li>
<li><p><strong>slope1</strong> – Duration of the ramp up of the profil</p></li>
<li><p><strong>slope2</strong> – Duration of the ramp down of the profil</p></li>
</ul>
</dd>
</dl>
<p>Creates a sin squared profil with a plateau in the middle if needed. If slope1 and 2 are used, fwhm is overwritten.</p>
</dd></dl>

<p><strong>Example</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Antenna</span><span class="p">(</span> <span class="o">...</span> <span class="p">,</span> <span class="n">time_profile</span> <span class="o">=</span> <span class="n">tcosine</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="mf">0.01</span><span class="p">),</span> <span class="o">...</span> <span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p class="rubric">Illustrations of the pre-defined spatial and temporal profiles</p>
<img alt="_images/pythonprofiles.png" src="_images/pythonprofiles.png" />
<img alt="_images/pythonprofiles_t.png" src="_images/pythonprofiles_t.png" />
</div>
<hr class="docutils" />
<div class="section" id="walls">
<h2>Walls<a class="headerlink" href="#walls" title="Permalink to this headline">¶</a></h2>
<p>A wall can be introduced using a <code class="docutils literal notranslate"><span class="pre">PartWall</span></code> block in order to
reflect, stop, thermalize or kill particles which reach it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PartWall</span><span class="p">(</span>
    <span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;reflective&quot;</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mf">20.</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="data">
<dt id="kind">
<code class="sig-name descname">kind</code><a class="headerlink" href="#kind" title="Permalink to this definition">¶</a></dt>
<dd><p>The kind of wall: <code class="docutils literal notranslate"><span class="pre">&quot;reflective&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;stop&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;thermalize&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;remove&quot;</span></code>.</p>
</dd></dl>

<dl class="data">
<dt id="x">
<code class="sig-name descname">x</code><a class="headerlink" href="#x" title="Permalink to this definition">¶</a></dt>
<dt id="y">
<code class="sig-name descname">y</code><a class="headerlink" href="#y" title="Permalink to this definition">¶</a></dt>
<dt id="z">
<code class="sig-name descname">z</code><a class="headerlink" href="#z" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the wall in the desired direction. Use only one of <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code> or <code class="docutils literal notranslate"><span class="pre">z</span></code>.</p>
</dd></dl>

<hr class="docutils" />
</div>
<div class="section" id="collisions">
<span id="id9"></span><h2>Collisions<a class="headerlink" href="#collisions" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="collisions.html"><span class="doc">Binary collisions</span></a> are specified by one or several <code class="docutils literal notranslate"><span class="pre">Collisions</span></code> blocks:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Collisions</span><span class="p">(</span>
    <span class="n">species1</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electrons1&quot;</span><span class="p">,</span>  <span class="s2">&quot;electrons2&quot;</span><span class="p">],</span>
    <span class="n">species2</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ions1&quot;</span><span class="p">],</span>
    <span class="n">coulomb_log</span> <span class="o">=</span> <span class="mf">5.</span><span class="p">,</span>
    <span class="n">debug_every</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">ionizing</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="c1">#      nuclear_reaction = [],</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="data">
<dt id="species1">
<code class="sig-name descname">species1</code><a class="headerlink" href="#species1" title="Permalink to this definition">¶</a></dt>
<dt id="species2">
<code class="sig-name descname">species2</code><a class="headerlink" href="#species2" title="Permalink to this definition">¶</a></dt>
<dd><p>Lists of species’ <a class="reference internal" href="#name" title="name"><code class="xref py py-data docutils literal notranslate"><span class="pre">name</span></code></a>.</p>
<p>The collisions will occur between all species under the group <code class="docutils literal notranslate"><span class="pre">species1</span></code>
and all species under the group <code class="docutils literal notranslate"><span class="pre">species2</span></code>. For example, to collide all
electrons with ions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">species1</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electrons1&quot;</span><span class="p">,</span> <span class="s2">&quot;electrons2&quot;</span><span class="p">],</span> <span class="n">species2</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ions&quot;</span><span class="p">]</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This does not make <code class="docutils literal notranslate"><span class="pre">electrons1</span></code> collide with <code class="docutils literal notranslate"><span class="pre">electrons2</span></code>.</p>
</div>
<p>The two groups of species have to be <em>completely different</em> OR <em>exactly equal</em>.
In other words, if <code class="docutils literal notranslate"><span class="pre">species1</span></code> is not equal to <code class="docutils literal notranslate"><span class="pre">species2</span></code>,
then they cannot have any common species.
If the two groups are exactly equal, we call this situation <strong>intra-collisions</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If both lists <code class="docutils literal notranslate"><span class="pre">species1</span></code> and <code class="docutils literal notranslate"><span class="pre">species2</span></code> contain only one species,
the algorithm is potentially faster than the situation with several
species in one or the other list. This is especially true if the
machine accepts SIMD vectorization.</p>
</div>
</dd></dl>

<dl class="data">
<dt id="coulomb_log">
<code class="sig-name descname">coulomb_log</code><a class="headerlink" href="#coulomb_log" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><ol class="arabic simple" start="0">
<li></li>
</ol>
</dd>
</dl>
<p>The Coulomb logarithm.</p>
<ul class="simple">
<li><p>If <span class="math notranslate nohighlight">\(= 0\)</span>, the Coulomb logarithm is automatically computed for each collision.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(&gt; 0\)</span>, the Coulomb logarithm is equal to this value.</p></li>
</ul>
</dd></dl>

<dl class="data">
<dt id="debug_every">
<code class="sig-name descname">debug_every</code><a class="headerlink" href="#debug_every" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>0</p>
</dd>
</dl>
<p>Number of timesteps between each output of information about collisions.
If 0, there will be no outputs.</p>
</dd></dl>

<span class="target" id="collisionalionization"></span><dl class="data">
<dt id="ionizing">
<code class="sig-name descname">ionizing</code><a class="headerlink" href="#ionizing" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
<p><a class="reference internal" href="collisions.html#collionization"><span class="std std-ref">Collisional ionization</span></a> is set when this parameter is not <code class="docutils literal notranslate"><span class="pre">False</span></code>.
It can either be set to the name of a pre-existing electron species (where the ionized
electrons are created), or to <code class="docutils literal notranslate"><span class="pre">True</span></code> (the first electron species in <a class="reference internal" href="#species1" title="species1"><code class="xref py py-data docutils literal notranslate"><span class="pre">species1</span></code></a>
or <a class="reference internal" href="#species2" title="species2"><code class="xref py py-data docutils literal notranslate"><span class="pre">species2</span></code></a> is then chosen for ionized electrons).</p>
<p>One of the species groups must be all electrons (<a class="reference internal" href="#mass" title="mass"><code class="xref py py-data docutils literal notranslate"><span class="pre">mass</span></code></a> = 1), and the other
one all ions of the same <a class="reference internal" href="#atomic_number" title="atomic_number"><code class="xref py py-data docutils literal notranslate"><span class="pre">atomic_number</span></code></a>.</p>
</dd></dl>

<dl class="experimental data">
<dt id="nuclear_reaction">
<code class="sig-name descname">nuclear_reaction</code><a class="headerlink" href="#nuclear_reaction" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>a list of strings</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code> (no nuclear reaction)</p>
</dd>
</dl>
<p>A list of the species names for the products of nuclear reactions
that may occur during collisions. You may omit product species if they are not necessary
for the simulation.</p>
<p>All members of <a class="reference internal" href="#species1" title="species1"><code class="xref py py-data docutils literal notranslate"><span class="pre">species1</span></code></a> must be the same type of atoms, which is automatically
recognized by their <a class="reference internal" href="#mass" title="mass"><code class="xref py py-data docutils literal notranslate"><span class="pre">mass</span></code></a> and <a class="reference internal" href="#atomic_number" title="atomic_number"><code class="xref py py-data docutils literal notranslate"><span class="pre">atomic_number</span></code></a>. The same applies for
all members of <a class="reference internal" href="#species2" title="species2"><code class="xref py py-data docutils literal notranslate"><span class="pre">species2</span></code></a>.</p>
<p>In the current version, only the reaction D(d,n)He³ is available.</p>
</dd></dl>

<dl class="experimental data">
<dt id="nuclear_reaction_multiplier">
<code class="sig-name descname">nuclear_reaction_multiplier</code><a class="headerlink" href="#nuclear_reaction_multiplier" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>a float</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><ol class="arabic simple" start="0">
<li><p>(automatically adjusted)</p></li>
</ol>
</dd>
</dl>
<p>The rate multiplier for nuclear reactions. It is a positive number that artificially
increases the occurence of reactions so that a good statistics is obtained. The number
of actual reaction products is adjusted by changing their weights in order to provide
a physically correct number of reactions. Leave this number to <code class="docutils literal notranslate"><span class="pre">0.</span></code> for an automatic
rate multiplier: the final number of produced macro-particles will be of the same order
as that of reactants.</p>
</dd></dl>

<hr class="docutils" />
</div>
<div class="section" id="radiation-reaction">
<span id="radiationreaction"></span><h2>Radiation reaction<a class="headerlink" href="#radiation-reaction" title="Permalink to this headline">¶</a></h2>
<p>The block <code class="docutils literal notranslate"><span class="pre">RadiationReaction()</span></code> enables to tune the radiation loss properties
(see <a class="reference internal" href="radiation_loss.html"><span class="doc">Synchrotron-like radiation reaction</span></a>).
Many parameters are used for the generation of the cross-section tables
for the Monte-Carlo emission process.
If the tables already exist in the simulation directory, then they will be read
and no new table will be generated by <strong class="program">Smilei</strong>.
Otherwise, <strong class="program">Smilei</strong> can compute and output these
tables.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RadiationReaction</span><span class="p">(</span>

  <span class="c1"># Radiation parameters</span>
  <span class="n">minimum_chi_continuous</span> <span class="o">=</span> <span class="mf">1e-3</span><span class="p">,</span>
  <span class="n">minimum_chi_discontinuous</span> <span class="o">=</span> <span class="mf">1e-2</span><span class="p">,</span>
  <span class="n">table_path</span> <span class="o">=</span> <span class="s2">&quot;../databases/&quot;</span><span class="p">,</span>
  <span class="n">compute_table</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>

  <span class="c1"># Following parameters are only if you want to compute the tables</span>

  <span class="n">output_format</span> <span class="o">=</span> <span class="s2">&quot;hdf5&quot;</span><span class="p">,</span>

  <span class="c1"># Parameters to generate the table h used by Niel et al.</span>
  <span class="n">h_chipa_min</span> <span class="o">=</span> <span class="mf">1E-3</span><span class="p">,</span>
  <span class="n">h_chipa_max</span> <span class="o">=</span> <span class="mf">1E1</span><span class="p">,</span>
  <span class="n">h_dim</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span>
  <span class="n">h_computation_method</span> <span class="o">=</span> <span class="s2">&quot;table&quot;</span><span class="p">,</span>

  <span class="c1"># Parameter to generate the table integfochi used by the Monte-Carlo model</span>
  <span class="n">integfochi_chipa_min</span> <span class="o">=</span> <span class="mf">1e-4</span><span class="p">,</span>
  <span class="n">integfochi_chipa_max</span> <span class="o">=</span> <span class="mf">1e1</span><span class="p">,</span>
  <span class="n">integfochi_dim</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span>

  <span class="c1"># Parameter to generate the table xip used by the Monte-Carlo model</span>
  <span class="n">xip_chipa_min</span> <span class="o">=</span> <span class="mf">1e-4</span><span class="p">,</span>
  <span class="n">xip_chipa_max</span> <span class="o">=</span> <span class="mf">1e1</span><span class="p">,</span>
  <span class="n">xip_power</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
  <span class="n">xip_threshold</span> <span class="o">=</span> <span class="mf">1e-3</span><span class="p">,</span>
  <span class="n">xip_chipa_dim</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span>
  <span class="n">xip_chiph_dim</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="data">
<dt id="output_format">
<code class="sig-name descname">output_format</code><a class="headerlink" href="#output_format" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;hdf5&quot;</span></code></p>
</dd>
</dl>
<p>Output format of the tables: <code class="docutils literal notranslate"><span class="pre">&quot;hdf5&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;binary&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;ascii&quot;</span></code>.</p>
</dd></dl>

<dl class="data">
<dt id="minimum_chi_continuous">
<code class="sig-name descname">minimum_chi_continuous</code><a class="headerlink" href="#minimum_chi_continuous" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1e-3</p>
</dd>
</dl>
<p>Threshold on the particle quantum parameter <em>particle_chi</em>. When a particle has a
quantum parameter below this threshold, radiation reaction is not taken
into account.</p>
</dd></dl>

<dl class="data">
<dt id="minimum_chi_discontinuous">
<code class="sig-name descname">minimum_chi_discontinuous</code><a class="headerlink" href="#minimum_chi_discontinuous" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1e-2</p>
</dd>
</dl>
<p>Threshold on the particle quantum parameter <em>particle_chi</em> between the continuous
and the discontinuous radiation model.</p>
</dd></dl>

<dl class="data">
<dt id="table_path">
<code class="sig-name descname">table_path</code><a class="headerlink" href="#table_path" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;./&quot;</span></code></p>
</dd>
</dl>
<p>Path to the external tables for the radiation losses.
Default tables are located in <code class="docutils literal notranslate"><span class="pre">databases</span></code>.</p>
</dd></dl>

<dl class="data">
<dt id="compute_table">
<code class="sig-name descname">compute_table</code><a class="headerlink" href="#compute_table" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>False</p>
</dd>
</dl>
<p>If True, the tables for the selected radiation model are computed
with the requested parameters and stored at the path <cite>table_path</cite>.</p>
</dd></dl>

<dl class="data">
<dt id="h_chipa_min">
<code class="sig-name descname">h_chipa_min</code><a class="headerlink" href="#h_chipa_min" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1e-3</p>
</dd>
</dl>
<p>Minimum value of the quantum parameter <span class="math notranslate nohighlight">\(\chi\)</span> for the table <em>h</em> of Niel <cite>et al</cite>.</p>
</dd></dl>

<dl class="data">
<dt id="h_chipa_max">
<code class="sig-name descname">h_chipa_max</code><a class="headerlink" href="#h_chipa_max" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1e1</p>
</dd>
</dl>
<p>Maximum value of the quantum parameter <span class="math notranslate nohighlight">\(\chi\)</span> for the table <em>h</em> of Niel <cite>et al</cite>.</p>
</dd></dl>

<dl class="data">
<dt id="h_dim">
<code class="sig-name descname">h_dim</code><a class="headerlink" href="#h_dim" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>128</p>
</dd>
</dl>
<p>Dimension of the table <em>h</em> of Niel <cite>et al</cite>.</p>
</dd></dl>

<dl class="data">
<dt id="h_computation_method">
<code class="sig-name descname">h_computation_method</code><a class="headerlink" href="#h_computation_method" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>“table”</p>
</dd>
</dl>
<p>Method to compute the value of the table <em>h</em> of Niel <cite>et al</cite> during the emission process.
The possible values are:</p>
<ul class="simple">
<li><p>“table”: the <em>h</em> function is tabulated. The table is computed at initialization or read from an external file.</p></li>
<li><p>“fit5”: A polynomial fit of order 5 is used. No table is required.
The maximal relative error to the reference data is of maximum of 0.02.
The fit is valid for quantum parameters <span class="math notranslate nohighlight">\(\chi\)</span> between 1e-3 and 10.</p></li>
<li><p>“fit10”:  A polynomial fit of order 10 is used. No table is required.
The precision if better than the fit of order 5 with a maximal relative error of 0.0002.
The fit is valid for quantum parameters <span class="math notranslate nohighlight">\(\chi\)</span> between 1e-3 and 10.</p></li>
<li><p>“ridgers”: The fit of Ridgers given in Ridgers et al., ArXiv 1708.04511 (2017)</p></li>
</ul>
<p>The use of tabulated values is best for accuracy but not for performance.
Table access prevent total vectorization.
Fits are vectorizable.</p>
</dd></dl>

<dl class="data">
<dt id="integfochi_chipa_min">
<code class="sig-name descname">integfochi_chipa_min</code><a class="headerlink" href="#integfochi_chipa_min" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1e-3</p>
</dd>
</dl>
<p>Minimum value of the quantum parameter c for the table containing
the integration of <span class="math notranslate nohighlight">\(F/\chi\)</span>.</p>
</dd></dl>

<dl class="data">
<dt id="integfochi_chipa_max">
<code class="sig-name descname">integfochi_chipa_max</code><a class="headerlink" href="#integfochi_chipa_max" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1e1</p>
</dd>
</dl>
<p>Maximum value of the quantum parameter <span class="math notranslate nohighlight">\(\chi\)</span> for the table containing
the integration of <span class="math notranslate nohighlight">\(F/\chi\)</span>.</p>
</dd></dl>

<dl class="data">
<dt id="integfochi_dim">
<code class="sig-name descname">integfochi_dim</code><a class="headerlink" href="#integfochi_dim" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>128</p>
</dd>
</dl>
<p>Discretization of the table containing
the integration of <span class="math notranslate nohighlight">\(F/\chi\)</span>.</p>
</dd></dl>

<dl class="data">
<dt id="xip_chipa_min">
<code class="sig-name descname">xip_chipa_min</code><a class="headerlink" href="#xip_chipa_min" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1e-3</p>
</dd>
</dl>
<p>Minimum particle quantum parameter for the computation of the <em>chimin</em>
and <em>xip</em> tables.</p>
</dd></dl>

<dl class="data">
<dt id="xip_chipa_max">
<code class="sig-name descname">xip_chipa_max</code><a class="headerlink" href="#xip_chipa_max" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1e1</p>
</dd>
</dl>
<p>Maximum particle quantum parameter for the computation of the <em>chimin</em>
and <em>xip</em> tables.</p>
</dd></dl>

<dl class="data">
<dt id="xip_power">
<code class="sig-name descname">xip_power</code><a class="headerlink" href="#xip_power" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>4</p>
</dd>
</dl>
<p>Maximum decrease in order of magnitude for the search for the minimum value
of the photon quantum parameter. It is advised to keep this value by default.</p>
</dd></dl>

<dl class="data">
<dt id="xip_threshold">
<code class="sig-name descname">xip_threshold</code><a class="headerlink" href="#xip_threshold" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1e-3</p>
</dd>
</dl>
<p>Minimum value of <em>xip</em> to compute the minimum value of the photon
quantum parameter. It is advised to keep this value by default.</p>
</dd></dl>

<dl class="data">
<dt id="xip_chipa_dim">
<code class="sig-name descname">xip_chipa_dim</code><a class="headerlink" href="#xip_chipa_dim" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>128</p>
</dd>
</dl>
<p>Discretization of the <em>chimin</em> and <em>xip</em> tables in the <em>particle_chi</em> direction.</p>
</dd></dl>

<dl class="data">
<dt id="xip_chiph_dim">
<code class="sig-name descname">xip_chiph_dim</code><a class="headerlink" href="#xip_chiph_dim" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>128</p>
</dd>
</dl>
<p>Discretization of the <em>xip</em> tables in the <em>photon_chi</em> direction.</p>
</dd></dl>

<hr class="docutils" />
</div>
<div class="section" id="multiphoton-breit-wheeler">
<span id="multiphotonbreitwheeler"></span><h2>Multiphoton Breit-Wheeler<a class="headerlink" href="#multiphoton-breit-wheeler" title="Permalink to this headline">¶</a></h2>
<p>The block <code class="docutils literal notranslate"><span class="pre">MultiphotonBreitWheeler</span></code> enables to tune parameters of the
multiphoton Breit-Wheeler process and particularly the table generation.</p>
<p>There are two tables used for the multiphoton Breit-Wheeler refers to as the
<em>T</em> table and the <em>xip</em> table.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MultiphotonBreitWheeler</span><span class="p">(</span>

  <span class="c1"># Table output format, can be &quot;ascii&quot;, &quot;binary&quot;, &quot;hdf5&quot;</span>
  <span class="n">output_format</span> <span class="o">=</span> <span class="s2">&quot;hdf5&quot;</span><span class="p">,</span>

  <span class="c1"># Path to the tables</span>
  <span class="n">table_path</span> <span class="o">=</span> <span class="s2">&quot;../databases/&quot;</span><span class="p">,</span>

  <span class="c1"># Flag to compute the tables</span>
  <span class="n">compute_table</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>

  <span class="c1"># Table T parameters</span>
  <span class="n">T_chiph_min</span> <span class="o">=</span> <span class="mf">1e-2</span><span class="p">,</span>
  <span class="n">T_chiph_max</span> <span class="o">=</span> <span class="mf">1e1</span><span class="p">,</span>
  <span class="n">T_dim</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span>

  <span class="c1"># Table xip parameters</span>
  <span class="n">xip_chiph_min</span> <span class="o">=</span> <span class="mf">1e-2</span><span class="p">,</span>
  <span class="n">xip_chiph_max</span> <span class="o">=</span> <span class="mf">1e1</span><span class="p">,</span>
  <span class="n">xip_power</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
  <span class="n">xip_threshold</span> <span class="o">=</span> <span class="mf">1e-3</span><span class="p">,</span>
  <span class="n">xip_chipa_dim</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span>
  <span class="n">xip_chiph_dim</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span>

<span class="p">)</span>
</pre></div>
</div>
<dl class="data">
<dt>
<code class="sig-name descname">table_path</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;./&quot;</span></code></p>
</dd>
</dl>
<p>Path to the external tables for the multiphoton Breit-Wheeler.
Default tables are located in <code class="docutils literal notranslate"><span class="pre">databases</span></code>.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">compute_table</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>False</p>
</dd>
</dl>
<p>If True, the tables for the selected radiation model are computed
with the requested parameters and stored at the path <cite>table_path</cite>.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">output_format</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;hdf5&quot;</span></code></p>
</dd>
</dl>
<dl class="simple">
<dt>Output format of the tables:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;hdf5&quot;</span></code>: <code class="docutils literal notranslate"><span class="pre">multiphoton_Breit_Wheeler_tables.h5</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;binary&quot;</span></code>: <code class="docutils literal notranslate"><span class="pre">tab_T.bin</span></code> and <code class="docutils literal notranslate"><span class="pre">tab_mBW_xip.bin</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;ascii&quot;</span></code>: <code class="docutils literal notranslate"><span class="pre">tab_T.dat</span></code> and <code class="docutils literal notranslate"><span class="pre">tab_mBW_xip.dat</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="data">
<dt id="T_chiph_min">
<code class="sig-name descname">T_chiph_min</code><a class="headerlink" href="#T_chiph_min" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1e-2</p>
</dd>
</dl>
<p>Minimum value of the photon quantum parameter <span class="math notranslate nohighlight">\(\chi_\gamma\)</span> for the table <em>T</em>.</p>
</dd></dl>

<dl class="data">
<dt id="T_chiph_max">
<code class="sig-name descname">T_chiph_max</code><a class="headerlink" href="#T_chiph_max" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1e1</p>
</dd>
</dl>
<p>Maximum value of the photon quantum parameter <span class="math notranslate nohighlight">\(\chi_\gamma\)</span> for the table <em>T</em>.</p>
</dd></dl>

<dl class="data">
<dt id="T_dim">
<code class="sig-name descname">T_dim</code><a class="headerlink" href="#T_dim" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>128</p>
</dd>
</dl>
<p>Dimension of the table <em>T</em>.</p>
</dd></dl>

<dl class="data">
<dt id="xip_chiph_min">
<code class="sig-name descname">xip_chiph_min</code><a class="headerlink" href="#xip_chiph_min" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1e-2</p>
</dd>
</dl>
<p>Minimum photon quantum parameter for the computation of the <em>chimin</em>
and <em>xip</em> tables.</p>
</dd></dl>

<dl class="data">
<dt id="xip_chiph_max">
<code class="sig-name descname">xip_chiph_max</code><a class="headerlink" href="#xip_chiph_max" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1e1</p>
</dd>
</dl>
<p>Maximum photon quantum parameter for the computation of the <em>chimin</em>
and <em>xip</em> tables.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">xip_power</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>4</p>
</dd>
</dl>
<p>Maximum decrease in order of magnitude for the search for the minimum value
of the photon quantum parameter. It is advised to keep this value by default.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">xip_threshold</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1e-3</p>
</dd>
</dl>
<p>Minimum value of <em>xip</em> to compute the minimum value of the photon
quantum parameter. It is advised to keep this value by default.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">xip_chiph_dim</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>128</p>
</dd>
</dl>
<p>Discretization of the <em>chimin</em> and <em>xip</em> tables in the <em>photon_chi</em> direction.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">xip_chipa_dim</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>128</p>
</dd>
</dl>
<p>Discretization of the <em>xip</em> tables in the <em>particle_chi</em> direction.</p>
</dd></dl>

<hr class="docutils" />
</div>
<div class="section" id="scalar-diagnostics">
<span id="diagscalar"></span><h2><em>Scalar</em> diagnostics<a class="headerlink" href="#scalar-diagnostics" title="Permalink to this headline">¶</a></h2>
<p><strong class="program">Smilei</strong> can collect various scalar data, such as total particle energy, total field energy, etc.
This is done by including the block <code class="docutils literal notranslate"><span class="pre">DiagScalar</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagScalar</span><span class="p">(</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">10</span> <span class="p">,</span>
    <span class="nb">vars</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Utot&quot;</span><span class="p">,</span> <span class="s2">&quot;Ukin&quot;</span><span class="p">,</span> <span class="s2">&quot;Uelm&quot;</span><span class="p">],</span>
    <span class="n">precision</span> <span class="o">=</span> <span class="mi">10</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="data">
<dt>
<code class="sig-name descname">every</code></dt>
<dd><p>Number of timesteps between each output <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
</dd></dl>

<dl class="data">
<dt id="vars">
<code class="sig-name descname">vars</code><a class="headerlink" href="#vars" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">[]</span></code></p>
</dd>
</dl>
<div class="line-block">
<div class="line">List of scalars that will be actually output. Note that most scalars are computed anyways.</div>
<div class="line">Omit this argument to include all scalars.</div>
</div>
</dd></dl>

<dl class="data">
<dt id="precision">
<code class="sig-name descname">precision</code><a class="headerlink" href="#precision" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>10</p>
</dd>
</dl>
<p>Number of digits of the outputs.</p>
</dd></dl>

<p>The full list of available scalars is given in the table below.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>As some of these quantities are integrated in space and/or time, their
units are unusual, and depend on the simulation dimension.
All details <a class="reference internal" href="units.html#integrated-quantities"><span class="std std-ref">here</span></a>.</p>
</div>
<table class="nowrap docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<tbody>
<tr class="row-odd"><td colspan="2"><p><strong>Space-integrated energy densities</strong></p></td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">Utot</div>
<div class="line">Ukin</div>
<div class="line">Uelm</div>
<div class="line">Uexp</div>
<div class="line">Ubal</div>
<div class="line">Ubal_norm</div>
<div class="line">Uelm_Ex</div>
<div class="line"><br /></div>
<div class="line">Urad</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Total</div>
<div class="line">Total kinetic (in the particles)</div>
<div class="line">Total electromagnetic (in the fields)</div>
<div class="line">Expected (Initial <span class="math notranslate nohighlight">\(-\)</span> lost <span class="math notranslate nohighlight">\(+\)</span> gained)</div>
<div class="line">Balance (Utot <span class="math notranslate nohighlight">\(-\)</span> Uexp)</div>
<div class="line">Normalized balance (Ubal <span class="math notranslate nohighlight">\(/\)</span> Utot)</div>
<div class="line">Ex field contribution (<span class="math notranslate nohighlight">\(\int E_x^2 dV /2\)</span>)</div>
<div class="line-block">
<div class="line">… same for fields Ey, Ez, Bx_m, By_m and Bz_m</div>
</div>
<div class="line">Total radiated</div>
</div>
</td>
</tr>
<tr class="row-odd"><td colspan="2"><p><strong>Space- &amp; time-integrated Energies lost/gained at boundaries</strong></p></td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">Ukin_bnd</div>
<div class="line">Uelm_bnd</div>
<div class="line"><br /></div>
<div class="line">PoyXminInst</div>
<div class="line">PoyXmin</div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line">Time-accumulated kinetic energy exchanged at the boundaries</div>
<div class="line">Time-accumulated EM energy exchanged at boundaries</div>
<div class="line"><br /></div>
<div class="line">Poynting contribution through xmin boundary during the timestep</div>
<div class="line">Time-accumulated Poynting contribution through xmin boundary</div>
<div class="line-block">
<div class="line">… same for other boundaries</div>
</div>
</div>
</td>
</tr>
<tr class="row-odd"><td colspan="2"><p><strong>Particle information</strong></p></td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">Zavg_abc</div>
<div class="line">Dens_abc</div>
<div class="line">Ukin_abc</div>
<div class="line">Urad_abc</div>
<div class="line">Ntot_abc</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Average charge of species “abc” (equals <cite>nan</cite> if no particle)</div>
<div class="line-block">
<div class="line">… its integrated density</div>
<div class="line">… its integrated kinetic energy density</div>
<div class="line">… its integrated radiated energy density</div>
<div class="line">… and number of macro-particles</div>
</div>
</div>
</td>
</tr>
<tr class="row-odd"><td colspan="2"><p><strong>Fields information</strong></p></td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">ExMin</div>
<div class="line">ExMinCell</div>
<div class="line">ExMax</div>
<div class="line">ExMaxCell</div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line">Minimum of <span class="math notranslate nohighlight">\(E_x\)</span></div>
<div class="line-block">
<div class="line">… and its location (cell index)</div>
</div>
<div class="line">Maximum of <span class="math notranslate nohighlight">\(E_x\)</span></div>
<div class="line-block">
<div class="line">… and its location (cell index)</div>
</div>
<div class="line">… same for fields Ey Ez Bx_m By_m Bz_m Jx Jy Jz Rho</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>Checkout the <a class="reference internal" href="post-processing.html"><span class="doc">post-processing</span></a> documentation as well.</p>
<hr class="docutils" />
</div>
<div class="section" id="fields-diagnostics">
<span id="diagfields"></span><h2><em>Fields</em> diagnostics<a class="headerlink" href="#fields-diagnostics" title="Permalink to this headline">¶</a></h2>
<p><strong class="program">Smilei</strong> can collect various field data (electromagnetic fields, currents and density)
taken at the location of the PIC grid, both as instantaneous values and averaged values.
This is done by including a block <code class="docutils literal notranslate"><span class="pre">DiagFields</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagFields</span><span class="p">(</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">time_average</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Ey&quot;</span><span class="p">,</span> <span class="s2">&quot;Ez&quot;</span><span class="p">],</span>
    <span class="c1">#subgrid = None</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="data">
<dt>
<code class="sig-name descname">every</code></dt>
<dd><p>Number of timesteps between each output <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
</dd></dl>

<dl class="data">
<dt id="flush_every">
<code class="sig-name descname">flush_every</code><a class="headerlink" href="#flush_every" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1</p>
</dd>
</dl>
<p>Number of timesteps <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
<p>When <cite>flush_every</cite> coincides with <cite>every</cite>, the output
file is actually written (“flushed” from the buffer). Flushing
too often can <em>dramatically</em> slow down the simulation.</p>
</dd></dl>

<dl class="data">
<dt id="time_average">
<code class="sig-name descname">time_average</code><a class="headerlink" href="#time_average" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">1</span></code> <em>(no averaging)</em></p>
</dd>
</dl>
<p>The number of timesteps for time-averaging.</p>
</dd></dl>

<dl class="data">
<dt id="fields">
<code class="sig-name descname">fields</code><a class="headerlink" href="#fields" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">[]</span></code> <em>(all fields are written)</em></p>
</dd>
</dl>
<p>List of the field names that are saved. By default, they all are.
The full list of fields that are saved by this diagnostic:</p>
<table class="nowrap docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><div class="line-block">
<div class="line">Bx</div>
<div class="line">By</div>
<div class="line">Bz</div>
</div>
</td>
<td><div class="line-block">
<div class="line"><br /></div>
<div class="line">Components of the magnetic field</div>
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">Bx_m</div>
<div class="line">By_m</div>
<div class="line">Bz_m</div>
</div>
</td>
<td><div class="line-block">
<div class="line"><br /></div>
<div class="line">Components of the magnetic field (time-centered)</div>
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line">Ex</div>
<div class="line">Ey</div>
<div class="line">Ez</div>
</div>
</td>
<td><div class="line-block">
<div class="line"><br /></div>
<div class="line">Components of the electric field</div>
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">Jx</div>
<div class="line">Jy</div>
<div class="line">Jz</div>
</div>
</td>
<td><div class="line-block">
<div class="line"><br /></div>
<div class="line">Components of the total current</div>
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line">Jx_abc</div>
<div class="line">Jy_abc</div>
<div class="line">Jz_abc</div>
</div>
</td>
<td><div class="line-block">
<div class="line"><br /></div>
<div class="line">Components of the current due to species “abc”</div>
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">Rho</div>
<div class="line">Rho_abc</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Total density</div>
<div class="line">Density of species “abc”</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>In <code class="docutils literal notranslate"><span class="pre">AMcylindrical</span></code> geometry, the <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code> and <code class="docutils literal notranslate"><span class="pre">z</span></code>
indices are replaced by <code class="docutils literal notranslate"><span class="pre">l</span></code> (longitudinal), <code class="docutils literal notranslate"><span class="pre">r</span></code> (radial) and <code class="docutils literal notranslate"><span class="pre">t</span></code> (theta). In addition,
the angular Fourier modes are denoted by the suffix <code class="docutils literal notranslate"><span class="pre">_mode_i</span></code> where <code class="docutils literal notranslate"><span class="pre">i</span></code>
is the mode number.
If a field is specified without its associated mode number, all available modes will be included.
In summary, the list of fields reads as follows.</p>
<table class="nowrap docutils align-default">
<colgroup>
<col style="width: 42%" />
<col style="width: 58%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><div class="line-block">
<div class="line">Bl_mode_0, Bl_mode_1, etc.</div>
<div class="line">Br_mode_0, Br_mode_1, etc.</div>
<div class="line">Bt_mode_0, Bt_mode_1, etc.</div>
</div>
</td>
<td><div class="line-block">
<div class="line"><br /></div>
<div class="line">Components of the magnetic field</div>
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">El_mode_0, El_mode_1, etc.</div>
<div class="line">Er_mode_0, Er_mode_1, etc.</div>
<div class="line">Et_mode_0, Et_mode_1, etc.</div>
</div>
</td>
<td><div class="line-block">
<div class="line"><br /></div>
<div class="line">Components of the electric field</div>
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-odd"><td colspan="2"><p>The same notation works for Jl, Jr, Jt, and Rho</p></td>
</tr>
</tbody>
</table>
<p>In the case of an envelope model for the laser (see <a class="reference internal" href="laser_envelope.html"><span class="doc">Laser envelope model</span></a>),
the following fields are also available:</p>
<table class="nowrap docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><div class="line-block">
<div class="line"><br /></div>
<div class="line">Env_A_abs</div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line">Module of laser vector potential’s complex envelope</div>
<div class="line"><span class="math notranslate nohighlight">\(\tilde{A}\)</span> (component along the polarization</div>
<div class="line">direction)</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">Env_Chi</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Total  susceptibility <span class="math notranslate nohighlight">\(\chi\)</span></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line"><br /></div>
<div class="line">Env_E_abs</div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line">Module of laser electric field’s complex envelope</div>
<div class="line"><span class="math notranslate nohighlight">\(\tilde{E}\)</span> (component along the polarization</div>
<div class="line">direction)</div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To write these last three envelope fields with this diagnostics in <code class="docutils literal notranslate"><span class="pre">&quot;AMcylindrical&quot;</span></code> geometry,
a dedicated block <code class="docutils literal notranslate"><span class="pre">DiagFields</span></code> must be defined, e.g. with <code class="docutils literal notranslate"><span class="pre">fields</span> <span class="pre">=</span> <span class="pre">[&quot;Env_A_abs_mode_0&quot;,</span> <span class="pre">&quot;Env_Chi_mode_0&quot;]</span></code>.</p>
</div>
<dl class="data">
<dt id="subgrid">
<code class="sig-name descname">subgrid</code><a class="headerlink" href="#subgrid" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">None</span></code> <em>(the whole grid is used)</em></p>
</dd>
</dl>
<p>A list of slices indicating a portion of the simulation grid to be written by this
diagnostic. This list must have as many elements as the simulation dimension.
For example, in a 3D simulation, the list has 3 elements. Each element can be:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>, to select the whole grid along that dimension</p></li>
<li><p>an integer, to select only the corresponding cell index along that dimension</p></li>
<li><p>a <em>python</em> <a class="reference external" href="https://docs.python.org/3/library/functions.html#slice">slice object</a>
to select regularly-spaced cell indices along that dimension.</p></li>
</ul>
<p>This can be easily implemented using the
<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.s_.html">numpy.s_ expression</a>.
For instance, in a 3D simulation, the following subgrid selects only every other element
in each dimension:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">s_</span>
<span class="n">DiagFields</span><span class="p">(</span> <span class="c1">#...</span>
    <span class="n">subgrid</span> <span class="o">=</span> <span class="n">s_</span><span class="p">[::</span><span class="mi">2</span><span class="p">,</span> <span class="p">::</span><span class="mi">2</span><span class="p">,</span> <span class="p">::</span><span class="mi">2</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>while this one selects cell indices included in a contiguous parallelepiped:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">subgrid</span> <span class="o">=</span> <span class="n">s_</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">:</span><span class="mi">500</span><span class="p">,</span> <span class="mi">300</span><span class="p">:</span><span class="mi">600</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<hr class="docutils" />
</div>
<div class="section" id="probe-diagnostics">
<span id="diagprobe"></span><h2><em>Probe</em> diagnostics<a class="headerlink" href="#probe-diagnostics" title="Permalink to this headline">¶</a></h2>
<p>The fields from the previous section are taken at the PIC grid locations,
but it is also possible to obtain the fields at arbitrary locations.
These are called <em>probes</em>.</p>
<p>A probe interpolates the fields at either one point (0-D),
several points arranged in a line (1-D),
or several points arranged in a 2-D or 3-D grid.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Probes follow the moving window.
To obtain the fields at fixed points in the plasma instead, create a cold,
chargeless species, and <a class="reference internal" href="#diagtrackparticles"><span class="std std-ref">track the particles</span></a>.</p>
</div>
<p>To add one probe diagnostic, include the block <code class="docutils literal notranslate"><span class="pre">DiagProbe</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagProbe</span><span class="p">(</span>
    <span class="n">every</span>    <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">origin</span>   <span class="o">=</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
    <span class="n">corners</span>  <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">10.</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">10.</span><span class="p">,</span><span class="mf">1.</span><span class="p">],</span>
    <span class="p">]</span>
    <span class="n">number</span>   <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
    <span class="n">fields</span>   <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Ey&quot;</span><span class="p">,</span> <span class="s2">&quot;Ez&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="data">
<dt>
<code class="sig-name descname">every</code></dt>
<dd><p>Number of timesteps between each output <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">flush_every</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1</p>
</dd>
</dl>
<p>Number of timesteps <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
<p>When <cite>flush_every</cite> coincides with <cite>every</cite>, the output
file is actually written (“flushed” from the buffer). Flushing
too often can <em>dramatically</em> slow down the simulation.</p>
</dd></dl>

<dl class="data">
<dt id="origin">
<code class="sig-name descname">origin</code><a class="headerlink" href="#origin" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>A list of floats, of length equal to the simulation dimensionality.</p>
</dd>
</dl>
<p>The coordinates of the origin of the probe grid</p>
</dd></dl>

<dl class="data">
<dt id="corners">
<code class="sig-name descname">corners</code><a class="headerlink" href="#corners" title="Permalink to this definition">¶</a></dt>
<dt id="vectors">
<code class="sig-name descname">vectors</code><a class="headerlink" href="#vectors" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>A list of lists of floats.</p>
</dd>
</dl>
<p>Defines the corners of the probe grid.
Each corner is a list of coordinates (as many as the simulation dimensions).</p>
<p>When using <code class="docutils literal notranslate"><span class="pre">corners</span></code>, the absolute coordinates of each corner must be specified.
When using <code class="docutils literal notranslate"><span class="pre">vectors</span></code>, the coordinates relative to <a class="reference internal" href="#origin" title="origin"><code class="xref py py-data docutils literal notranslate"><span class="pre">origin</span></code></a> must be specified.</p>
</dd></dl>

<dl class="data">
<dt id="number">
<code class="sig-name descname">number</code><a class="headerlink" href="#number" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>A list of integers, one for each dimension of the probe.</p>
</dd>
</dl>
<p>The number of points in each probe axis. Must not be defined for a 0-D probe.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">fields</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">[]</span></code>, which means <code class="docutils literal notranslate"><span class="pre">[&quot;Ex&quot;,</span> <span class="pre">&quot;Ey&quot;,</span> <span class="pre">&quot;Ez&quot;,</span> <span class="pre">&quot;Bx&quot;,</span> <span class="pre">&quot;By&quot;,</span> <span class="pre">&quot;Bz&quot;,</span> <span class="pre">&quot;Jx&quot;,</span> <span class="pre">&quot;Jy&quot;,</span> <span class="pre">&quot;Jz&quot;,</span> <span class="pre">&quot;Rho&quot;]</span></code></p>
</dd>
</dl>
<p>A list of fields among <code class="docutils literal notranslate"><span class="pre">&quot;Ex&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Ey&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Ez&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;Bx&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;By&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Bz&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Jx&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Jy&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Jz&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;Rho&quot;</span></code>.
Only listed fields will be saved although they are all calculated.</p>
<p>The contributions of each species to the currents and the density are also available,
although they are not included by default. They may be added to the list as
<code class="docutils literal notranslate"><span class="pre">&quot;Jx_abc&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Jy_abc&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Jz_abc&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;Rho_abc&quot;</span></code>, where <code class="docutils literal notranslate"><span class="pre">abc</span></code> is the
species name.</p>
<p>In the case of an envelope model for the laser (see <a class="reference internal" href="laser_envelope.html"><span class="doc">Laser envelope model</span></a>),
the following fields are also available: <code class="docutils literal notranslate"><span class="pre">&quot;Env_A_abs&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Env_Chi&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Env_E_abs&quot;</span></code>.</p>
<p>Note that when running a simulation in cylindrical geometry,
contrary to the Field diagnostic, Probes are defined as in a
3D Cartesian geometry and return Cartesian fields.</p>
</dd></dl>

<p><strong>Examples of probe diagnostics</strong></p>
<ul>
<li><p>0-D probe in 1-D simulation</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagProbe</span><span class="p">(</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">origin</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>1-D probe in 1-D simulation</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagProbe</span><span class="p">(</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">origin</span>  <span class="o">=</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">],</span>
    <span class="n">corners</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">5.6</span><span class="p">]],</span>
    <span class="n">number</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>1-D probe in 2-D simulation</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagProbe</span><span class="p">(</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">origin</span>  <span class="o">=</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">4.</span><span class="p">],</span>
    <span class="n">corners</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">5.6</span><span class="p">,</span> <span class="mf">4.</span><span class="p">]],</span>
    <span class="n">number</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>2-D probe in 2-D simulation</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagProbe</span><span class="p">(</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">origin</span>   <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
    <span class="n">corners</span>  <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="mf">10.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">10.</span><span class="p">]</span> <span class="p">],</span>
    <span class="n">number</span>   <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<hr class="docutils" />
</div>
<div class="section" id="particlebinning-diagnostics">
<span id="diagparticlebinning"></span><h2><em>ParticleBinning</em> diagnostics<a class="headerlink" href="#particlebinning-diagnostics" title="Permalink to this headline">¶</a></h2>
<p>A <em>particle binning diagnostic</em> collects data from the macro-particles and processes them during runtime.
It does not provide information on individual particles: instead, it produces
<strong>averaged quantities</strong> like the particle density, currents, etc.</p>
<p>The data is discretized inside a “grid” chosen by the user. This grid may be of any dimension.</p>
<p>Examples:</p>
<ul class="simple">
<li><p>1-dimensional grid along the position <span class="math notranslate nohighlight">\(x\)</span> (gives density variation along <span class="math notranslate nohighlight">\(x\)</span>)</p></li>
<li><p>2-dimensional grid along positions <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> (gives density map)</p></li>
<li><p>1-dimensional grid along the velocity <span class="math notranslate nohighlight">\(v_x\)</span> (gives the velocity distribution)</p></li>
<li><p>2-dimensional grid along position <span class="math notranslate nohighlight">\(x\)</span> and momentum <span class="math notranslate nohighlight">\(p_x\)</span> (gives the phase-space)</p></li>
<li><p>1-dimensional grid along the kinetic energy <span class="math notranslate nohighlight">\(E_\mathrm{kin}\)</span> (gives the energy distribution)</p></li>
<li><p>3-dimensional grid along <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(E_\mathrm{kin}\)</span> (gives the density map for several energies)</p></li>
<li><p>1-dimensional grid along the charge <span class="math notranslate nohighlight">\(Z^\star\)</span> (gives the charge distribution)</p></li>
<li><p>0-dimensional grid (simply gives the total integrated particle density)</p></li>
</ul>
<p>Each dimension of the grid is called “axis”.</p>
<p>You can add a particle binning diagnostic by including a block <code class="docutils literal notranslate"><span class="pre">DiagParticleBinning()</span></code> in the namelist,
for instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagParticleBinning</span><span class="p">(</span>
    <span class="n">deposited_quantity</span> <span class="o">=</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">time_average</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electrons1&quot;</span><span class="p">,</span> <span class="s2">&quot;electrons2&quot;</span><span class="p">],</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;ekin&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;logscale&quot;</span><span class="p">,</span> <span class="s2">&quot;edge_inclusive&quot;</span><span class="p">]</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="data">
<dt id="deposited_quantity">
<code class="sig-name descname">deposited_quantity</code><a class="headerlink" href="#deposited_quantity" title="Permalink to this definition">¶</a></dt>
<dd><p>The type of data that is summed in each cell of the grid.
Consider reading <a class="reference internal" href="units.html#weights"><span class="std std-ref">this</span></a> to understand the meaning of the <code class="docutils literal notranslate"><span class="pre">weight</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;weight&quot;</span></code> results in a number density.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;weight_charge&quot;</span></code> results in a charge density.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;weight_charge_vx&quot;</span></code> results in the <span class="math notranslate nohighlight">\(j_x\)</span> current density (same with <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(z\)</span>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;weight_p&quot;</span></code> results in the momentum density (same with <span class="math notranslate nohighlight">\(p_x\)</span>, <span class="math notranslate nohighlight">\(p_y\)</span> and <span class="math notranslate nohighlight">\(p_z\)</span>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;weight_ekin&quot;</span></code> results in the energy density.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;weight_vx_px&quot;</span></code> results in the <code class="docutils literal notranslate"><span class="pre">xx</span></code> pressure (same with yy, zz, xy, yz and xz).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;weight_chi&quot;</span></code> results in the quantum parameter density (only for species with radiation losses).</p></li>
<li><p>with a user-defined python function, an arbitrary quantity can be calculated (the <em>numpy</em>
module is necessary). This function should take one argument, for instance
<code class="docutils literal notranslate"><span class="pre">particles</span></code>, which contains the attributes <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, <code class="docutils literal notranslate"><span class="pre">z</span></code>, <code class="docutils literal notranslate"><span class="pre">px</span></code>, <code class="docutils literal notranslate"><span class="pre">py</span></code>,
<code class="docutils literal notranslate"><span class="pre">pz</span></code>, <code class="docutils literal notranslate"><span class="pre">charge</span></code>, <code class="docutils literal notranslate"><span class="pre">weight</span></code>, <code class="docutils literal notranslate"><span class="pre">chi</span></code> and <code class="docutils literal notranslate"><span class="pre">id</span></code>. Each of these attributes is a <em>numpy</em> array
containing the data of all particles in one patch. The function must return a <em>numpy</em>
array of the same shape, containing the desired deposition of each particle. For example,
defining the following function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">stuff</span><span class="p">(</span><span class="n">particles</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">particles</span><span class="o">.</span><span class="n">weight</span> <span class="o">*</span> <span class="n">particles</span><span class="o">.</span><span class="n">px</span>
</pre></div>
</div>
<p>passed as <code class="docutils literal notranslate"><span class="pre">deposited_quantity=stuff</span></code>, the diagnostic will sum the weights
<span class="math notranslate nohighlight">\(\times\; p_x\)</span>.</p>
<p>You may also pass directly an implicit (<em>lambda</em>) function using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">deposited_quantity</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">weight</span> <span class="o">*</span> <span class="n">p</span><span class="o">.</span><span class="n">px</span>
</pre></div>
</div>
</li>
</ul>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">every</code></dt>
<dd><p>The number of time-steps between each output, <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">flush_every</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1</p>
</dd>
</dl>
<p>Number of timesteps <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
<p>When <cite>flush_every</cite> coincides with <cite>every</cite>, the output
file is actually written (“flushed” from the buffer). Flushing
too often can <em>dramatically</em> slow down the simulation.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">time_average</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1</p>
</dd>
</dl>
<p>The number of time-steps during which the data is averaged before output.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">species</code></dt>
<dd><p>A list of one or several species’ <a class="reference internal" href="#name" title="name"><code class="xref py py-data docutils literal notranslate"><span class="pre">name</span></code></a>.
All these species are combined into the same diagnostic.</p>
</dd></dl>

<dl class="data">
<dt id="axes">
<code class="sig-name descname">axes</code><a class="headerlink" href="#axes" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of “axes” that define the grid.
There may be as many axes as wanted (there may be zero axes).</p>
<p>Syntax of one axis: <code class="docutils literal notranslate"><span class="pre">[type,</span> <span class="pre">min,</span> <span class="pre">max,</span> <span class="pre">nsteps,</span> <span class="pre">&quot;logscale&quot;,</span> <span class="pre">&quot;edge_inclusive&quot;]</span></code></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code> is one of:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;x&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;y&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;z&quot;</span></code>: spatial coordinates (<code class="docutils literal notranslate"><span class="pre">&quot;moving_x&quot;</span></code> with a <a class="reference internal" href="#movingwindow"><span class="std std-ref">moving window</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;px&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;py&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;pz&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;p&quot;</span></code>: momenta</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;vx&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;vy&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;vz&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;v&quot;</span></code>: velocities</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;gamma&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;ekin&quot;</span></code>: energies</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;chi&quot;</span></code>: quantum parameter</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;charge&quot;</span></code>: the particles’ electric charge</p></li>
<li><p>or a <em>python function</em> with the same syntax as the <code class="docutils literal notranslate"><span class="pre">deposited_quantity</span></code>.
Namely, this function must accept one argument only, for instance <code class="docutils literal notranslate"><span class="pre">particles</span></code>,
which holds the attributes <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, <code class="docutils literal notranslate"><span class="pre">z</span></code>, <code class="docutils literal notranslate"><span class="pre">px</span></code>, <code class="docutils literal notranslate"><span class="pre">py</span></code>, <code class="docutils literal notranslate"><span class="pre">pz</span></code>, <code class="docutils literal notranslate"><span class="pre">charge</span></code>,
<code class="docutils literal notranslate"><span class="pre">weight</span></code> and <code class="docutils literal notranslate"><span class="pre">id</span></code>. Each of these attributes is a <em>numpy</em> array containing the
data of all particles in one patch. The function must return a <em>numpy</em> array of
the same shape, containing the desired quantity of each particle that will decide
its location in the histogram binning.</p></li>
</ul>
</li>
<li><p>The axis is discretized for <code class="docutils literal notranslate"><span class="pre">type</span></code> from <code class="docutils literal notranslate"><span class="pre">min</span></code> to <code class="docutils literal notranslate"><span class="pre">max</span></code> in <code class="docutils literal notranslate"><span class="pre">nsteps</span></code> bins.</p></li>
<li><p>The optional keyword <code class="docutils literal notranslate"><span class="pre">logscale</span></code> sets the axis scale to logarithmic instead of linear.</p></li>
<li><p>The optional keyword <code class="docutils literal notranslate"><span class="pre">edge_inclusive</span></code> includes the particles outside the range
[<code class="docutils literal notranslate"><span class="pre">min</span></code>, <code class="docutils literal notranslate"><span class="pre">max</span></code>] into the extrema bins.</p></li>
</ul>
</dd></dl>

<p><strong>Examples of particle binning diagnostics</strong></p>
<ul>
<li><p>Variation of the density of species <code class="docutils literal notranslate"><span class="pre">electron1</span></code>
from <span class="math notranslate nohighlight">\(x=0\)</span> to 1, every 5 time-steps, without time-averaging</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagParticleBinning</span><span class="p">(</span>
    <span class="n">deposited_quantity</span> <span class="o">=</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">time_average</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electron1&quot;</span><span class="p">],</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>    <span class="mf">0.</span><span class="p">,</span>    <span class="mf">1.</span><span class="p">,</span>    <span class="mi">30</span><span class="p">]</span> <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Density map from <span class="math notranslate nohighlight">\(x=0\)</span> to 1, <span class="math notranslate nohighlight">\(y=0\)</span> to 1</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagParticleBinning</span><span class="p">(</span>
    <span class="n">deposited_quantity</span> <span class="o">=</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">time_average</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electron1&quot;</span><span class="p">],</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>    <span class="mf">0.</span><span class="p">,</span>    <span class="mf">1.</span><span class="p">,</span>    <span class="mi">30</span><span class="p">],</span>
             <span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>    <span class="mf">0.</span><span class="p">,</span>    <span class="mf">1.</span><span class="p">,</span>    <span class="mi">30</span><span class="p">]</span> <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Velocity distribution from <span class="math notranslate nohighlight">\(v_x = -0.1\)</span> to <span class="math notranslate nohighlight">\(0.1\)</span></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagParticleBinning</span><span class="p">(</span>
    <span class="n">deposited_quantity</span> <span class="o">=</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">time_average</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electron1&quot;</span><span class="p">],</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="s2">&quot;vx&quot;</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span>    <span class="mf">0.1</span><span class="p">,</span>    <span class="mi">100</span><span class="p">]</span> <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Phase space from <span class="math notranslate nohighlight">\(x=0\)</span> to 1 and from <span class="math notranslate nohighlight">\(px=-1\)</span> to 1</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagParticleBinning</span><span class="p">(</span>
    <span class="n">deposited_quantity</span> <span class="o">=</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">time_average</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electron1&quot;</span><span class="p">],</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>    <span class="mf">0.</span><span class="p">,</span>    <span class="mf">1.</span><span class="p">,</span>    <span class="mi">30</span><span class="p">],</span>
             <span class="p">[</span><span class="s2">&quot;px&quot;</span><span class="p">,</span>   <span class="o">-</span><span class="mf">1.</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>    <span class="mi">100</span><span class="p">]</span> <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Energy distribution from 0.01 to 1 MeV in logarithmic scale.
Note that the input units are <span class="math notranslate nohighlight">\(m_ec^2 \sim 0.5\)</span> MeV</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagParticleBinning</span><span class="p">(</span>
    <span class="n">deposited_quantity</span> <span class="o">=</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">time_average</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electron1&quot;</span><span class="p">],</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="s2">&quot;ekin&quot;</span><span class="p">,</span>    <span class="mf">0.02</span><span class="p">,</span>    <span class="mf">2.</span><span class="p">,</span>   <span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;logscale&quot;</span><span class="p">]</span> <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><span class="math notranslate nohighlight">\(x\)</span>-<span class="math notranslate nohighlight">\(y\)</span> density maps for three bands of energy: <span class="math notranslate nohighlight">\([0,1]\)</span>, <span class="math notranslate nohighlight">\([1,2]\)</span>, <span class="math notranslate nohighlight">\([2,\infty]\)</span>.
Note the use of <code class="docutils literal notranslate"><span class="pre">edge_inclusive</span></code> to reach energies up to <span class="math notranslate nohighlight">\(\infty\)</span></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagParticleBinning</span><span class="p">(</span>
    <span class="n">deposited_quantity</span> <span class="o">=</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">time_average</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electron1&quot;</span><span class="p">],</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>    <span class="mf">0.</span><span class="p">,</span>    <span class="mf">1.</span><span class="p">,</span>    <span class="mi">30</span><span class="p">],</span>
             <span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>    <span class="mf">0.</span><span class="p">,</span>    <span class="mf">1.</span><span class="p">,</span>    <span class="mi">30</span><span class="p">],</span>
             <span class="p">[</span><span class="s2">&quot;ekin&quot;</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span>    <span class="mf">6.</span><span class="p">,</span>    <span class="mi">3</span><span class="p">,</span>  <span class="s2">&quot;edge_inclusive&quot;</span><span class="p">]</span> <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Charge distribution from <span class="math notranslate nohighlight">\(Z^\star =0\)</span> to 10</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagParticleBinning</span><span class="p">(</span>
    <span class="n">deposited_quantity</span> <span class="o">=</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">time_average</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electron1&quot;</span><span class="p">],</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="s2">&quot;charge&quot;</span><span class="p">,</span>    <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>   <span class="mf">10.5</span><span class="p">,</span>   <span class="mi">11</span><span class="p">]</span> <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<hr class="docutils" />
</div>
<div class="section" id="screen-diagnostics">
<span id="diagscreen"></span><h2><em>Screen</em> diagnostics<a class="headerlink" href="#screen-diagnostics" title="Permalink to this headline">¶</a></h2>
<p>A <em>screen</em> collects data from the macro-particles when they cross a surface.
It processes this data similarly to the <a class="reference internal" href="#diagparticlebinning"><span class="std std-ref">particle binning diagnostics</span></a>
as it makes a histogram of the macro-particle properties. The only difference is
that the histogram is made only by the particles that cross the surface.</p>
<p>You can add a screen by including a block <code class="docutils literal notranslate"><span class="pre">DiagScreen()</span></code> in the namelist,
for instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagScreen</span><span class="p">(</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="s2">&quot;plane&quot;</span><span class="p">,</span>
    <span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">],</span>
    <span class="n">vector</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
    <span class="n">direction</span> <span class="o">=</span> <span class="s2">&quot;canceling&quot;</span><span class="p">,</span>
    <span class="n">deposited_quantity</span> <span class="o">=</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span>
    <span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electron&quot;</span><span class="p">],</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.</span><span class="o">*</span><span class="n">l0</span><span class="p">,</span> <span class="mf">10.</span><span class="o">*</span><span class="n">l0</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;px&quot;</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mi">30</span><span class="p">]],</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">10</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="data">
<dt id="shape">
<code class="sig-name descname">shape</code><a class="headerlink" href="#shape" title="Permalink to this definition">¶</a></dt>
<dd><p>The shape of the screen surface: <code class="docutils literal notranslate"><span class="pre">&quot;plane&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;sphere&quot;</span></code>.</p>
</dd></dl>

<dl class="data">
<dt id="point">
<code class="sig-name descname">point</code><a class="headerlink" href="#point" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>A list of floats <code class="docutils literal notranslate"><span class="pre">[X]</span></code> in 1D,  <code class="docutils literal notranslate"><span class="pre">[X,Y]</span></code> in 2D,  <code class="docutils literal notranslate"><span class="pre">[X,Y,Z]</span></code> in 3D</p>
</dd>
</dl>
<p>The coordinates of a point that defines the screen surface:
a point of the <code class="docutils literal notranslate"><span class="pre">&quot;plane&quot;</span></code> or the center of the <code class="docutils literal notranslate"><span class="pre">&quot;sphere&quot;</span></code>.</p>
</dd></dl>

<dl class="data">
<dt id="vector">
<code class="sig-name descname">vector</code><a class="headerlink" href="#vector" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>A list of floats <code class="docutils literal notranslate"><span class="pre">[X]</span></code> in 1D,  <code class="docutils literal notranslate"><span class="pre">[X,Y]</span></code> in 2D,  <code class="docutils literal notranslate"><span class="pre">[X,Y,Z]</span></code> in 3D</p>
</dd>
</dl>
<p>The coordinates of a vector that defines the screen surface:
the normal to the <code class="docutils literal notranslate"><span class="pre">&quot;plane&quot;</span></code> or a radius of the <code class="docutils literal notranslate"><span class="pre">&quot;sphere&quot;</span></code>.</p>
</dd></dl>

<dl class="data">
<dt id="direction">
<code class="sig-name descname">direction</code><a class="headerlink" href="#direction" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;both&quot;</span></code></p>
</dd>
</dl>
<p>Determines how particles are counted depending on which side of the screen they come from.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;both&quot;</span></code> to account for both sides.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;forward&quot;</span></code> for only the ones in the direction of the <code class="docutils literal notranslate"><span class="pre">vector</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;backward&quot;</span></code> for only the ones in the opposite direction.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;canceling&quot;</span></code> to count negatively the ones in the opposite direction.</p></li>
</ul>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">deposited_quantity</code></dt>
<dd><p>Identical to the <code class="docutils literal notranslate"><span class="pre">deposited_quantity</span></code> of <a class="reference internal" href="#diagparticlebinning"><span class="std std-ref">particle binning diagnostics</span></a>.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">every</code></dt>
<dd><p>The number of time-steps between each output, <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">flush_every</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1</p>
</dd>
</dl>
<p>Number of timesteps <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
<p>When <cite>flush_every</cite> coincides with <cite>every</cite>, the output
file is actually written (“flushed” from the buffer). Flushing
too often can <em>dramatically</em> slow down the simulation.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">species</code></dt>
<dd><p>A list of one or several species’ <a class="reference internal" href="#name" title="name"><code class="xref py py-data docutils literal notranslate"><span class="pre">name</span></code></a>.
All these species are combined into the same diagnostic.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">axes</code></dt>
<dd><p>A list of “axes” that define the grid of the histogram.
It is identical to that of <a class="reference internal" href="#diagparticlebinning"><span class="std std-ref">particle binning diagnostics</span></a>, with the
addition of four types of axes:</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">shape=&quot;plane&quot;</span></code>, then <code class="docutils literal notranslate"><span class="pre">&quot;a&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;b&quot;</span></code> are the axes perpendicular to the <code class="docutils literal notranslate"><span class="pre">vector</span></code>.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">shape=&quot;sphere&quot;</span></code>, then <code class="docutils literal notranslate"><span class="pre">&quot;theta&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;phi&quot;</span></code> are the angles with respect to the <code class="docutils literal notranslate"><span class="pre">vector</span></code>.</p></li>
</ul>
</dd></dl>

<hr class="docutils" />
</div>
<div class="section" id="trackparticles-diagnostics">
<span id="diagtrackparticles"></span><h2><em>TrackParticles</em> diagnostics<a class="headerlink" href="#trackparticles-diagnostics" title="Permalink to this headline">¶</a></h2>
<p>A <em>particle tracking diagnostic</em> records the macro-particle positions and momenta at various timesteps.
Typically, this is used for plotting trajectories.</p>
<p>You can add a tracking diagnostic by including a block <code class="docutils literal notranslate"><span class="pre">DiagTrackParticles()</span></code> in the namelist,
for instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagTrackParticles</span><span class="p">(</span>
    <span class="n">species</span> <span class="o">=</span> <span class="s2">&quot;electron&quot;</span><span class="p">,</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<span class="c1">#    flush_every = 100,</span>
<span class="c1">#    filter = my_filter,</span>
<span class="c1">#    attributes = [&quot;x&quot;, &quot;px&quot;, &quot;py&quot;, &quot;Ex&quot;, &quot;Ey&quot;, &quot;Bz&quot;]</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="data">
<dt>
<code class="sig-name descname">species</code></dt>
<dd><p>The <a class="reference internal" href="#name" title="name"><code class="xref py py-data docutils literal notranslate"><span class="pre">name</span></code></a> of the species to be tracked.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">every</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>0</p>
</dd>
</dl>
<p>Number of timesteps between each output of particles trajectories, <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.
If non-zero, the particles positions will be tracked and written in a file named <code class="docutils literal notranslate"><span class="pre">TrackParticlesDisordered_abc.h5</span></code>
(where <code class="docutils literal notranslate"><span class="pre">abc</span></code> is the species’ <a class="reference internal" href="#name" title="name"><code class="xref py py-data docutils literal notranslate"><span class="pre">name</span></code></a>).</p>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">flush_every</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1</p>
</dd>
</dl>
<p>Number of timesteps <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">flush_every</span></code> coincides with <code class="docutils literal notranslate"><span class="pre">every</span></code>, the output
file for tracked particles is actually written (“flushed” from the buffer). Flushing
too often can <em>dramatically</em> slow down the simulation.</p>
</dd></dl>

<dl class="data">
<dt id="filter">
<code class="sig-name descname">filter</code><a class="headerlink" href="#filter" title="Permalink to this definition">¶</a></dt>
<dd><p>A python function giving some condition on which particles are tracked.
If none provided, all particles are tracked.
To use this option, the <a class="reference external" href="http://www.numpy.org/">numpy package</a> must
be available in your python installation.</p>
<p>The function must have one argument, that you may call, for instance, <code class="docutils literal notranslate"><span class="pre">particles</span></code>.
This object has several attributes <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, <code class="docutils literal notranslate"><span class="pre">z</span></code>, <code class="docutils literal notranslate"><span class="pre">px</span></code>, <code class="docutils literal notranslate"><span class="pre">py</span></code>, <code class="docutils literal notranslate"><span class="pre">pz</span></code>, <code class="docutils literal notranslate"><span class="pre">charge</span></code>,
<code class="docutils literal notranslate"><span class="pre">weight</span></code> and <code class="docutils literal notranslate"><span class="pre">id</span></code>. Each of these attributes
are provided as <strong>numpy</strong> arrays where each cell corresponds to one particle.
The function must return a boolean <strong>numpy</strong> array of the same shape, containing <code class="docutils literal notranslate"><span class="pre">True</span></code>
for particles that should be tracked, and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>The following example selects all the particles that verify <span class="math notranslate nohighlight">\(-1&lt;p_x&lt;1\)</span>
or <span class="math notranslate nohighlight">\(p_z&gt;3\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_filter</span><span class="p">(</span><span class="n">particles</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">particles</span><span class="o">.</span><span class="n">px</span><span class="o">&gt;-</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">particles</span><span class="o">.</span><span class="n">px</span><span class="o">&lt;</span><span class="mf">1.</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">particles</span><span class="o">.</span><span class="n">pz</span><span class="o">&gt;</span><span class="mf">3.</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">id</span></code> attribute contains the <a class="reference internal" href="ids.html"><span class="doc">particles identification number</span></a>.
This number is set to 0 at the beginning of the simulation. <strong>Only after particles have
passed the filter</strong>, they acquire a positive <code class="docutils literal notranslate"><span class="pre">id</span></code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For advanced filtration, Smilei provides the quantity <code class="docutils literal notranslate"><span class="pre">Main.iteration</span></code>,
accessible within the <code class="docutils literal notranslate"><span class="pre">filter</span></code> function. Its value is always equal to the current
iteration number of the PIC loop. The current time of the simulation is thus
<code class="docutils literal notranslate"><span class="pre">Main.iteration</span> <span class="pre">*</span> <span class="pre">Main.timestep</span></code>.</p>
</div>
<dl class="data">
<dt id="attributes">
<code class="sig-name descname">attributes</code><a class="headerlink" href="#attributes" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">[&quot;x&quot;,&quot;y&quot;,&quot;z&quot;,&quot;px&quot;,&quot;py&quot;,&quot;pz&quot;]</span></code></p>
</dd>
</dl>
<p>A list of strings indicating the particle attributes to be written in the output.
The attributes may be the particles’ spatial coordinates (<code class="docutils literal notranslate"><span class="pre">&quot;x&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;y&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;z&quot;</span></code>),
their momenta (<code class="docutils literal notranslate"><span class="pre">&quot;px&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;py&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;pz&quot;</span></code>), their electrical charge (<code class="docutils literal notranslate"><span class="pre">&quot;q&quot;</span></code>),
their statistical weight (<code class="docutils literal notranslate"><span class="pre">&quot;weight&quot;</span></code>), their quantum parameter
(<code class="docutils literal notranslate"><span class="pre">&quot;chi&quot;</span></code>, only for species with radiation losses) or the fields interpolated
at their  positions (<code class="docutils literal notranslate"><span class="pre">&quot;Ex&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Ey&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Ez&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Bx&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;By&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Bz&quot;</span></code>).</p>
</dd></dl>

<hr class="docutils" />
</div>
<div class="section" id="performances-diagnostics">
<span id="diagperformances"></span><h2><em>Performances</em> diagnostics<a class="headerlink" href="#performances-diagnostics" title="Permalink to this headline">¶</a></h2>
<p>The <em>performances</em> diagnostic records information on the computational load and timers
for each MPI process  or for each patch in the simulation.</p>
<p>Only one block <code class="docutils literal notranslate"><span class="pre">DiagPerformances()</span></code> may be added in the namelist, for instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagPerformances</span><span class="p">(</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
<span class="c1">#    flush_every = 100,</span>
<span class="c1">#    patch_information = True,</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="data">
<dt>
<code class="sig-name descname">every</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>0</p>
</dd>
</dl>
<p>Number of timesteps between each output, <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="sig-name descname">flush_every</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1</p>
</dd>
</dl>
<p>Number of timesteps <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">flush_every</span></code> coincides with <code class="docutils literal notranslate"><span class="pre">every</span></code>, the output file is actually written
(“flushed” from the buffer). Flushing too often might <em>dramatically</em> slow down the simulation.</p>
</dd></dl>

<dl class="data">
<dt id="patch_information">
<code class="sig-name descname">patch_information</code><a class="headerlink" href="#patch_information" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>False</p>
</dd>
</dl>
<p>If <cite>True</cite>, some information is calculated at the patch level (see <a class="reference internal" href="post-processing.html#Performances" title="Performances"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Performances()</span></code></a>)
but this may impact the code performances.</p>
</dd></dl>

<hr class="docutils" />
</div>
<div class="section" id="time-selections">
<span id="timeselections"></span><h2>Time selections<a class="headerlink" href="#time-selections" title="Permalink to this headline">¶</a></h2>
<p>Several components (mainly diagnostics) may require a selection of timesteps to
be chosen by the user. When one of these timesteps is reached, the diagnostics will
output data. A time selection is given through the parameter <code class="docutils literal notranslate"><span class="pre">every</span></code> and is a list
of several numbers.</p>
<p>You may chose between five different syntaxes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">every</span> <span class="o">=</span> <span class="p">[</span>               <span class="n">period</span>                    <span class="p">]</span> <span class="c1"># Syntax 1</span>
<span class="n">every</span> <span class="o">=</span> <span class="p">[</span>       <span class="n">start</span><span class="p">,</span>  <span class="n">period</span>                    <span class="p">]</span> <span class="c1"># Syntax 2</span>
<span class="n">every</span> <span class="o">=</span> <span class="p">[</span> <span class="n">start</span><span class="p">,</span>  <span class="n">end</span><span class="p">,</span>  <span class="n">period</span>                    <span class="p">]</span> <span class="c1"># Syntax 3</span>
<span class="n">every</span> <span class="o">=</span> <span class="p">[</span> <span class="n">start</span><span class="p">,</span>  <span class="n">end</span><span class="p">,</span>  <span class="n">period</span><span class="p">,</span>  <span class="n">repeat</span>           <span class="p">]</span> <span class="c1"># Syntax 4</span>
<span class="n">every</span> <span class="o">=</span> <span class="p">[</span> <span class="n">start</span><span class="p">,</span>  <span class="n">end</span><span class="p">,</span>  <span class="n">period</span><span class="p">,</span>  <span class="n">repeat</span><span class="p">,</span>  <span class="n">spacing</span> <span class="p">]</span> <span class="c1"># Syntax 5</span>
</pre></div>
</div>
<p>where</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">start</span></code> is the first timestep of the selection (defaults to 0);</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">end</span></code> is the last timestep of the selection (defaults to ∞);</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">period</span></code> is the separation between outputs (defaults to 1);</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">repeat</span></code> indicates how many outputs to do at each period (defaults to 1);</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spacing</span></code> is the separation between each repeat (defaults to 1).</p></li>
</ul>
<p>For more clarity, this graph illustrates the five syntaxes for time selections:</p>
<a class="reference internal image-reference" href="_images/TimeSelections.png"><img alt="_images/TimeSelections.png" class="align-center" src="_images/TimeSelections.png" style="width: 33em;" /></a>
<div class="admonition-tips admonition">
<p class="admonition-title">Tips</p>
<ul class="simple">
<li><p>The syntax <code class="docutils literal notranslate"><span class="pre">every</span> <span class="pre">=</span> <span class="pre">period</span></code> is also accepted.</p></li>
<li><p>Any value set to <code class="docutils literal notranslate"><span class="pre">0</span></code> will be replaced by the default value.</p></li>
<li><p>Special case: <code class="docutils literal notranslate"><span class="pre">every=0</span></code> means no output.</p></li>
<li><p>The numbers may be non-integers (apart from <code class="docutils literal notranslate"><span class="pre">repeat</span></code>). The closest timesteps are chosen.</p></li>
</ul>
</div>
<hr class="docutils" />
</div>
<div class="section" id="checkpoints">
<span id="id11"></span><h2>Checkpoints<a class="headerlink" href="#checkpoints" title="Permalink to this headline">¶</a></h2>
<p>The simulation state can be saved (<em>dumped</em>) at given times (<em>checkpoints</em>)
in order to be later <em>restarted</em> at that point.</p>
<p>A few things are important to know when you need dumps and restarts.</p>
<ul class="simple">
<li><p>Do not restart the simulation in the same directory as the previous one. Files will be
overwritten, and errors may occur. Create a new directory for your restarted simulation.</p></li>
<li><p>Manage your disk space: each MPI process dumps one file, and the total can be significant.</p></li>
<li><p>The restarted runs must have the same namelist as the initial simulation, except the
<a class="reference internal" href="#checkpoints"><span class="std std-ref">Checkpoints</span></a> block, which can be modified.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Checkpoints</span><span class="p">(</span>
    <span class="c1"># restart_dir = &quot;dump1&quot;,</span>
    <span class="n">dump_step</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span>
    <span class="n">dump_minutes</span> <span class="o">=</span> <span class="mf">240.</span><span class="p">,</span>
    <span class="n">exit_after_dump</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">keep_n_dumps</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>Parameters to save the state of the current simulation</strong></p>
<blockquote>
<div><dl class="data">
<dt id="dump_step">
<code class="sig-name descname">dump_step</code><a class="headerlink" href="#dump_step" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p>The number of timesteps between each dump.
If <code class="docutils literal notranslate"><span class="pre">0</span></code>, no dump is done.</p>
</dd></dl>

<dl class="data">
<dt id="dump_minutes">
<code class="sig-name descname">dump_minutes</code><a class="headerlink" href="#dump_minutes" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">0.</span></code></p>
</dd>
</dl>
<p>The number of minutes between each dump.
If <code class="docutils literal notranslate"><span class="pre">0.</span></code>, no dump is done.</p>
<p>May be used in combination with <a class="reference internal" href="#dump_step" title="dump_step"><code class="xref py py-data docutils literal notranslate"><span class="pre">dump_step</span></code></a>.</p>
</dd></dl>

<dl class="data">
<dt id="exit_after_dump">
<code class="sig-name descname">exit_after_dump</code><a class="headerlink" href="#exit_after_dump" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</dd>
</dl>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the code stops after the first dump. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, the simulation continues.</p>
</dd></dl>

<dl class="data">
<dt id="keep_n_dumps">
<code class="sig-name descname">keep_n_dumps</code><a class="headerlink" href="#keep_n_dumps" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p>
</dd>
</dl>
<p>This tells <strong class="program">Smilei</strong> to keep, in the current run,  only the last <code class="docutils literal notranslate"><span class="pre">n</span></code> dumps.
Older dumps will be overwritten.</p>
<p>The default value, <code class="docutils literal notranslate"><span class="pre">2</span></code>, saves one extra dump in case of a crash during the next dump.</p>
</dd></dl>

<dl class="data">
<dt id="file_grouping">
<code class="sig-name descname">file_grouping</code><a class="headerlink" href="#file_grouping" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
<p>The maximum number of checkpoint files that can be stored in one directory.
Subdirectories are created to accomodate for all files.
This is useful on filesystem with a limited number of files per directory.</p>
</dd></dl>

<dl class="data">
<dt id="dump_deflate">
<code class="sig-name descname">dump_deflate</code><a class="headerlink" href="#dump_deflate" title="Permalink to this definition">¶</a></dt>
<dd><p><span class="red">to do</span></p>
</dd></dl>

</div></blockquote>
<p><strong>Parameters to restart from a previous simulation</strong></p>
<blockquote>
<div><dl class="data">
<dt id="restart_dir">
<code class="sig-name descname">restart_dir</code><a class="headerlink" href="#restart_dir" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
<p>The directory of a previous run from which <strong class="program">Smilei</strong> should restart.
For the first run, do not specify this parameter.</p>
<p><strong>This path must either absolute or be relative to the current directory.</strong></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In many situations, the restarted runs will have the exact same namelist as the initial
simulation, except this <code class="docutils literal notranslate"><span class="pre">restart_dir</span></code> parameter, which points to the previous simulation
folder.
You can use the same namelist file, and simply add an extra argument when you launch the
restart:</p>
<p><code class="docutils literal notranslate"><span class="pre">mpirun</span> <span class="pre">...</span> <span class="pre">./smilei</span> <span class="pre">mynamelist.py</span> <span class="pre">&quot;Checkpoints.restart_dir='/path/to/previous/run'&quot;</span></code></p>
</div>
</dd></dl>

<dl class="data">
<dt id="restart_number">
<code class="sig-name descname">restart_number</code><a class="headerlink" href="#restart_number" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
<p>The number of the dump (in the previous run) that should be used for the restart.
For the first run, do not specify this parameter.</p>
<p>In a previous run, the simulation state may have been dumped several times.
These dumps are numbered 0, 1, 2, etc. until the number <a class="reference internal" href="#keep_n_dumps" title="keep_n_dumps"><code class="xref py py-data docutils literal notranslate"><span class="pre">keep_n_dumps</span></code></a>.</p>
</dd></dl>

</div></blockquote>
</div>
<hr class="docutils" />
<div class="section" id="variables-defined-by-smilei">
<h2>Variables defined by Smilei<a class="headerlink" href="#variables-defined-by-smilei" title="Permalink to this headline">¶</a></h2>
<p><strong class="program">Smilei</strong> passes the following variables to the python interpreter for use in the
namelist. They should not be re-defined by the user!</p>
<dl class="data">
<dt id="smilei_mpi_rank">
<code class="sig-name descname">smilei_mpi_rank</code><a class="headerlink" href="#smilei_mpi_rank" title="Permalink to this definition">¶</a></dt>
<dd><p>The MPI rank of the current process.</p>
</dd></dl>

<dl class="data">
<dt id="smilei_mpi_size">
<code class="sig-name descname">smilei_mpi_size</code><a class="headerlink" href="#smilei_mpi_size" title="Permalink to this definition">¶</a></dt>
<dd><p>The total number of MPI processes.</p>
</dd></dl>

<dl class="data">
<dt id="smilei_rand_max">
<code class="sig-name descname">smilei_rand_max</code><a class="headerlink" href="#smilei_rand_max" title="Permalink to this definition">¶</a></dt>
<dd><p>The largest random integer.</p>
</dd></dl>

<p>As an example of their use, this script randomizes both python’s
and <strong class="program">Smilei</strong>’s random seeds.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span><span class="o">,</span> <span class="nn">math</span>
<span class="c1"># reshuffle python random generator</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="n">smilei_mpi_rank</span><span class="p">)</span>
<span class="c1"># get 32bit pseudo random integer to be passed to smilei</span>
<span class="n">random_seed</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">smilei_rand_max</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


        </div></div>
    </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      <div>
      <a href="site.html">Site index</a>
      </div>
      <div>
        Last updated on Feb 17, 2020
      </div>
      
      <div>
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.1</a>
      </div>
      
    </div>
    
    <script type="text/javascript">
        
        var nav = document.getElementById("nav");
        var nav_list = document.getElementById("nav_list");
        var nav_button = document.getElementById("nav_button");
        var smallScreenMenu = document.getElementById("smallScreenMenu");
        var smallScreenMenuButton = document.getElementById("smallScreenMenuButton");
        var searchicon = document.getElementById("searchicon");
        var searchbox  = document.getElementById("searchbox");
        var searchinput= document.getElementById("searchinput");
        var menus = document.getElementsByClassName("menu");
        for( var i=0; i<menus.length; i++ )
            menus[i].active = false;
        
        
        var ul = nav_list.getElementsByTagName("ul")[0], li;
        var keep_nav = false;
        if( ul ) {
            li = ul.firstElementChild;
            if( li ) {
                if( li.getElementsByTagName("ul").length > 0 ) keep_nav = true;
            }
        }
        if( keep_nav ) {
            li.removeChild( li.firstElementChild );
        } else {
            document.getElementById("nav_positioner").removeChild( document.getElementById("nav") );
        }
        
        function navOff() {
            nav_list.style.display = "none";
            nav_button.className = "";
            nav.style.overflowY = "visible";
        }
        
        function toggleNav() {
            for( var i=0; i<menus.length; i++ )
                menuOff( menus[i] );
            if( nav_list.style.display != "inline-block" ) {
                nav_list.style.display = "inline-block";
                nav_button.className = "pushed";
                nav.style.overflowY = "auto";
            } else {
                navOff();
            }
        }
        
        function toggleSmallScreenMenu(e) {
            e.preventDefault();
            if( smallScreenMenu.className != "on" ) {
                smallScreenMenu.className = "on";
                smallScreenMenuButton.className = "pushed";
            } else {
                smallScreenMenu.className = "off";
                smallScreenMenuButton.className = "";
            }
        }
        
        function prepareMenu(menu_id) {
            var menu = document.getElementById(menu_id);
            menu.timer1 = setTimeout(function(a){ return function(){thisMenuOnly(a)};}(menu_id), 100);
            menu.addEventListener("mouseleave", function(a){ return function(){clearTimeout(a.timer1)};}(menu) );
        }
        
        function leaveMenu(menu_id, source) {
            var menu = document.getElementById(menu_id);
            menu.timer2 = setTimeout(function(a){ return function(){menuOff(a)};}(menu), 1000);
            source.addEventListener("mouseenter", function(a){ return function(){clearTimeout(a.timer2)};}(menu) );
        }
        
        function menuOn( menu ) {
            var divs = menu.getElementsByTagName("div");
            if(nav_list) navOff();
            divs[1].className = "on";
            divs[0].className = "menuButton pushed";
            menu.active = true;
        }
        function menuOff( menu ) {
            var divs = menu.getElementsByTagName("div");
            divs[1].className = "off";
            divs[0].className = "menuButton";
            menu.active = false;
        }
        
        function thisMenuOnly(menu_id) {
            var menu = document.getElementById(menu_id);
            for( var i=0; i<menus.length; i++ )
                if( i!=menu_id )
                    menuOff( menus[i] );
            menuOn( menu );
        }
        
        function toggleMenu(menu_id) {
            var menu = document.getElementById(menu_id);
            if( menu.active ) {
                menuOff( menu );
            } else {
                for( var i=0; i<menus.length; i++ )
                    if( i!=menu_id )
                        menuOff( menus[i] );
                menuOn( menu );
            }
        }
        
        function openSearch() {
            for( var i=0; i<menus.length; i++ ) {
                menuOff( menus[i] );
                menus[i].style.zIndex = "-1";
            }
            searchicon.style.display = "none";
            closesearchicon.style.display = "block";
            searchbox.style.display = "block";
            searchinput.focus();
        }
        
        function closeSearch() {
            searchicon.style.display = "block";
            closesearchicon.style.display = "none";
            searchbox .style.display = "none";
            for( var i=0; i<menus.length; i++ )
                menus[i].style.zIndex = "0";
        }
        
        
        var documentDiv = document.getElementsByClassName("document")[0];
        documentDiv.addEventListener('click', function (event) {
            if(nav_list) navOff();
            for( var i=0; i<menus.length; i++ )
                menuOff( menus[i] );
        });
    </script>
  </body>
</html>