
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Ionization &#8212; Smilei b&#39;v4.3-106-g8c22fd7f\n&#39; documentation</title>
    <link rel="stylesheet" href="_static/smilei_theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://www.gitcdn.xyz/cdn/mathjax/MathJax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="_static/smileiIcon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Synchrotron-like radiation reaction" href="radiation_loss.html" />
    <link rel="prev" title="Binary collisions" href="collisions.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": {
      scale: 95,
      availableFonts: ["TeX"]
    }
  });
  </script>
   
  </head><body>

<div id="smallScreenMenu" class="off">

    
    <div class="toctree-smilei">
        <ul>
                <li class="outer">
                    <a href="licence.html">Licence</a>
                </li>
                <li class="outer">
                    <a href="synopsis.html">Synopsis</a>
                </li>
                <li class="outer">
                    <a href="highlights.html">Highlights</a>
                </li>
                <li class="outer">
                    <a href="releases.html">Releases</a>
                </li>
        </ul>
        <hr />
        <ul>
                <li class="outer">
                    <a href="units.html">Units</a>
                </li>
                <li class="outer">
                    <a href="algorithms.html">PIC algorithms</a>
                </li>
                <li class="outer">
                    <a href="parallelization.html">Parallelization basics</a>
                </li>
                <li class="outer">
                    <a href="vectorization.html">Vectorization</a>
                </li>
                <li class="outer">
                    <a href="collisions.html">Binary collisions</a>
                </li>
            </ul>
                <ul>
<li><a class="reference internal" href="#">Ionization</a><ul>
<li><a class="reference internal" href="#collisional-ionization">Collisional ionization</a></li>
<li><a class="reference internal" href="#field-ionization">Field ionization</a><ul>
<li><a class="reference internal" href="#physical-model-for-field-ionization">Physical model for field ionization</a></li>
<li><a class="reference internal" href="#monte-carlo-scheme">Monte-Carlo scheme</a></li>
<li><a class="reference internal" href="#benchmarks">Benchmarks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#user-defined-ionization-rate">User-defined ionization rate</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

            <ul>
                <li class="outer">
                    <a href="radiation_loss.html">Synchrotron-like radiation reaction</a>
                </li>
                <li class="outer">
                    <a href="multiphoton_Breit_Wheeler.html">Multiphoton Breit-Wheeler pair creation</a>
                </li>
                <li class="outer">
                    <a href="particle_merging.html">Particle Merging</a>
                </li>
                <li class="outer">
                    <a href="particle_injector.html">Particle Injector</a>
                </li>
                <li class="outer">
                    <a href="laser_envelope.html">Laser envelope model</a>
                </li>
                <li class="outer">
                    <a href="relativistic_fields_initialization.html">Field initialization for relativistic species</a>
                </li>
                <li class="outer">
                    <a href="azimuthal_modes_decomposition.html">Azimuthal modes decomposition</a>
                </li>
        </ul>
        <hr />
        <ul>
                <li class="outer">
                    <a href="installation.html">Install</a>
                </li>
                <li class="outer">
                    <a href="namelist.html">Write a namelist</a>
                </li>
                <li class="outer">
                    <a href="run.html">Run</a>
                </li>
                <li class="outer">
                    <a href="post-processing.html">Post-process</a>
                </li>
                <li class="outer">
                    <a href="contribute.html">Contribute</a>
                </li>
        </ul>
        <hr />
        <ul>
                <li class="outer">
                    <a href="material.html">Publications</a>
                </li>
                <li class="outer">
                    <a href="partners.html">Partners</a>
                </li>
                <li class="outer">
                    <a href="https://smileipic.github.io/tutorials">Smilei tutorials</a>
                </li>
        </ul>
        <hr />
    </div>

</div>
<div id="hcontainer">
    <div id="nav_positioner">
        <div id="nav">
            <div id="nav_button" onclick="toggleNav()">
                Sections
            </div>
            <div id="nav_list" class="toctree-smilei">
                <div id="nav_title"><a href="#">Ionization</a></div>
                <ul>
<li><a class="reference internal" href="#">Ionization</a><ul>
<li><a class="reference internal" href="#collisional-ionization">Collisional ionization</a></li>
<li><a class="reference internal" href="#field-ionization">Field ionization</a><ul>
<li><a class="reference internal" href="#physical-model-for-field-ionization">Physical model for field ionization</a></li>
<li><a class="reference internal" href="#monte-carlo-scheme">Monte-Carlo scheme</a></li>
<li><a class="reference internal" href="#benchmarks">Benchmarks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#user-defined-ionization-rate">User-defined ionization rate</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

            </div>
        </div>
    </div>
    
    <div class="headercolor">
    </div>
    <div class="hpositioner">
        <div class="header">
        <div class="logo">
            <a href="index.html">
                <img class="logo" src="_static/smileiLogo.svg" alt="Logo" />
            </a>
        </div>
        <div class="menu"
            id="menu_Overview"
            
        >
            <div id="menuButton_Overview" class="menuButton"
                 onmouseenter="prepareMenu('menu_Overview')"
                 onmousedown="event.preventDefault()"
            >
                <a href="overview.html">
                    <span>Overview</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_Overview',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="licence.html">Licence</a>
                        </li>
                        <li class="outer">
                            <a href="synopsis.html">Synopsis</a>
                        </li>
                        <li class="outer">
                            <a href="highlights.html">Highlights</a>
                        </li>
                        <li class="outer">
                            <a href="releases.html">Releases</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        <div class="menu"
            id="menu_Understand"
            style="font-weight:bold"
        >
            <div id="menuButton_Understand" class="menuButton"
                 onmouseenter="prepareMenu('menu_Understand')"
                 onmousedown="event.preventDefault()"
            >
                <a href="understand.html">
                    <span>Understand</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_Understand',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="units.html">Units</a>
                        </li>
                        <li class="outer">
                            <a href="algorithms.html">PIC algorithms</a>
                        </li>
                        <li class="outer">
                            <a href="parallelization.html">Parallelization basics</a>
                        </li>
                        <li class="outer">
                            <a href="vectorization.html">Vectorization</a>
                        </li>
                        <li class="outer">
                            <a href="collisions.html">Binary collisions</a>
                        </li>
                        <li >
                            <a href="#">Ionization</a>
                        </li>
                        <li class="outer">
                            <a href="radiation_loss.html">Synchrotron-like radiation reaction</a>
                        </li>
                        <li class="outer">
                            <a href="multiphoton_Breit_Wheeler.html">Multiphoton Breit-Wheeler pair creation</a>
                        </li>
                        <li class="outer">
                            <a href="particle_merging.html">Particle Merging</a>
                        </li>
                        <li class="outer">
                            <a href="particle_injector.html">Particle Injector</a>
                        </li>
                        <li class="outer">
                            <a href="laser_envelope.html">Laser envelope model</a>
                        </li>
                        <li class="outer">
                            <a href="relativistic_fields_initialization.html">Field initialization for relativistic species</a>
                        </li>
                        <li class="outer">
                            <a href="azimuthal_modes_decomposition.html">Azimuthal modes decomposition</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        <div class="menu"
            id="menu_Use"
            
        >
            <div id="menuButton_Use" class="menuButton"
                 onmouseenter="prepareMenu('menu_Use')"
                 onmousedown="event.preventDefault()"
            >
                <a href="use.html">
                    <span>Use</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_Use',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="installation.html">Install</a>
                        </li>
                        <li class="outer">
                            <a href="namelist.html">Write a namelist</a>
                        </li>
                        <li class="outer">
                            <a href="run.html">Run</a>
                        </li>
                        <li class="outer">
                            <a href="post-processing.html">Post-process</a>
                        </li>
                        <li class="outer">
                            <a href="contribute.html">Contribute</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        <div class="last menu"
            id="menu_More"
            
        >
            <div id="menuButton_More" class="menuButton"
                 onmouseenter="prepareMenu('menu_More')"
                 onmousedown="event.preventDefault()"
            >
                <a href="more.html">
                    <span>More</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_More',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="material.html">Publications</a>
                        </li>
                        <li class="outer">
                            <a href="partners.html">Partners</a>
                        </li>
                        <li class="outer">
                            <a href="https://smileipic.github.io/tutorials">Smilei tutorials</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        
        <script type="text/javascript">
            var es=document.getElementsByClassName("menuButton"), i=0;
            var evt = "ontouchend" in document ? "touchend" : "click";
            for( var i=0; i<es.length; i+=1 ) {
                es[i].addEventListener(evt, function(a){ return function(){toggleMenu(a)};}(es[i].parentNode.id));
            }
        </script>
        
        <div id="searchbox" role="search" style="display:none">
            <form class="search" action="search.html" method="get">
              <input type="text" name="q" placeholder="Search" id="searchinput" />
              <input type="hidden" name="check_keywords" value="yes" />
              <input type="hidden" name="area" value="default" />
            </form>
        </div>
        
        <div id="searchicon" onclick="openSearch()" style="display:block">
            <svg
               xmlns="http://www.w3.org/2000/svg"
               viewBox="0 0 80 120">
              <g transform="translate(0,-932.36216)" >
                <circle
                   r="25" cy="977.51044" cx="38.078663"
                   style="opacity:1;fill:none;stroke:#ffffff;stroke-width:10;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
                <rect
                   transform="matrix(0.36717877,0.93015039,-0.93427297,0.35655858,0,0)"
                   rx="4.9996676" ry="7.4995141"
                   y="316.16959" x="947.6142"
                   height="14.117695" width="46.476151"
                   style="opacity:1;fill:#ffffff;fill-opacity:1;stroke:none;" />
                <path
                   d="m 41.383282,962.25996 a 15,15 0 0 1 11.660107,11.6355"
                   style="opacity:1;fill:none;stroke:#ffffff;stroke-width:3;stroke-linecap:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
              </g>
            </svg>
        </div>
        <div id="closesearchicon" onclick="closeSearch()" style="display:none">
            <svg
               xmlns="http://www.w3.org/2000/svg"
               viewBox="0 0 80 120">
              <g
                 transform="translate(0,-932.36216)">
                <path
                   d="m 10,962.36216 60,60.00004"
                   style="fill:none;stroke:#ffffff;stroke-width:10;stroke-linecap:round;stroke-linejoin:miter;stroke-opacity:1;stroke-miterlimit:4;stroke-dasharray:none" />
                <path
                   d="M 70,962.36216 10,1022.3622"
                   style="fill:none;stroke:#ffffff;stroke-width:10;stroke-linecap:round;stroke-linejoin:miter;stroke-opacity:1;stroke-miterlimit:4;stroke-dasharray:none" />
              </g>
            </svg>
        </div>
        
        <div id="smallScreenMenuButton" onclick="toggleSmallScreenMenu(event)">
            <svg xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg"
               viewBox="-20 -20 140 140">
              <g  style="fill:#ffffff;stroke:none;">
                <circle cx="15" cy="20" r="5" />
                <circle cx="35" cy="20" r="5" />
                <circle cx="85" cy="20" r="5" />
                <rect width="50" height="10" x="35" y="15" rx="0" ry="0" />
                <circle cx="15" cy="40" r="5" />
                <circle cx="35" cy="40" r="5" />
                <circle cx="85" cy="40" r="5" />
                <rect width="50" height="10" x="35" y="35" rx="0" ry="0" />
                <circle cx="15" cy="60" r="5" />
                <circle cx="35" cy="60" r="5" />
                <circle cx="85" cy="60" r="5" />
                <rect width="50" height="10" x="35" y="55" rx="0" ry="0" />
                <circle cx="15" cy="80" r="5" />
                <circle cx="35" cy="80" r="5" />
                <circle cx="85" cy="80" r="5" />
                <rect width="50" height="10" x="35" y="75" rx="0" ry="0" />
              </g>
            </svg>
        </div>
        
    </div>
    
</div>
</div>

    <div class="document">
    <div class="documentwrapper">
        <div class="body" role="main">
          
  <div class="section" id="ionization">
<h1>Ionization<a class="headerlink" href="#ionization" title="Permalink to this headline">¶</a></h1>
<p>Three types of ionization have been introduced in Smilei.</p>
<hr class="docutils" />
<div class="section" id="collisional-ionization">
<h2>Collisional ionization<a class="headerlink" href="#collisional-ionization" title="Permalink to this headline">¶</a></h2>
<p>Ionization may occur during collisions.
A detailed description is given on the <a class="reference internal" href="collisions.html#collionization"><span class="std std-ref">corresponding page</span></a>.</p>
<hr class="docutils" />
</div>
<div class="section" id="field-ionization">
<span id="id1"></span><h2>Field ionization<a class="headerlink" href="#field-ionization" title="Permalink to this headline">¶</a></h2>
<p>Field ionization is a process of particular importance for laser-plasma interaction
in the ultra-high intensity regime.
It can affect ion acceleration driven by irradiating a solid target with
an ultra-intense laser, or can be used to inject electrons through
the accelerating field in laser wakefield acceleration.
This process is not described in the standard PIC (Vlasov-Maxwell) formulation,
and an <em>ad hoc</em> description needs to be implemented.
A Monte-Carlo module for field ionization has thus been developed in <strong class="program">Smilei</strong>,
closely following the method proposed in <a class="reference internal" href="#nuter2011" id="id2"><span>[Nuter2011]</span></a>.</p>
<div class="section" id="physical-model-for-field-ionization">
<h3>Physical model for field ionization<a class="headerlink" href="#physical-model-for-field-ionization" title="Permalink to this headline">¶</a></h3>
<p>This scheme relies on the quasi-static rate for tunnel ionization derived in
<a class="reference internal" href="#perelomov1966" id="id3"><span>[Perelomov1966]</span></a>, <a class="reference internal" href="#perelomov1967" id="id4"><span>[Perelomov1967]</span></a> and <a class="reference internal" href="#ammosov1986" id="id5"><span>[Ammosov1986]</span></a>.
Considering an ion with atomic number <span class="math notranslate nohighlight">\(Z\)</span> being ionized from charge state
<span class="math notranslate nohighlight">\(Z^\star-1\)</span> to <span class="math notranslate nohighlight">\(Z^\star \le Z\)</span> in an electric field <span class="math notranslate nohighlight">\(\mathbf{E}\)</span>
of magnitude <span class="math notranslate nohighlight">\(\vert E\vert\)</span>, the ionization rate reads:</p>
<div class="math notranslate nohighlight" id="equation-ionizationrate">
<span class="eqno">(9)<a class="headerlink" href="#equation-ionizationrate" title="Permalink to this equation">¶</a></span>\[\Gamma_{\rm qs} = A_{n^\star,l^\star}\,B_{l,\vert m\vert}\,
I_p\,\left( \frac{2 (2 I_p)^{3/2}}{\vert E\vert} \right)^{2n^\star-\vert m \vert -1}\,
\exp\!\left( -\frac{2 (2 I_p)^{3/2}}{3 \vert E\vert}  \right)\,,\]</div>
<p>where <span class="math notranslate nohighlight">\(I_p\)</span> is the <span class="math notranslate nohighlight">\(Z^{\star}-1\)</span> ionization potential of the ion,
<span class="math notranslate nohighlight">\(n^\star=Z^\star/\sqrt{2 I_p}\)</span> and <span class="math notranslate nohighlight">\(l^\star=n^\star-1\)</span> denote
the effective principal quantum number and angular momentum,
and <span class="math notranslate nohighlight">\(l\)</span> and <span class="math notranslate nohighlight">\(m\)</span> denote the angular momentum and its projection on
the laser polarization direction, respectively.
<span class="math notranslate nohighlight">\(\Gamma_{\rm qs}\)</span>, <span class="math notranslate nohighlight">\(I_p\)</span> and <span class="math notranslate nohighlight">\(E\)</span> are here expressed in atomic units
The coefficients <span class="math notranslate nohighlight">\(A_{n^\star,l^\star}\)</span> and <span class="math notranslate nohighlight">\(B_{l,\vert m\vert}\)</span> are given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{lll}
A_{n^\star,l^\star}&amp;=&amp; \frac{2^{2n^\star}}{n^\star\,\Gamma(n^\star+l^\star+1)\,\Gamma(n^\star-l^\star)},\\
B_{l,\vert m\vert} &amp;=&amp; \frac{(2l+1)(l+\vert m\vert)!}{2^{\vert m\vert} \vert m\vert! (l-\vert m\vert)!}\,,
\end{array}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Gamma(x)\)</span> is the gamma function.
Note that considering an electric field <span class="math notranslate nohighlight">\(E=\vert E\vert\,\cos(\omega t)\)</span>
oscillating in time at the frequency <span class="math notranslate nohighlight">\(\omega\)</span>, averaging Eq. <a class="reference internal" href="#equation-ionizationrate">(9)</a>
over a period <span class="math notranslate nohighlight">\(2\pi/\omega\)</span> leads to the well-known cycle-averaged ionization rate:</p>
<div class="math notranslate nohighlight" id="equation-adkrate">
<span class="eqno">(10)<a class="headerlink" href="#equation-adkrate" title="Permalink to this equation">¶</a></span>\[\Gamma_{\rm ADK} = \sqrt{\frac{6}{\pi}}A_{n^\star,l^\star}\,B_{l,\vert m\vert}
\,I_p\,\left( \frac{2 (2 I_p)^{3/2}}{\vert E\vert} \right)^{2n^\star-\vert m \vert -3/2}\,
\exp\!\left( -\frac{2 (2 I_p)^{3/2}}{3 \vert E\vert}  \right)\,.\]</div>
<p>In <strong class="program">Smilei</strong>, following <a class="reference internal" href="#nuter2011" id="id6"><span>[Nuter2011]</span></a>, the ionization rate of <a class="reference internal" href="#equation-ionizationrate">(9)</a>
is computed for <span class="math notranslate nohighlight">\(\vert m \vert=0\)</span> only.
Indeed, as shown in <a class="reference internal" href="#ammosov1986" id="id7"><span>[Ammosov1986]</span></a>, the ratio <span class="math notranslate nohighlight">\(R\)</span> of the ionization rate
computed for <span class="math notranslate nohighlight">\(\vert m\vert=0\)</span> by the rate computed for <span class="math notranslate nohighlight">\(\vert m\vert=1\)</span> is:</p>
<div class="math notranslate nohighlight">
\[R = \frac{\Gamma_{{\rm qs},\vert m \vert = 0}}{\Gamma_{{\rm qs},\vert m \vert = 1}}
=  2\frac{(2\,I_p)^{3/2}}{\vert E\vert}
\simeq 7.91\,10^{-3} \,\,\frac{(I_p[\rm eV])^{3/2}}{a_0\,\hbar\omega_0[\rm eV]}\,,\]</div>
<p>where, in the practical units formulation, we have considered ionization
by a laser with normalized vector potential <span class="math notranslate nohighlight">\(a_0=e\vert E\vert /(m_e c \omega_0)\)</span>,
and photon energy <span class="math notranslate nohighlight">\(\hbar\omega_0\)</span> in eV.
Typically, ionization by a laser with wavelength <span class="math notranslate nohighlight">\(1~{\rm \mu m}\)</span>
(correspondingly <span class="math notranslate nohighlight">\(\hbar \omega_0 \sim 1~{\rm eV}\)</span>) occurs for values
of <span class="math notranslate nohighlight">\(a_0\ll 1\)</span> (even for large laser intensities for which ionization
would occur during the rising time of the pulse) while the ionization potential
ranges from a couple of eV (for electrons on the most external shells)
up to a few tens of thousands of eV (for electrons on the internal shell
of high-Z atoms). As a consequence, <span class="math notranslate nohighlight">\(R\gg1\)</span>, and the probability
of ionization of an electron with magnetic quantum number <span class="math notranslate nohighlight">\(\vert m \vert=0\)</span>
greatly exceeds that of an electron with <span class="math notranslate nohighlight">\(\vert m \vert = 1\)</span>.</p>
</div>
<div class="section" id="monte-carlo-scheme">
<h3>Monte-Carlo scheme<a class="headerlink" href="#monte-carlo-scheme" title="Permalink to this headline">¶</a></h3>
<p>In <strong class="program">Smilei</strong>, tunnel ionization is treated for each species
(defined by the user as subject to field ionization) right after field interpolation
and before applying the pusher.
For all quasi-particles (henceforth referred to as quasi-ion) of the considered species,
a Monte-Carlo procedure has been implemented that allows to treat multiple ionization
events in a single timestep. It relies on the cumulative probability derived
in Ref. <a class="reference internal" href="#nuter2011" id="id8"><span>[Nuter2011]</span></a>:</p>
<div class="math notranslate nohighlight">
\[F_k^{Z^{\star}-1} = \sum_{j=0}^k p_j^{Z^{\star}-1}\,,\]</div>
<p>to ionize from 0 to <span class="math notranslate nohighlight">\(k\)</span> times a quasi-ion with initial charge state
<span class="math notranslate nohighlight">\(Z^{\star}-1\)</span> during a simulation timestep <span class="math notranslate nohighlight">\(\Delta t\)</span>,
<span class="math notranslate nohighlight">\(p_j^{Z^{\star}-1}\)</span> being the probability to ionize exactly <span class="math notranslate nohighlight">\(j\)</span> times this ion.</p>
<p>The Monte-Carlo procedure proceeds as follows.
A random number <span class="math notranslate nohighlight">\(r\)</span> with uniform distribution between 0 and 1 is picked.
If <span class="math notranslate nohighlight">\(r\)</span> is smaller than the probability <span class="math notranslate nohighlight">\(p_0^{Z^{\star}-1}\)</span>
to not ionize the quasi-ion, then the quasi-ion is not ionized during this time step.
Otherwise, we loop over the number of ionization events <span class="math notranslate nohighlight">\(k\)</span>,
from <span class="math notranslate nohighlight">\(k=1\)</span> to <span class="math notranslate nohighlight">\(k_{\rm max}=Z-Z^{\star}+1\)</span>
(for which <span class="math notranslate nohighlight">\(F_{k_{\rm max}}^{Z^{\star}-1}=1\)</span> by construction),
until <span class="math notranslate nohighlight">\(r&lt;F_k^{Z^{\star}-1}\)</span>. At that point, <span class="math notranslate nohighlight">\(k\)</span> is the number of
ionization events for the quasi-ion. A quasi-electron is created with
the numerical weight equal to <span class="math notranslate nohighlight">\(k\)</span> times that of the quasi-ion,
and with the same velocity as this quasi-ion.
The quasi-ion charge is also increased by <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p>Finally, to ensure energy conservation, an ionization current
<span class="math notranslate nohighlight">\({\bf J}_{\rm ion}\)</span> is projected onto the simulation grid such that</p>
<div class="math notranslate nohighlight">
\[{\bf J}_{\rm ion} \cdot {\bf E} = \Delta t^{-1}\,\sum_{j=1}^k I_p(Z^{\star}-1+k)\,.\]</div>
</div>
<div class="section" id="benchmarks">
<h3>Benchmarks<a class="headerlink" href="#benchmarks" title="Permalink to this headline">¶</a></h3>
<p>In what follows, we present two benchmarks of the field ionization model.
Both benchmarks consist in irradiating a thin (one cell long) neutral material (hydrogen or carbon)
with a short (few optical-cycle long) laser with wavelength <span class="math notranslate nohighlight">\(\lambda_0 = 0.8~{\mu m}\)</span>.</p>
<div class="figure align-default" id="id9">
<span id="figfieldionization"></span><img alt="_images/FieldIonization.png" src="_images/FieldIonization.png" />
<p class="caption"><span class="caption-number">Fig. 25 </span><span class="caption-text">Results of two benchmarks for the field ionization Model.
Top: Average charge state of hydrogen ions as a function of time when irradiated by a laser.
The red solid line corresponds to PIC results, the dashed line corresponds to
theoretical predictions using the cycle-averaged ADK growth rate of <a class="reference internal" href="#equation-adkrate">(10)</a>.
Bottom: Relative distribution of carbon ions for different charge states as a function
of time. Dashed lines correspond to PIC results, thin gray lines correspond to
theoretical predictions obtained from <a class="reference internal" href="#equation-rateeqs">(11)</a>. The Gaussian gray shape
indicates the laser electric field envelope.</span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</div>
<p>In the first benchmark, featuring hydrogen, the laser intensity is kept constant
at <span class="math notranslate nohighlight">\(I_L = 10^{14}~{\rm W/cm^2}\)</span>, corresponding to a normalized vector
potential <span class="math notranslate nohighlight">\(a_0 \simeq 6.81 \times 10^{-3}\)</span>, over 10 optical cycles.
The resulting averaged ion charge in the simulation is presented as a function of
time in <a class="reference internal" href="#figfieldionization"><span class="std std-numref">Fig. 25</span></a> (left). It is found to be in excellent agreement
with the theoretical prediction considering the cycle averaged ionization rate
<span class="math notranslate nohighlight">\(\Gamma_{\rm ADK} \simeq 2.55\times10^{12}~{\rm s^{-1}}\)</span> computed
from <a class="reference internal" href="#equation-adkrate">(10)</a>.</p>
<p>The second benchmark features carbon ions. The laser has a peak intensity
<span class="math notranslate nohighlight">\(I_L = 5 \times 10^{16}~{\rm W/cm^2}\)</span>, corresponding to a normalized
vector potential <span class="math notranslate nohighlight">\(a_0 \simeq 1.52 \times 10^{-1}\)</span>, and a gaussian time profile
with FWHM <span class="math notranslate nohighlight">\(\tau_L=5~\lambda_0/c\)</span> (in terms of
electric field). <a class="reference internal" href="#figfieldionization"><span class="std std-numref">Fig. 25</span></a> (right) shows, as function of time,
the relative distribution of carbon ions for different charge states
(from 0 to <span class="math notranslate nohighlight">\(+4\)</span>). These numerical results are shown to be in excellent
agreement with theoretical predictions obtained by numerically solving the coupled
rate equations on the population <span class="math notranslate nohighlight">\(N_i\)</span> of each level <span class="math notranslate nohighlight">\(i\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-rateeqs">
<span class="eqno">(11)<a class="headerlink" href="#equation-rateeqs" title="Permalink to this equation">¶</a></span>\[\frac{d}{dt}N_i =
(1-\delta_{i,0}) \, \Gamma_{i-1}\,N_{i-1}  -  (1-\delta_{i,Z})\, \Gamma_{i}\,N_{i}\,,\]</div>
<p>with <span class="math notranslate nohighlight">\(\delta_{i,j}\)</span> the Kroenecker delta, and <span class="math notranslate nohighlight">\(\Gamma_i\)</span> the ionization
rate of level <span class="math notranslate nohighlight">\(i\)</span>. Note also that, for this configuration,
<span class="math notranslate nohighlight">\(\Delta t \simeq 0.04~{\rm fs}\)</span> is about ten times larger than
the characteristic time <span class="math notranslate nohighlight">\(\Gamma_{\rm ADK}^{-1} \simeq 0.006~{\rm fs}\)</span>
to ionize <span class="math notranslate nohighlight">\({\rm C}^{2+}\)</span> and <span class="math notranslate nohighlight">\({\rm C}^{3+}\)</span>
so that multiple ionization from <span class="math notranslate nohighlight">\({\rm C}^{2+}\)</span> to <span class="math notranslate nohighlight">\({\rm C}^{4+}\)</span>
during a single timestep does occur and is found to be correctly accounted for
in our simulations.</p>
<hr class="docutils" />
</div>
</div>
<div class="section" id="user-defined-ionization-rate">
<span id="rate-ionization"></span><h2>User-defined ionization rate<a class="headerlink" href="#user-defined-ionization-rate" title="Permalink to this headline">¶</a></h2>
<p><strong class="program">Smilei</strong> can treat ionization considering a fixed rate prescribed by the user.
The ionization rates are defined, for a given <code class="docutils literal notranslate"><span class="pre">Species</span></code>, as described <a class="reference internal" href="namelist.html#species"><span class="std std-ref">here</span></a>.
The Monte-Carlo procedure behind the treatment of ionization in this case closely follows
that developed for field ionization.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Note that, in the case of a user-defined ionization rate, only single ionization event per timestep are possible.</p>
</div>
<p>Let us introduce two benchmarks for which the rate of ionization is defined by the user.
The first benchmark considers an initially neutral species that can be potentially ionized twice.
To run this case, a constant and uniform ionization rate is considered that depends only on the particle current charge
state. For this particular case, we have considered a rate <span class="math notranslate nohighlight">\(r_0 = 0.1\)</span> (in code units) for ionization from
charge state 0 to 1, and a rate <span class="math notranslate nohighlight">\(r_1 = 0.05\)</span> (in code units) for ionization from charge state 1 to 2.
The simulation results presented in Fig. <a class="reference internal" href="#figfromrateionization"><span class="std std-numref">Fig. 26</span></a> (top panel) shows the time evolution of the
fraction in each possible charge states (<span class="math notranslate nohighlight">\(Z=0\)</span>, <span class="math notranslate nohighlight">\(Z=1\)</span> and <span class="math notranslate nohighlight">\(Z=2\)</span>).
Super-imposed (dashed lines) are the corresponding theoretical predictions.</p>
<p>The second benchmark features an initially neutral species homogeneously distributed in the simulation box.
The ionization rate is here chosen as a function of the spatial coordinate <span class="math notranslate nohighlight">\(x\)</span>,
and reads <span class="math notranslate nohighlight">\(r(x) = r_0 \exp(-(x-x_c)^2/2)\)</span> with <span class="math notranslate nohighlight">\(r_0 = 0.02\)</span> the maximum ionization rate and
<span class="math notranslate nohighlight">\(x_c=5\)</span> the center of the simulation box.
The simulation results presented in Fig. <a class="reference internal" href="#figfromrateionization"><span class="std std-numref">Fig. 26</span></a> (bottom panel) shows,
at the end of the simulation <span class="math notranslate nohighlight">\(t=20\)</span>, the electron number density as a function of space.
Super-imposed (in red) is the corresponding theoretical prediction.</p>
<div class="figure align-default" id="id10">
<span id="figfromrateionization"></span><img alt="_images/userDefinedRate.png" src="_images/userDefinedRate.png" />
<p class="caption"><span class="caption-number">Fig. 26 </span><span class="caption-text">Results of the two benchmarks for the ionization model using user-defined rates as described above.</span><a class="headerlink" href="#id10" title="Permalink to this image">¶</a></p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="citation">
<dt class="label" id="ammosov1986"><span class="brackets">Ammosov1986</span><span class="fn-backref">(<a href="#id5">1</a>,<a href="#id7">2</a>)</span></dt>
<dd><p><a class="reference external" href="http://www.jetp.ac.ru/cgi-bin/dn/e_064_06_1191.pdf">M. V. Ammosov, N. B. Delone, and V. P. Krainov, Sov. Phys. JETP 64, 1191 (1986)</a></p>
</dd>
<dt class="label" id="nuter2011"><span class="brackets">Nuter2011</span><span class="fn-backref">(<a href="#id2">1</a>,<a href="#id6">2</a>,<a href="#id8">3</a>)</span></dt>
<dd><p><a class="reference external" href="http://dx.doi.org/10.1063/1.3559494">R. Nuter et al., Phys. of Plasmas 19, 033107 (2011)</a></p>
</dd>
<dt class="label" id="perelomov1966"><span class="brackets"><a class="fn-backref" href="#id3">Perelomov1966</a></span></dt>
<dd><p><a class="reference external" href="http://www.jetp.ac.ru/cgi-bin/dn/e_023_05_0924.pdf">A. M. Perelomov, V. S. Popov, and M. V. Terent’ev, Sov. Phys. JETP 23, 924 (1966)</a></p>
</dd>
<dt class="label" id="perelomov1967"><span class="brackets"><a class="fn-backref" href="#id4">Perelomov1967</a></span></dt>
<dd><p><a class="reference external" href="http://www.jetp.ac.ru/cgi-bin/dn/e_024_01_0207.pdf">A. M. Perelomov, V. S. Popov, and M. V. Terent’ev, Sov. Phys. JETP 24, 207 (1967)</a></p>
</dd>
</dl>
</div>
</div>


        </div></div>
    </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      <div>
      <a href="site.html">Site index</a>
      </div>
      <div>
        Last updated on Feb 17, 2020
      </div>
      
      <div>
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.1</a>
      </div>
      
    </div>
    
    <script type="text/javascript">
        
        var nav = document.getElementById("nav");
        var nav_list = document.getElementById("nav_list");
        var nav_button = document.getElementById("nav_button");
        var smallScreenMenu = document.getElementById("smallScreenMenu");
        var smallScreenMenuButton = document.getElementById("smallScreenMenuButton");
        var searchicon = document.getElementById("searchicon");
        var searchbox  = document.getElementById("searchbox");
        var searchinput= document.getElementById("searchinput");
        var menus = document.getElementsByClassName("menu");
        for( var i=0; i<menus.length; i++ )
            menus[i].active = false;
        
        
        var ul = nav_list.getElementsByTagName("ul")[0], li;
        var keep_nav = false;
        if( ul ) {
            li = ul.firstElementChild;
            if( li ) {
                if( li.getElementsByTagName("ul").length > 0 ) keep_nav = true;
            }
        }
        if( keep_nav ) {
            li.removeChild( li.firstElementChild );
        } else {
            document.getElementById("nav_positioner").removeChild( document.getElementById("nav") );
        }
        
        function navOff() {
            nav_list.style.display = "none";
            nav_button.className = "";
            nav.style.overflowY = "visible";
        }
        
        function toggleNav() {
            for( var i=0; i<menus.length; i++ )
                menuOff( menus[i] );
            if( nav_list.style.display != "inline-block" ) {
                nav_list.style.display = "inline-block";
                nav_button.className = "pushed";
                nav.style.overflowY = "auto";
            } else {
                navOff();
            }
        }
        
        function toggleSmallScreenMenu(e) {
            e.preventDefault();
            if( smallScreenMenu.className != "on" ) {
                smallScreenMenu.className = "on";
                smallScreenMenuButton.className = "pushed";
            } else {
                smallScreenMenu.className = "off";
                smallScreenMenuButton.className = "";
            }
        }
        
        function prepareMenu(menu_id) {
            var menu = document.getElementById(menu_id);
            menu.timer1 = setTimeout(function(a){ return function(){thisMenuOnly(a)};}(menu_id), 100);
            menu.addEventListener("mouseleave", function(a){ return function(){clearTimeout(a.timer1)};}(menu) );
        }
        
        function leaveMenu(menu_id, source) {
            var menu = document.getElementById(menu_id);
            menu.timer2 = setTimeout(function(a){ return function(){menuOff(a)};}(menu), 1000);
            source.addEventListener("mouseenter", function(a){ return function(){clearTimeout(a.timer2)};}(menu) );
        }
        
        function menuOn( menu ) {
            var divs = menu.getElementsByTagName("div");
            if(nav_list) navOff();
            divs[1].className = "on";
            divs[0].className = "menuButton pushed";
            menu.active = true;
        }
        function menuOff( menu ) {
            var divs = menu.getElementsByTagName("div");
            divs[1].className = "off";
            divs[0].className = "menuButton";
            menu.active = false;
        }
        
        function thisMenuOnly(menu_id) {
            var menu = document.getElementById(menu_id);
            for( var i=0; i<menus.length; i++ )
                if( i!=menu_id )
                    menuOff( menus[i] );
            menuOn( menu );
        }
        
        function toggleMenu(menu_id) {
            var menu = document.getElementById(menu_id);
            if( menu.active ) {
                menuOff( menu );
            } else {
                for( var i=0; i<menus.length; i++ )
                    if( i!=menu_id )
                        menuOff( menus[i] );
                menuOn( menu );
            }
        }
        
        function openSearch() {
            for( var i=0; i<menus.length; i++ ) {
                menuOff( menus[i] );
                menus[i].style.zIndex = "-1";
            }
            searchicon.style.display = "none";
            closesearchicon.style.display = "block";
            searchbox.style.display = "block";
            searchinput.focus();
        }
        
        function closeSearch() {
            searchicon.style.display = "block";
            closesearchicon.style.display = "none";
            searchbox .style.display = "none";
            for( var i=0; i<menus.length; i++ )
                menus[i].style.zIndex = "0";
        }
        
        
        var documentDiv = document.getElementsByClassName("document")[0];
        documentDiv.addEventListener('click', function (event) {
            if(nav_list) navOff();
            for( var i=0; i<menus.length; i++ )
                menuOff( menus[i] );
        });
    </script>
  </body>
</html>